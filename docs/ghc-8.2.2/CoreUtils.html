<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CoreUtils</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/CoreUtils.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ghc-8.2.2: The GHC API</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">CoreUtils</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Constructing expressions</a></li><li><a href="#g:2">Taking expressions apart</a></li><li><a href="#g:3">Properties of expressions</a></li><li><a href="#g:4">Equality</a></li><li><a href="#g:5">Eta reduction</a></li><li><a href="#g:6">Manipulating data constructors and types</a></li><li><a href="#g:7">Working with ticks</a></li><li><a href="#g:8">StaticPtr</a></li><li><a href="#g:9">Join points</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Commonly useful utilites for manipulating the Core language</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:mkCast">mkCast</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Coercion.html#t:Coercion">Coercion</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></li><li class="src short"><a href="#v:mkTick">mkTick</a> :: <a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></li><li class="src short"><a href="#v:mkTicks">mkTicks</a> :: [<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a>] -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></li><li class="src short"><a href="#v:mkTickNoHNF">mkTickNoHNF</a> :: <a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></li><li class="src short"><a href="#v:tickHNFArgs">tickHNFArgs</a> :: <a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></li><li class="src short"><a href="#v:bindNonRec">bindNonRec</a> :: <a href="Var.html#t:Id">Id</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></li><li class="src short"><a href="#v:needsCaseBinding">needsCaseBinding</a> :: <a href="Type.html#t:Type">Type</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:mkAltExpr">mkAltExpr</a> :: <a href="CoreSyn.html#t:AltCon">AltCon</a> -&gt; [<a href="CoreSyn.html#t:CoreBndr">CoreBndr</a>] -&gt; [<a href="Type.html#t:Type">Type</a>] -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></li><li class="src short"><a href="#v:findDefault">findDefault</a> :: [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [a], b)] -&gt; ([(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [a], b)], <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> b)</li><li class="src short"><a href="#v:addDefault">addDefault</a> :: [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [a], b)] -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> b -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [a], b)]</li><li class="src short"><a href="#v:findAlt">findAlt</a> :: <a href="CoreSyn.html#t:AltCon">AltCon</a> -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)] -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)</li><li class="src short"><a href="#v:isDefaultAlt">isDefaultAlt</a> :: (<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b) -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:mergeAlts">mergeAlts</a> :: [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)] -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)] -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)]</li><li class="src short"><a href="#v:trimConArgs">trimConArgs</a> :: <a href="CoreSyn.html#t:AltCon">AltCon</a> -&gt; [<a href="CoreSyn.html#t:CoreArg">CoreArg</a>] -&gt; [<a href="CoreSyn.html#t:CoreArg">CoreArg</a>]</li><li class="src short"><a href="#v:filterAlts">filterAlts</a> :: <a href="TyCon.html#t:TyCon">TyCon</a> -&gt; [<a href="Type.html#t:Type">Type</a>] -&gt; [<a href="CoreSyn.html#t:AltCon">AltCon</a>] -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [<a href="Var.html#t:Var">Var</a>], a)] -&gt; ([<a href="CoreSyn.html#t:AltCon">AltCon</a>], [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [<a href="Var.html#t:Var">Var</a>], a)])</li><li class="src short"><a href="#v:combineIdenticalAlts">combineIdenticalAlts</a> :: [<a href="CoreSyn.html#t:AltCon">AltCon</a>] -&gt; [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>] -&gt; (<a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>, [<a href="CoreSyn.html#t:AltCon">AltCon</a>], [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>])</li><li class="src short"><a href="#v:refineDefaultAlt">refineDefaultAlt</a> :: [<a href="Unique.html#t:Unique">Unique</a>] -&gt; <a href="TyCon.html#t:TyCon">TyCon</a> -&gt; [<a href="Type.html#t:Type">Type</a>] -&gt; [<a href="CoreSyn.html#t:AltCon">AltCon</a>] -&gt; [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>] -&gt; (<a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>, [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>])</li><li class="src short"><a href="#v:exprType">exprType</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a></li><li class="src short"><a href="#v:coreAltType">coreAltType</a> :: <a href="CoreSyn.html#t:CoreAlt">CoreAlt</a> -&gt; <a href="Type.html#t:Type">Type</a></li><li class="src short"><a href="#v:coreAltsType">coreAltsType</a> :: [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>] -&gt; <a href="Type.html#t:Type">Type</a></li><li class="src short"><a href="#v:isExprLevPoly">isExprLevPoly</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsDupable">exprIsDupable</a> :: <a href="DynFlags.html#t:DynFlags">DynFlags</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsTrivial">exprIsTrivial</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:getIdFromTrivialExpr">getIdFromTrivialExpr</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Var.html#t:Id">Id</a></li><li class="src short"><a href="#v:exprIsBottom">exprIsBottom</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:getIdFromTrivialExpr_maybe">getIdFromTrivialExpr_maybe</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Var.html#t:Id">Id</a></li><li class="src short"><a href="#v:exprIsCheap">exprIsCheap</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsExpandable">exprIsExpandable</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsOk">exprIsOk</a> :: <a href="CoreUtils.html#t:CheapAppFun">CheapAppFun</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:CheapAppFun">CheapAppFun</a> = <a href="Var.html#t:Id">Id</a> -&gt; <a href="BasicTypes.html#t:Arity">Arity</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsHNF">exprIsHNF</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprOkForSpeculation">exprOkForSpeculation</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprOkForSideEffects">exprOkForSideEffects</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsWorkFree">exprIsWorkFree</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsBig">exprIsBig</a> :: <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsConLike">exprIsConLike</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:rhsIsStatic">rhsIsStatic</a> :: <a href="Platform.html#t:Platform">Platform</a> -&gt; (<a href="Name.html#t:Name">Name</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>) -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isCheapApp">isCheapApp</a> :: <a href="CoreUtils.html#t:CheapAppFun">CheapAppFun</a></li><li class="src short"><a href="#v:isExpandableApp">isExpandableApp</a> :: <a href="CoreUtils.html#t:CheapAppFun">CheapAppFun</a></li><li class="src short"><a href="#v:exprIsLiteralString">exprIsLiteralString</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:exprIsTopLevelBindable">exprIsTopLevelBindable</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:cheapEqExpr">cheapEqExpr</a> :: <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:cheapEqExpr-39-">cheapEqExpr'</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:eqExpr">eqExpr</a> :: <a href="VarEnv.html#t:InScopeSet">InScopeSet</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:diffExpr">diffExpr</a> :: <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="VarEnv.html#t:RnEnv2">RnEnv2</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; [<a href="Outputable.html#t:SDoc">SDoc</a>]</li><li class="src short"><a href="#v:diffBinds">diffBinds</a> :: <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="VarEnv.html#t:RnEnv2">RnEnv2</a> -&gt; [(<a href="Var.html#t:Var">Var</a>, <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>)] -&gt; [(<a href="Var.html#t:Var">Var</a>, <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>)] -&gt; ([<a href="Outputable.html#t:SDoc">SDoc</a>], <a href="VarEnv.html#t:RnEnv2">RnEnv2</a>)</li><li class="src short"><a href="#v:tryEtaReduce">tryEtaReduce</a> :: [<a href="Var.html#t:Var">Var</a>] -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></li><li class="src short"><a href="#v:exprToType">exprToType</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a></li><li class="src short"><a href="#v:exprToCoercion_maybe">exprToCoercion_maybe</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Coercion.html#t:Coercion">Coercion</a></li><li class="src short"><a href="#v:applyTypeToArgs">applyTypeToArgs</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a> -&gt; [<a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>] -&gt; <a href="Type.html#t:Type">Type</a></li><li class="src short"><a href="#v:applyTypeToArg">applyTypeToArg</a> :: <a href="Type.html#t:Type">Type</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a></li><li class="src short"><a href="#v:dataConRepInstPat">dataConRepInstPat</a> :: [<a href="Unique.html#t:Unique">Unique</a>] -&gt; <a href="DataCon.html#t:DataCon">DataCon</a> -&gt; [<a href="Type.html#t:Type">Type</a>] -&gt; ([<a href="Var.html#t:TyVar">TyVar</a>], [<a href="Var.html#t:Id">Id</a>])</li><li class="src short"><a href="#v:dataConRepFSInstPat">dataConRepFSInstPat</a> :: [<a href="FastString.html#t:FastString">FastString</a>] -&gt; [<a href="Unique.html#t:Unique">Unique</a>] -&gt; <a href="DataCon.html#t:DataCon">DataCon</a> -&gt; [<a href="Type.html#t:Type">Type</a>] -&gt; ([<a href="Var.html#t:TyVar">TyVar</a>], [<a href="Var.html#t:Id">Id</a>])</li><li class="src short"><a href="#v:isEmptyTy">isEmptyTy</a> :: <a href="Type.html#t:Type">Type</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:stripTicksTop">stripTicksTop</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; ([<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a>], <a href="CoreSyn.html#t:Expr">Expr</a> b)</li><li class="src short"><a href="#v:stripTicksTopE">stripTicksTopE</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b</li><li class="src short"><a href="#v:stripTicksTopT">stripTicksTopT</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; [<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a>]</li><li class="src short"><a href="#v:stripTicksE">stripTicksE</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b</li><li class="src short"><a href="#v:stripTicksT">stripTicksT</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; [<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a>]</li><li class="src short"><a href="#v:collectMakeStaticArgs">collectMakeStaticArgs</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>, <a href="Type.html#t:Type">Type</a>, <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>, <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>)</li><li class="src short"><a href="#v:isJoinBind">isJoinBind</a> :: <a href="CoreSyn.html#t:CoreBind">CoreBind</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li></ul></div><div id="interface"><h1 id="g:1">Constructing expressions</h1><div class="top"><p class="src"><a id="v:mkCast" class="def">mkCast</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Coercion.html#t:Coercion">Coercion</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> <a href="src/CoreUtils.html#mkCast" class="link">Source</a> <a href="#v:mkCast" class="selflink">#</a></p><div class="doc"><p>Wrap the given expression in the coercion safely, dropping
 identity coercions and coalescing nested coercions</p></div></div><div class="top"><p class="src"><a id="v:mkTick" class="def">mkTick</a> :: <a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> <a href="src/CoreUtils.html#mkTick" class="link">Source</a> <a href="#v:mkTick" class="selflink">#</a></p><div class="doc"><p>Wraps the given expression in the source annotation, dropping the
 annotation if possible.</p></div></div><div class="top"><p class="src"><a id="v:mkTicks" class="def">mkTicks</a> :: [<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a>] -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> <a href="src/CoreUtils.html#mkTicks" class="link">Source</a> <a href="#v:mkTicks" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mkTickNoHNF" class="def">mkTickNoHNF</a> :: <a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> <a href="src/CoreUtils.html#mkTickNoHNF" class="link">Source</a> <a href="#v:mkTickNoHNF" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tickHNFArgs" class="def">tickHNFArgs</a> :: <a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> <a href="src/CoreUtils.html#tickHNFArgs" class="link">Source</a> <a href="#v:tickHNFArgs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bindNonRec" class="def">bindNonRec</a> :: <a href="Var.html#t:Id">Id</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> <a href="src/CoreUtils.html#bindNonRec" class="link">Source</a> <a href="#v:bindNonRec" class="selflink">#</a></p><div class="doc"><p><code>bindNonRec x r b</code> produces either:</p><pre>let x = r in b</pre><p>or:</p><pre>case r of x { _DEFAULT_ -&gt; b }</pre><p>depending on whether we have to use a <code>case</code> or <code>let</code>
 binding for the expression (see <code><a href="CoreUtils.html#v:needsCaseBinding">needsCaseBinding</a></code>).
 It's used by the desugarer to avoid building bindings
 that give Core Lint a heart attack, although actually
 the simplifier deals with them perfectly well. See
 also <code><a href="MkCore.html#v:mkCoreLet">mkCoreLet</a></code></p></div></div><div class="top"><p class="src"><a id="v:needsCaseBinding" class="def">needsCaseBinding</a> :: <a href="Type.html#t:Type">Type</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#needsCaseBinding" class="link">Source</a> <a href="#v:needsCaseBinding" class="selflink">#</a></p><div class="doc"><p>Tests whether we have to use a <code>case</code> rather than <code>let</code> binding for this expression
 as per the invariants of <code><a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></code>: see <a href="CoreSyn.html#let_app_invariant">CoreSyn</a></p></div></div><div class="top"><p class="src"><a id="v:mkAltExpr" class="def">mkAltExpr</a> <a href="src/CoreUtils.html#mkAltExpr" class="link">Source</a> <a href="#v:mkAltExpr" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="CoreSyn.html#t:AltCon">AltCon</a></td><td class="doc"><p>Case alternative constructor</p></td></tr><tr><td class="src">-&gt; [<a href="CoreSyn.html#t:CoreBndr">CoreBndr</a>]</td><td class="doc"><p>Things bound by the pattern match</p></td></tr><tr><td class="src">-&gt; [<a href="Type.html#t:Type">Type</a>]</td><td class="doc"><p>The type arguments to the case alternative</p></td></tr><tr><td class="src">-&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>This guy constructs the value that the scrutinee must have
 given that you are in one particular branch of a case</p></div></div><h1 id="g:2">Taking expressions apart</h1><div class="top"><p class="src"><a id="v:findDefault" class="def">findDefault</a> :: [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [a], b)] -&gt; ([(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [a], b)], <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> b) <a href="src/CoreUtils.html#findDefault" class="link">Source</a> <a href="#v:findDefault" class="selflink">#</a></p><div class="doc"><p>Extract the default case alternative</p></div></div><div class="top"><p class="src"><a id="v:addDefault" class="def">addDefault</a> :: [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [a], b)] -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> b -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [a], b)] <a href="src/CoreUtils.html#addDefault" class="link">Source</a> <a href="#v:addDefault" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:findAlt" class="def">findAlt</a> :: <a href="CoreSyn.html#t:AltCon">AltCon</a> -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)] -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b) <a href="src/CoreUtils.html#findAlt" class="link">Source</a> <a href="#v:findAlt" class="selflink">#</a></p><div class="doc"><p>Find the case alternative corresponding to a particular
 constructor: panics if no such constructor exists</p></div></div><div class="top"><p class="src"><a id="v:isDefaultAlt" class="def">isDefaultAlt</a> :: (<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b) -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#isDefaultAlt" class="link">Source</a> <a href="#v:isDefaultAlt" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mergeAlts" class="def">mergeAlts</a> :: [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)] -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)] -&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, a, b)] <a href="src/CoreUtils.html#mergeAlts" class="link">Source</a> <a href="#v:mergeAlts" class="selflink">#</a></p><div class="doc"><p>Merge alternatives preserving order; alternatives in
 the first argument shadow ones in the second</p></div></div><div class="top"><p class="src"><a id="v:trimConArgs" class="def">trimConArgs</a> :: <a href="CoreSyn.html#t:AltCon">AltCon</a> -&gt; [<a href="CoreSyn.html#t:CoreArg">CoreArg</a>] -&gt; [<a href="CoreSyn.html#t:CoreArg">CoreArg</a>] <a href="src/CoreUtils.html#trimConArgs" class="link">Source</a> <a href="#v:trimConArgs" class="selflink">#</a></p><div class="doc"><p>Given:</p><pre>case (C a b x y) of
       C b x y -&gt; ...</pre><p>We want to drop the leading type argument of the scrutinee
 leaving the arguments to match against the pattern</p></div></div><div class="top"><p class="src"><a id="v:filterAlts" class="def">filterAlts</a> <a href="src/CoreUtils.html#filterAlts" class="link">Source</a> <a href="#v:filterAlts" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="TyCon.html#t:TyCon">TyCon</a></td><td class="doc"><p>Type constructor of scrutinee's type (used to prune possibilities)</p></td></tr><tr><td class="src">-&gt; [<a href="Type.html#t:Type">Type</a>]</td><td class="doc"><p>And its type arguments</p></td></tr><tr><td class="src">-&gt; [<a href="CoreSyn.html#t:AltCon">AltCon</a>]</td><td class="doc"><p><code>imposs_cons</code>: constructors known to be impossible due to the form of the scrutinee</p></td></tr><tr><td class="src">-&gt; [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [<a href="Var.html#t:Var">Var</a>], a)]</td><td class="doc"><p>Alternatives</p></td></tr><tr><td class="src">-&gt; ([<a href="CoreSyn.html#t:AltCon">AltCon</a>], [(<a href="CoreSyn.html#t:AltCon">AltCon</a>, [<a href="Var.html#t:Var">Var</a>], a)])</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:combineIdenticalAlts" class="def">combineIdenticalAlts</a> :: [<a href="CoreSyn.html#t:AltCon">AltCon</a>] -&gt; [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>] -&gt; (<a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>, [<a href="CoreSyn.html#t:AltCon">AltCon</a>], [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>]) <a href="src/CoreUtils.html#combineIdenticalAlts" class="link">Source</a> <a href="#v:combineIdenticalAlts" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:refineDefaultAlt" class="def">refineDefaultAlt</a> :: [<a href="Unique.html#t:Unique">Unique</a>] -&gt; <a href="TyCon.html#t:TyCon">TyCon</a> -&gt; [<a href="Type.html#t:Type">Type</a>] -&gt; [<a href="CoreSyn.html#t:AltCon">AltCon</a>] -&gt; [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>] -&gt; (<a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>, [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>]) <a href="src/CoreUtils.html#refineDefaultAlt" class="link">Source</a> <a href="#v:refineDefaultAlt" class="selflink">#</a></p></div><h1 id="g:3">Properties of expressions</h1><div class="top"><p class="src"><a id="v:exprType" class="def">exprType</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a> <a href="src/CoreUtils.html#exprType" class="link">Source</a> <a href="#v:exprType" class="selflink">#</a></p><div class="doc"><p>Recover the type of a well-typed Core expression. Fails when
 applied to the actual <code><a href="CoreSyn.html#v:Type">Type</a></code> expression as it cannot
 really be said to have a type</p></div></div><div class="top"><p class="src"><a id="v:coreAltType" class="def">coreAltType</a> :: <a href="CoreSyn.html#t:CoreAlt">CoreAlt</a> -&gt; <a href="Type.html#t:Type">Type</a> <a href="src/CoreUtils.html#coreAltType" class="link">Source</a> <a href="#v:coreAltType" class="selflink">#</a></p><div class="doc"><p>Returns the type of the alternatives right hand side</p></div></div><div class="top"><p class="src"><a id="v:coreAltsType" class="def">coreAltsType</a> :: [<a href="CoreSyn.html#t:CoreAlt">CoreAlt</a>] -&gt; <a href="Type.html#t:Type">Type</a> <a href="src/CoreUtils.html#coreAltsType" class="link">Source</a> <a href="#v:coreAltsType" class="selflink">#</a></p><div class="doc"><p>Returns the type of the first alternative, which should be the same as for all alternatives</p></div></div><div class="top"><p class="src"><a id="v:isExprLevPoly" class="def">isExprLevPoly</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#isExprLevPoly" class="link">Source</a> <a href="#v:isExprLevPoly" class="selflink">#</a></p><div class="doc"><p>Is this expression levity polymorphic? This should be the
 same as saying (isKindLevPoly . typeKind . exprType) but
 much faster.</p></div></div><div class="top"><p class="src"><a id="v:exprIsDupable" class="def">exprIsDupable</a> :: <a href="DynFlags.html#t:DynFlags">DynFlags</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsDupable" class="link">Source</a> <a href="#v:exprIsDupable" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsTrivial" class="def">exprIsTrivial</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsTrivial" class="link">Source</a> <a href="#v:exprIsTrivial" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getIdFromTrivialExpr" class="def">getIdFromTrivialExpr</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Var.html#t:Id">Id</a> <a href="src/CoreUtils.html#getIdFromTrivialExpr" class="link">Source</a> <a href="#v:getIdFromTrivialExpr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsBottom" class="def">exprIsBottom</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsBottom" class="link">Source</a> <a href="#v:exprIsBottom" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getIdFromTrivialExpr_maybe" class="def">getIdFromTrivialExpr_maybe</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Var.html#t:Id">Id</a> <a href="src/CoreUtils.html#getIdFromTrivialExpr_maybe" class="link">Source</a> <a href="#v:getIdFromTrivialExpr_maybe" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsCheap" class="def">exprIsCheap</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsCheap" class="link">Source</a> <a href="#v:exprIsCheap" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsExpandable" class="def">exprIsExpandable</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsExpandable" class="link">Source</a> <a href="#v:exprIsExpandable" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsOk" class="def">exprIsOk</a> :: <a href="CoreUtils.html#t:CheapAppFun">CheapAppFun</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsOk" class="link">Source</a> <a href="#v:exprIsOk" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:CheapAppFun" class="def">CheapAppFun</a> = <a href="Var.html#t:Id">Id</a> -&gt; <a href="BasicTypes.html#t:Arity">Arity</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#CheapAppFun" class="link">Source</a> <a href="#t:CheapAppFun" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsHNF" class="def">exprIsHNF</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsHNF" class="link">Source</a> <a href="#v:exprIsHNF" class="selflink">#</a></p><div class="doc"><p>exprIsHNF returns true for expressions that are certainly <em>already</em>
 evaluated to <em>head</em> normal form.  This is used to decide whether it's ok
 to change:</p><pre>case x of _ -&gt; e</pre><p>into:</p><pre>e</pre><p>and to decide whether it's safe to discard a <code><a href="../base-4.10.1.0/Prelude.html#v:seq">seq</a></code>.</p><p>So, it does <em>not</em> treat variables as evaluated, unless they say they are.
 However, it <em>does</em> treat partial applications and constructor applications
 as values, even if their arguments are non-trivial, provided the argument
 type is lifted. For example, both of these are values:</p><pre>(:) (f x) (map f xs)
map (...redex...)</pre><p>because <code><a href="../base-4.10.1.0/Prelude.html#v:seq">seq</a></code> on such things completes immediately.</p><p>For unlifted argument types, we have to be careful:</p><pre>C (f x :: Int#)</pre><p>Suppose <code>f x</code> diverges; then <code>C (f x)</code> is not a value. However this can't
 happen: see <a href="CoreSyn.html#let_app_invariant">CoreSyn</a>. This invariant states that arguments of
 unboxed type must be ok-for-speculation (or trivial).</p></div></div><div class="top"><p class="src"><a id="v:exprOkForSpeculation" class="def">exprOkForSpeculation</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprOkForSpeculation" class="link">Source</a> <a href="#v:exprOkForSpeculation" class="selflink">#</a></p><div class="doc"><p><code><a href="CoreUtils.html#v:exprOkForSpeculation">exprOkForSpeculation</a></code> returns True of an expression that is:</p><ul><li>Safe to evaluate even if normal order eval might not
    evaluate the expression at all, or</li><li>Safe <em>not</em> to evaluate even if normal order would do so</li></ul><p>It is usually called on arguments of unlifted type, but not always
 In particular, Simplify.rebuildCase calls it on lifted types
 when a 'case' is a plain <code><a href="../base-4.10.1.0/Prelude.html#v:seq">seq</a></code>. See the example in
 Note [exprOkForSpeculation: case expressions] below</p><p>Precisely, it returns <code>True</code> iff:
  a) The expression guarantees to terminate,
  b) soon,
  c) without causing a write side effect (e.g. writing a mutable variable)
  d) without throwing a Haskell exception
  e) without risking an unchecked runtime exception (array out of bounds,
     divide by zero)</p><p>For <code>exprOkForSideEffects</code> the list is the same, but omitting (e).</p><p>Note that
    exprIsHNF            implies exprOkForSpeculation
    exprOkForSpeculation implies exprOkForSideEffects</p><p>See Note [PrimOp can_fail and has_side_effects] in PrimOp
 and Note [Implementation: how can_fail/has_side_effects affect transformations]</p><p>As an example of the considerations in this test, consider:</p><pre>let x = case y# +# 1# of { r# -&gt; I# r# }
in E</pre><p>being translated to:</p><pre>case y# +# 1# of { r# -&gt;
   let x = I# r#
   in E
}</pre><p>We can only do this if the <code>y + 1</code> is ok for speculation: it has no
 side effects, and can't diverge or raise an exception.</p></div></div><div class="top"><p class="src"><a id="v:exprOkForSideEffects" class="def">exprOkForSideEffects</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprOkForSideEffects" class="link">Source</a> <a href="#v:exprOkForSideEffects" class="selflink">#</a></p><div class="doc"><p><code><a href="CoreUtils.html#v:exprOkForSpeculation">exprOkForSpeculation</a></code> returns True of an expression that is:</p><ul><li>Safe to evaluate even if normal order eval might not
    evaluate the expression at all, or</li><li>Safe <em>not</em> to evaluate even if normal order would do so</li></ul><p>It is usually called on arguments of unlifted type, but not always
 In particular, Simplify.rebuildCase calls it on lifted types
 when a 'case' is a plain <code><a href="../base-4.10.1.0/Prelude.html#v:seq">seq</a></code>. See the example in
 Note [exprOkForSpeculation: case expressions] below</p><p>Precisely, it returns <code>True</code> iff:
  a) The expression guarantees to terminate,
  b) soon,
  c) without causing a write side effect (e.g. writing a mutable variable)
  d) without throwing a Haskell exception
  e) without risking an unchecked runtime exception (array out of bounds,
     divide by zero)</p><p>For <code>exprOkForSideEffects</code> the list is the same, but omitting (e).</p><p>Note that
    exprIsHNF            implies exprOkForSpeculation
    exprOkForSpeculation implies exprOkForSideEffects</p><p>See Note [PrimOp can_fail and has_side_effects] in PrimOp
 and Note [Implementation: how can_fail/has_side_effects affect transformations]</p><p>As an example of the considerations in this test, consider:</p><pre>let x = case y# +# 1# of { r# -&gt; I# r# }
in E</pre><p>being translated to:</p><pre>case y# +# 1# of { r# -&gt;
   let x = I# r#
   in E
}</pre><p>We can only do this if the <code>y + 1</code> is ok for speculation: it has no
 side effects, and can't diverge or raise an exception.</p></div></div><div class="top"><p class="src"><a id="v:exprIsWorkFree" class="def">exprIsWorkFree</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsWorkFree" class="link">Source</a> <a href="#v:exprIsWorkFree" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsBig" class="def">exprIsBig</a> :: <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsBig" class="link">Source</a> <a href="#v:exprIsBig" class="selflink">#</a></p><div class="doc"><p>Returns <code>True</code> of expressions that are too big to be compared by <code><a href="CoreUtils.html#v:cheapEqExpr">cheapEqExpr</a></code></p></div></div><div class="top"><p class="src"><a id="v:exprIsConLike" class="def">exprIsConLike</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsConLike" class="link">Source</a> <a href="#v:exprIsConLike" class="selflink">#</a></p><div class="doc"><p>Similar to <code><a href="CoreUtils.html#v:exprIsHNF">exprIsHNF</a></code> but includes CONLIKE functions as well as
 data constructors. Conlike arguments are considered interesting by the
 inliner.</p></div></div><div class="top"><p class="src"><a id="v:rhsIsStatic" class="def">rhsIsStatic</a> :: <a href="Platform.html#t:Platform">Platform</a> -&gt; (<a href="Name.html#t:Name">Name</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>) -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#rhsIsStatic" class="link">Source</a> <a href="#v:rhsIsStatic" class="selflink">#</a></p><div class="doc"><p>This function is called only on *top-level* right-hand sides.
 Returns <code>True</code> if the RHS can be allocated statically in the output,
 with no thunks involved at all.</p></div></div><div class="top"><p class="src"><a id="v:isCheapApp" class="def">isCheapApp</a> :: <a href="CoreUtils.html#t:CheapAppFun">CheapAppFun</a> <a href="src/CoreUtils.html#isCheapApp" class="link">Source</a> <a href="#v:isCheapApp" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:isExpandableApp" class="def">isExpandableApp</a> :: <a href="CoreUtils.html#t:CheapAppFun">CheapAppFun</a> <a href="src/CoreUtils.html#isExpandableApp" class="link">Source</a> <a href="#v:isExpandableApp" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsLiteralString" class="def">exprIsLiteralString</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsLiteralString" class="link">Source</a> <a href="#v:exprIsLiteralString" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:exprIsTopLevelBindable" class="def">exprIsTopLevelBindable</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#exprIsTopLevelBindable" class="link">Source</a> <a href="#v:exprIsTopLevelBindable" class="selflink">#</a></p><div class="doc"><p>Can we bind this <code><a href="CoreSyn.html#t:CoreExpr">CoreExpr</a></code> at the top level?</p></div></div><h1 id="g:4">Equality</h1><div class="top"><p class="src"><a id="v:cheapEqExpr" class="def">cheapEqExpr</a> :: <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#cheapEqExpr" class="link">Source</a> <a href="#v:cheapEqExpr" class="selflink">#</a></p><div class="doc"><p>A cheap equality test which bales out fast!
      If it returns <code>True</code> the arguments are definitely equal,
      otherwise, they may or may not be equal.</p><p>See also <code><a href="CoreUtils.html#v:exprIsBig">exprIsBig</a></code></p></div></div><div class="top"><p class="src"><a id="v:cheapEqExpr-39-" class="def">cheapEqExpr'</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#cheapEqExpr%27" class="link">Source</a> <a href="#v:cheapEqExpr-39-" class="selflink">#</a></p><div class="doc"><p>Cheap expression equality test, can ignore ticks by type.</p></div></div><div class="top"><p class="src"><a id="v:eqExpr" class="def">eqExpr</a> :: <a href="VarEnv.html#t:InScopeSet">InScopeSet</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#eqExpr" class="link">Source</a> <a href="#v:eqExpr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:diffExpr" class="def">diffExpr</a> :: <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="VarEnv.html#t:RnEnv2">RnEnv2</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; [<a href="Outputable.html#t:SDoc">SDoc</a>] <a href="src/CoreUtils.html#diffExpr" class="link">Source</a> <a href="#v:diffExpr" class="selflink">#</a></p><div class="doc"><p>Finds differences between core expressions, modulo alpha and
 renaming. Setting <code>top</code> means that the <code>IdInfo</code> of bindings will be
 checked for differences as well.</p></div></div><div class="top"><p class="src"><a id="v:diffBinds" class="def">diffBinds</a> :: <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="VarEnv.html#t:RnEnv2">RnEnv2</a> -&gt; [(<a href="Var.html#t:Var">Var</a>, <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>)] -&gt; [(<a href="Var.html#t:Var">Var</a>, <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>)] -&gt; ([<a href="Outputable.html#t:SDoc">SDoc</a>], <a href="VarEnv.html#t:RnEnv2">RnEnv2</a>) <a href="src/CoreUtils.html#diffBinds" class="link">Source</a> <a href="#v:diffBinds" class="selflink">#</a></p><div class="doc"><p>Finds differences between core bindings, see <code>diffExpr</code>.</p><p>The main problem here is that while we expect the binds to have the
 same order in both lists, this is not guaranteed. To do this
 properly we'd either have to do some sort of unification or check
 all possible mappings, which would be seriously expensive. So
 instead we simply match single bindings as far as we can. This
 leaves us just with mutually recursive and/or mismatching bindings,
 which we then speculatively match by ordering them. It's by no means
 perfect, but gets the job done well enough.</p></div></div><h1 id="g:5">Eta reduction</h1><div class="top"><p class="src"><a id="v:tryEtaReduce" class="def">tryEtaReduce</a> :: [<a href="Var.html#t:Var">Var</a>] -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> <a href="src/CoreUtils.html#tryEtaReduce" class="link">Source</a> <a href="#v:tryEtaReduce" class="selflink">#</a></p></div><h1 id="g:6">Manipulating data constructors and types</h1><div class="top"><p class="src"><a id="v:exprToType" class="def">exprToType</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a> <a href="src/CoreSyn.html#exprToType" class="link">Source</a> <a href="#v:exprToType" class="selflink">#</a></p><div class="doc"><p>If the expression is a <code><a href="Type.html#t:Type">Type</a></code>, converts. Otherwise,
 panics. NB: This does <em>not</em> convert <code><a href="Coercion.html#t:Coercion">Coercion</a></code> to <code>CoercionTy</code>.</p></div></div><div class="top"><p class="src"><a id="v:exprToCoercion_maybe" class="def">exprToCoercion_maybe</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Coercion.html#t:Coercion">Coercion</a> <a href="src/CoreSyn.html#exprToCoercion_maybe" class="link">Source</a> <a href="#v:exprToCoercion_maybe" class="selflink">#</a></p><div class="doc"><p>If the expression is a <code><a href="Coercion.html#t:Coercion">Coercion</a></code>, converts.</p></div></div><div class="top"><p class="src"><a id="v:applyTypeToArgs" class="def">applyTypeToArgs</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a> -&gt; [<a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>] -&gt; <a href="Type.html#t:Type">Type</a> <a href="src/CoreUtils.html#applyTypeToArgs" class="link">Source</a> <a href="#v:applyTypeToArgs" class="selflink">#</a></p><div class="doc"><p>A more efficient version of <code><a href="CoreUtils.html#v:applyTypeToArg">applyTypeToArg</a></code> when we have several arguments.
 The first argument is just for debugging, and gives some context</p></div></div><div class="top"><p class="src"><a id="v:applyTypeToArg" class="def">applyTypeToArg</a> :: <a href="Type.html#t:Type">Type</a> -&gt; <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="Type.html#t:Type">Type</a> <a href="src/CoreSyn.html#applyTypeToArg" class="link">Source</a> <a href="#v:applyTypeToArg" class="selflink">#</a></p><div class="doc"><p>Determines the type resulting from applying an expression with given type
 to a given argument expression</p></div></div><div class="top"><p class="src"><a id="v:dataConRepInstPat" class="def">dataConRepInstPat</a> :: [<a href="Unique.html#t:Unique">Unique</a>] -&gt; <a href="DataCon.html#t:DataCon">DataCon</a> -&gt; [<a href="Type.html#t:Type">Type</a>] -&gt; ([<a href="Var.html#t:TyVar">TyVar</a>], [<a href="Var.html#t:Id">Id</a>]) <a href="src/CoreUtils.html#dataConRepInstPat" class="link">Source</a> <a href="#v:dataConRepInstPat" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:dataConRepFSInstPat" class="def">dataConRepFSInstPat</a> :: [<a href="FastString.html#t:FastString">FastString</a>] -&gt; [<a href="Unique.html#t:Unique">Unique</a>] -&gt; <a href="DataCon.html#t:DataCon">DataCon</a> -&gt; [<a href="Type.html#t:Type">Type</a>] -&gt; ([<a href="Var.html#t:TyVar">TyVar</a>], [<a href="Var.html#t:Id">Id</a>]) <a href="src/CoreUtils.html#dataConRepFSInstPat" class="link">Source</a> <a href="#v:dataConRepFSInstPat" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:isEmptyTy" class="def">isEmptyTy</a> :: <a href="Type.html#t:Type">Type</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#isEmptyTy" class="link">Source</a> <a href="#v:isEmptyTy" class="selflink">#</a></p><div class="doc"><p>True if the type has no non-bottom elements, e.g. when it is an empty
 datatype, or a GADT with non-satisfiable type parameters, e.g. Int :~: Bool.
 See Note [Bottoming expressions]</p><p>See Note [No alternatives lint check] for another use of this function.</p></div></div><h1 id="g:7">Working with ticks</h1><div class="top"><p class="src"><a id="v:stripTicksTop" class="def">stripTicksTop</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; ([<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a>], <a href="CoreSyn.html#t:Expr">Expr</a> b) <a href="src/CoreUtils.html#stripTicksTop" class="link">Source</a> <a href="#v:stripTicksTop" class="selflink">#</a></p><div class="doc"><p>Strip ticks satisfying a predicate from top of an expression</p></div></div><div class="top"><p class="src"><a id="v:stripTicksTopE" class="def">stripTicksTopE</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b <a href="src/CoreUtils.html#stripTicksTopE" class="link">Source</a> <a href="#v:stripTicksTopE" class="selflink">#</a></p><div class="doc"><p>Strip ticks satisfying a predicate from top of an expression,
 returning the remaining expression</p></div></div><div class="top"><p class="src"><a id="v:stripTicksTopT" class="def">stripTicksTopT</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; [<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a>] <a href="src/CoreUtils.html#stripTicksTopT" class="link">Source</a> <a href="#v:stripTicksTopT" class="selflink">#</a></p><div class="doc"><p>Strip ticks satisfying a predicate from top of an expression,
 returning the ticks</p></div></div><div class="top"><p class="src"><a id="v:stripTicksE" class="def">stripTicksE</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b <a href="src/CoreUtils.html#stripTicksE" class="link">Source</a> <a href="#v:stripTicksE" class="selflink">#</a></p><div class="doc"><p>Completely strip ticks satisfying a predicate from an
 expression. Note this is O(n) in the size of the expression!</p></div></div><div class="top"><p class="src"><a id="v:stripTicksT" class="def">stripTicksT</a> :: (<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="CoreSyn.html#t:Expr">Expr</a> b -&gt; [<a href="CoreSyn.html#t:Tickish">Tickish</a> <a href="Var.html#t:Id">Id</a>] <a href="src/CoreUtils.html#stripTicksT" class="link">Source</a> <a href="#v:stripTicksT" class="selflink">#</a></p></div><h1 id="g:8">StaticPtr</h1><div class="top"><p class="src"><a id="v:collectMakeStaticArgs" class="def">collectMakeStaticArgs</a> :: <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a> -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>, <a href="Type.html#t:Type">Type</a>, <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>, <a href="CoreSyn.html#t:CoreExpr">CoreExpr</a>) <a href="src/CoreUtils.html#collectMakeStaticArgs" class="link">Source</a> <a href="#v:collectMakeStaticArgs" class="selflink">#</a></p><div class="doc"><p><code>collectMakeStaticArgs (makeStatic t srcLoc e)</code> yields
 <code>Just (makeStatic, t, srcLoc, e)</code>.</p><p>Returns <code>Nothing</code> for every other expression.</p></div></div><h1 id="g:9">Join points</h1><div class="top"><p class="src"><a id="v:isJoinBind" class="def">isJoinBind</a> :: <a href="CoreSyn.html#t:CoreBind">CoreBind</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/CoreUtils.html#isJoinBind" class="link">Source</a> <a href="#v:isJoinBind" class="selflink">#</a></p><div class="doc"><p>Does this binding bind a join point (or a recursive group of join points)?</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.18.1</p></div></body></html>