<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns, DataKinds, ExtendedDefaultRules          #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts, GADTs, MultiParamTypeClasses         #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude, OverloadedLabels, OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms, PolyKinds, RecordWildCards            #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables, TupleSections, TypeApplications   #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns                                           #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-name-shadowing #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-type-defaults #-}</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Ring.Polynomial.Factorise</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Factorisation</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorise"><span class="hs-identifier">factorise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorQBigPrime"><span class="hs-identifier">factorQBigPrime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorHensel"><span class="hs-identifier">factorHensel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#isReducible"><span class="hs-identifier">isReducible</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal helper functions</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#distinctDegFactor"><span class="hs-identifier">distinctDegFactor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#equalDegreeSplitM"><span class="hs-identifier">equalDegreeSplitM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#equalDegreeFactorM"><span class="hs-identifier">equalDegreeFactorM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#henselStep"><span class="hs-identifier">henselStep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#multiHensel"><span class="hs-identifier">multiHensel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#clearDenom"><span class="hs-identifier">clearDenom</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreePart"><span class="hs-identifier">squareFreePart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#pthRoot"><span class="hs-identifier">pthRoot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#yun"><span class="hs-identifier">yun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreeDecompFiniteField"><span class="hs-identifier">squareFreeDecompFiniteField</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algebra.Arithmetic</span></span><span>                 </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">modPow</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algebra.Field.Prime</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algebra.Prelude.Core</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algebra.Ring.Euclidean.Quotient</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algebra.Ring.Polynomial.Univariate</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">both</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ifoldMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(%~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Loops</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">untilJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Random</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadRandom</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Random</span></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>                                                     </span><span class="annot"><span class="hs-identifier">getRandom</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getRandomR</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.DList</span></span><span>                         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DL</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.FMList</span></span><span>                        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FML</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IntMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap.Strict</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Math.NumberTheory.Primes</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Prime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">precPrime</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Math.NumberTheory.Primes</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Prime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unPrime</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Math.NumberTheory.Primes</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PRIMES</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Decidable.Zero</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isZero</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Domain.GCD</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">gcd</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lcm</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Field.Fraction</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | @distinctDegFactor f@ computes the distinct-degree decomposition of the given</span><span>
</span><span id="line-51"></span><span class="hs-comment">--   square-free polynomial over finite field @f@.</span><span>
</span><span id="line-52"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#distinctDegFactor"><span class="hs-identifier hs-type">distinctDegFactor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164375"><span class="annot"><a href="#local-6989586621679164375"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679164375"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164375"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164375"><span class="hs-identifier hs-type">k</span></a></span><span>     </span><span class="hs-comment">-- ^ Square-free polynomial over finite field.</span><span>
</span><span id="line-54"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164375"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ Distinct-degree decomposition.</span><span>
</span><span id="line-55"></span><span id="distinctDegFactor"><span class="annot"><span class="annottext">distinctDegFactor :: Unipol k -&gt; [(Natural, Unipol k)]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#distinctDegFactor"><span class="hs-identifier hs-var hs-var">distinctDegFactor</span></a></span></span><span> </span><span id="local-6989586621679164128"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164128"><span class="hs-identifier hs-var">f0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Natural] -&gt; [Unipol k] -&gt; [(Natural, Unipol k)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [(Natural, Unipol k)])
-&gt; [Unipol k] -&gt; [(Natural, Unipol k)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [Unipol k])
-&gt; Unipol k -&gt; Unipol k -&gt; [Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164127"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k)) -&gt; Unipol k
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k))
forall (n :: Nat). (0 &lt; n) =&gt; Ordinal n
</span><span class="hs-identifier hs-var">OZ</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164375"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164128"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679164127"><span class="annot"><span class="annottext">go :: ([Unipol k] -&gt; [Unipol k])
-&gt; Unipol k -&gt; Unipol k -&gt; [Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164127"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679164123"><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164123"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621679164122"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164122"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679164121"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164121"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-58"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164120"><span class="annot"><span class="annottext">h&#39; :: Unipol k
</span><a href="#local-6989586621679164120"><span class="hs-identifier hs-var hs-var">h&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; Unipol k -&gt; Unipol k
forall poly. Euclidean poly =&gt; poly -&gt; Natural -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Factorise.html#modPow"><span class="hs-identifier hs-var">modPow</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164122"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy k -&gt; Natural
forall k (proxy :: * -&gt; *). FiniteField k =&gt; proxy k -&gt; Natural
</span><span class="hs-identifier hs-var">order</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy k
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679164375"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164121"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-59"></span><span>          </span><span id="local-6989586621679164116"><span class="annot"><span class="annottext">g&#39; :: Unipol k
</span><a href="#local-6989586621679164116"><span class="hs-identifier hs-var hs-var">g&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164120"><span class="hs-identifier hs-var">h&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k)) -&gt; Unipol k
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k))
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164121"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-60"></span><span>          </span><span id="local-6989586621679164114"><span class="annot"><span class="annottext">f&#39; :: Unipol k
</span><a href="#local-6989586621679164114"><span class="hs-identifier hs-var hs-var">f&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164121"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164116"><span class="hs-identifier hs-var">g&#39;</span></a></span><span>
</span><span id="line-61"></span><span>          </span><span id="local-6989586621679164112"><span class="annot"><span class="annottext">gs&#39; :: [Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164112"><span class="hs-identifier hs-var hs-var">gs&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164123"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [Unipol k])
-&gt; ([Unipol k] -&gt; [Unipol k]) -&gt; [Unipol k] -&gt; [Unipol k]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164116"><span class="hs-identifier hs-var">g&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; [Unipol k] -&gt; [Unipol k]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164114"><span class="hs-identifier hs-var">f&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-63"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164112"><span class="hs-identifier hs-var">gs&#39;</span></a></span><span>
</span><span id="line-64"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [Unipol k])
-&gt; Unipol k -&gt; Unipol k -&gt; [Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164127"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164112"><span class="hs-identifier hs-var">gs&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164120"><span class="hs-identifier hs-var">h&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164114"><span class="hs-identifier hs-var">f&#39;</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | @&#39;modPow&#39; f n g@ computes \(f^n \mod{g}\).</span><span>
</span><span id="line-67"></span><span id="local-6989586621679164480"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#modPow"><span class="hs-identifier hs-type">modPow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679164480"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164480"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164480"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164480"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-69"></span><span id="modPow"><span class="annot"><span class="annottext">modPow :: poly -&gt; Natural -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Factorise.html#modPow"><span class="hs-identifier hs-var hs-var">modPow</span></a></span></span><span> </span><span id="local-6989586621679164109"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679164109"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679164108"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164108"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679164107"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679164107"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; (forall r. Reifies r poly =&gt; Quotient r poly) -&gt; poly
forall a.
Euclidean a =&gt;
a -&gt; (forall r. Reifies r a =&gt; Quotient r a) -&gt; a
</span><span class="hs-identifier hs-var">withQuotient</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679164107"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r. Reifies r poly =&gt; Quotient r poly) -&gt; poly)
-&gt; (forall r. Reifies r poly =&gt; Quotient r poly) -&gt; poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="annottext">Quotient r poly -&gt; Natural -&gt; Quotient r poly
forall r. Multiplicative r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-identifier hs-var">repeatedSquare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; Quotient r poly
forall k (r :: k) a.
(Reifies r a, Euclidean a) =&gt;
a -&gt; Quotient r a
</span><span class="hs-identifier hs-var">quotient</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679164109"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164108"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span id="local-6989586621679164405"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#traceCharTwo"><span class="hs-identifier hs-type">traceCharTwo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unital</span></span><span> </span><span class="annot"><a href="#local-6989586621679164405"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoidal</span></span><span> </span><span class="annot"><a href="#local-6989586621679164405"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164405"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164405"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-73"></span><span id="traceCharTwo"><span class="annot"><span class="annottext">traceCharTwo :: Natural -&gt; m -&gt; m
</span><a href="Algebra.Ring.Polynomial.Factorise.html#traceCharTwo"><span class="hs-identifier hs-var hs-var">traceCharTwo</span></a></span></span><span> </span><span id="local-6989586621679164102"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164102"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679164101"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679164101"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m -&gt; m -&gt; m) -&gt; m -&gt; [m] -&gt; m
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl&#39;</span></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">m
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="annot"><span class="annottext">([m] -&gt; m) -&gt; [m] -&gt; m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [m] -&gt; [m]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164102"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([m] -&gt; [m]) -&gt; [m] -&gt; [m]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(m -&gt; m) -&gt; m -&gt; [m]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679164095"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679164095"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679164095"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679164095"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679164101"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#equalDegreeSplitM"><span class="hs-identifier hs-type">equalDegreeSplitM</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164395"><span class="annot"><a href="#local-6989586621679164395"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679164396"><span class="annot"><a href="#local-6989586621679164396"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679164396"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Random</span></span><span> </span><span class="annot"><a href="#local-6989586621679164395"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoeffRing</span></span><span> </span><span class="annot"><a href="#local-6989586621679164395"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164395"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164395"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164396"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164395"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span id="equalDegreeSplitM"><span class="annot"><span class="annottext">equalDegreeSplitM :: Unipol k -&gt; Natural -&gt; m (Maybe (Unipol k))
</span><a href="Algebra.Ring.Polynomial.Factorise.html#equalDegreeSplitM"><span class="hs-identifier hs-var hs-var">equalDegreeSplitM</span></a></span></span><span> </span><span id="local-6989586621679164093"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679164092"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164092"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164091"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164092"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Unipol k) -&gt; m (Maybe (Unipol k))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Unipol k)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164088"><span class="annot"><span class="annottext">q :: Natural
</span><a href="#local-6989586621679164088"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Natural) -&gt; Natural -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy k -&gt; Natural
forall k (proxy :: * -&gt; *). FiniteField k =&gt; proxy k -&gt; Natural
</span><span class="hs-identifier hs-var">order</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy k
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679164395"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679164087"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164087"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; m Int
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><span class="hs-identifier hs-var">getRandomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164091"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679164086"><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679164086"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; m k -&gt; m [k]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164087"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m k
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><span class="hs-identifier hs-var">getRandom</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164085"><span class="annot"><span class="annottext">a :: Unipol k
</span><a href="#local-6989586621679164085"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k)) -&gt; Unipol k
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k))
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; Unipol k
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164087"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span>
</span><span id="line-87"></span><span>            </span><span class="annot"><span class="annottext">[Unipol k] -&gt; Unipol k
forall (f :: * -&gt; *) m. (Foldable f, Monoidal m) =&gt; f m -&gt; m
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Unipol k -&gt; Unipol k -&gt; Unipol k)
-&gt; [Unipol k] -&gt; [Unipol k] -&gt; [Unipol k]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; Unipol k) -&gt; [k] -&gt; [Unipol k]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Unipol k
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly
</span><span class="hs-identifier hs-var">injectCoeff</span></span><span> </span><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679164086"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k)) -&gt; Unipol k
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k))
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; Unipol k
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164079"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679164079"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164079"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>        </span><span id="local-6989586621679164078"><span class="annot"><span class="annottext">g1 :: Unipol k
</span><a href="#local-6989586621679164078"><span class="hs-identifier hs-var hs-var">g1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164085"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Unipol k) -&gt; m (Maybe (Unipol k))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Unipol k) -&gt; m (Maybe (Unipol k)))
-&gt; Maybe (Unipol k) -&gt; m (Maybe (Unipol k))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164078"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe (Unipol k) -&gt; Maybe (Unipol k)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Maybe (Unipol k)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164078"><span class="hs-identifier hs-var">g1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>         </span><span class="annot"><span class="annottext">Maybe (Unipol k) -&gt; Maybe (Unipol k) -&gt; Maybe (Unipol k)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164077"><span class="annot"><span class="annottext">b :: Unipol k
</span><a href="#local-6989586621679164077"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural
forall r. Characteristic r =&gt; Unipol r -&gt; Natural
</span><a href="Algebra.Ring.Polynomial.Factorise.html#charUnipol"><span class="hs-identifier hs-var">charUnipol</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>                          </span><span class="annot"><span class="annottext">Unipol k
-&gt; (forall r. Reifies r (Unipol k) =&gt; Quotient r (Unipol k))
-&gt; Unipol k
forall a.
Euclidean a =&gt;
a -&gt; (forall r. Reifies r a =&gt; Quotient r a) -&gt; a
</span><span class="hs-identifier hs-var">withQuotient</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r. Reifies r (Unipol k) =&gt; Quotient r (Unipol k))
 -&gt; Unipol k)
-&gt; (forall r. Reifies r (Unipol k) =&gt; Quotient r (Unipol k))
-&gt; Unipol k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-92"></span><span>                          </span><span class="annot"><span class="annottext">Natural -&gt; Quotient r (Unipol k) -&gt; Quotient r (Unipol k)
forall m. (Unital m, Monoidal m) =&gt; Natural -&gt; m -&gt; m
</span><a href="Algebra.Ring.Polynomial.Factorise.html#traceCharTwo"><span class="hs-identifier hs-var">traceCharTwo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k -&gt; Natural
forall r. FiniteField r =&gt; Unipol r -&gt; Natural
</span><a href="Algebra.Ring.Polynomial.Factorise.html#powerUnipol"><span class="hs-identifier hs-var">powerUnipol</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164092"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k -&gt; Quotient r (Unipol k)
forall k (r :: k) a.
(Reifies r a, Euclidean a) =&gt;
a -&gt; Quotient r a
</span><span class="hs-identifier hs-var">quotient</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164085"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; Unipol k -&gt; Unipol k
forall poly. Euclidean poly =&gt; poly -&gt; Natural -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Factorise.html#modPow"><span class="hs-identifier hs-var">modPow</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164085"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Natural
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164088"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164092"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-94"></span><span>                    </span><span id="local-6989586621679164072"><span class="annot"><span class="annottext">g2 :: Unipol k
</span><a href="#local-6989586621679164072"><span class="hs-identifier hs-var hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164077"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-95"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164072"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164072"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>                </span><span class="annot"><span class="annottext">Unipol k -&gt; Maybe (Unipol k)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164072"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679164091"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679164091"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164093"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621679164379"><span id="local-6989586621679164380"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#equalDegreeFactorM"><span class="hs-identifier hs-type">equalDegreeFactorM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679164380"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164380"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679164379"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Random</span></span><span> </span><span class="annot"><a href="#local-6989586621679164380"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164380"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164379"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164380"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-101"></span><span id="equalDegreeFactorM"><span class="annot"><span class="annottext">equalDegreeFactorM :: Unipol k -&gt; Natural -&gt; m [Unipol k]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#equalDegreeFactorM"><span class="hs-identifier hs-var hs-var">equalDegreeFactorM</span></a></span></span><span> </span><span id="local-6989586621679164069"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164069"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679164068"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164068"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; m ([Unipol k] -&gt; [Unipol k])
</span><a href="#local-6989586621679164067"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164069"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m ([Unipol k] -&gt; [Unipol k])
-&gt; (([Unipol k] -&gt; [Unipol k]) -&gt; m [Unipol k]) -&gt; m [Unipol k]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679164066"><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164066"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Unipol k] -&gt; m [Unipol k]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164066"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679164067"><span class="annot"><span class="annottext">go :: Unipol k -&gt; m ([Unipol k] -&gt; [Unipol k])
</span><a href="#local-6989586621679164067"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679164065"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164065"><span class="hs-identifier hs-var">h</span></a></span></span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164065"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [Unipol k]) -&gt; m ([Unipol k] -&gt; [Unipol k])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164065"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164068"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [Unipol k]) -&gt; m ([Unipol k] -&gt; [Unipol k])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164065"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Unipol k -&gt; [Unipol k] -&gt; [Unipol k]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>          </span><span id="local-6989586621679164064"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164064"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Maybe (Unipol k)) -&gt; m (Unipol k)
forall (m :: * -&gt; *) a. Monad m =&gt; m (Maybe a) -&gt; m a
</span><span class="hs-identifier hs-var">untilJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; m (Maybe (Unipol k))
forall k (m :: * -&gt; *).
(MonadRandom m, Random k, CoeffRing k, FiniteField k) =&gt;
Unipol k -&gt; Natural -&gt; m (Maybe (Unipol k))
</span><a href="Algebra.Ring.Polynomial.Factorise.html#equalDegreeSplitM"><span class="hs-identifier hs-var">equalDegreeSplitM</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164065"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164068"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>          </span><span id="local-6989586621679164063"><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164063"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; m ([Unipol k] -&gt; [Unipol k])
</span><a href="#local-6989586621679164067"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164064"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-109"></span><span>          </span><span id="local-6989586621679164062"><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164062"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; m ([Unipol k] -&gt; [Unipol k])
</span><a href="#local-6989586621679164067"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164065"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164064"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>          </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [Unipol k]) -&gt; m ([Unipol k] -&gt; [Unipol k])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(([Unipol k] -&gt; [Unipol k]) -&gt; m ([Unipol k] -&gt; [Unipol k]))
-&gt; ([Unipol k] -&gt; [Unipol k]) -&gt; m ([Unipol k] -&gt; [Unipol k])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164063"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [Unipol k])
-&gt; ([Unipol k] -&gt; [Unipol k]) -&gt; [Unipol k] -&gt; [Unipol k]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Unipol k] -&gt; [Unipol k]
</span><a href="#local-6989586621679164062"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679164297"><span id="local-6989586621679164298"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorSquareFree"><span class="hs-identifier hs-type">factorSquareFree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679164298"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Random</span></span><span> </span><span class="annot"><a href="#local-6989586621679164298"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164298"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679164297"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164298"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164297"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164298"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-114"></span><span id="factorSquareFree"><span class="annot"><span class="annottext">factorSquareFree :: Unipol k -&gt; m [Unipol k]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorSquareFree"><span class="hs-identifier hs-var hs-var">factorSquareFree</span></a></span></span><span> </span><span id="local-6989586621679164060"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164060"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>   </span><span class="annot"><span class="annottext">[[Unipol k]] -&gt; [Unipol k]
forall w. Monoid w =&gt; [w] -&gt; w
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Unipol k]] -&gt; [Unipol k]) -&gt; m [[Unipol k]] -&gt; m [Unipol k]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Natural, Unipol k) -&gt; m [Unipol k])
-&gt; [(Natural, Unipol k)] -&gt; m [[Unipol k]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Natural -&gt; Unipol k -&gt; m [Unipol k])
-&gt; (Natural, Unipol k) -&gt; m [Unipol k]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">((Natural -&gt; Unipol k -&gt; m [Unipol k])
 -&gt; (Natural, Unipol k) -&gt; m [Unipol k])
-&gt; (Natural -&gt; Unipol k -&gt; m [Unipol k])
-&gt; (Natural, Unipol k)
-&gt; m [Unipol k]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Unipol k -&gt; Natural -&gt; m [Unipol k])
-&gt; Natural -&gt; Unipol k -&gt; m [Unipol k]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; m [Unipol k]
forall k (m :: * -&gt; *).
(Eq k, FiniteField k, MonadRandom m, Random k) =&gt;
Unipol k -&gt; Natural -&gt; m [Unipol k]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#equalDegreeFactorM"><span class="hs-identifier hs-var">equalDegreeFactorM</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Natural, Unipol k) -&gt; Bool)
-&gt; [(Natural, Unipol k)] -&gt; [(Natural, Unipol k)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Unipol k -&gt; Bool)
-&gt; ((Natural, Unipol k) -&gt; Unipol k) -&gt; (Natural, Unipol k) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Natural, Unipol k) -&gt; Unipol k
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Natural, Unipol k)] -&gt; [(Natural, Unipol k)])
-&gt; [(Natural, Unipol k)] -&gt; [(Natural, Unipol k)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; [(Natural, Unipol k)]
forall k.
(Eq k, FiniteField k) =&gt;
Unipol k -&gt; [(Natural, Unipol k)]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#distinctDegFactor"><span class="hs-identifier hs-var">distinctDegFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164060"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679164371"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreePart"><span class="hs-identifier hs-type">squareFreePart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679164371"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164371"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164371"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164371"><span class="hs-identifier hs-type">k</span></a></span></span><span>
</span><span id="line-119"></span><span id="squareFreePart"><span class="annot"><span class="annottext">squareFreePart :: Unipol k -&gt; Unipol k
</span><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreePart"><span class="hs-identifier hs-var hs-var">squareFreePart</span></a></span></span><span> </span><span id="local-6989586621679164054"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164054"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679164053"><span class="annot"><span class="annottext">n :: Natural
</span><a href="#local-6989586621679164053"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Natural) -&gt; Int -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164054"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span id="local-6989586621679164052"><span class="annot"><span class="annottext">u :: Unipol k
</span><a href="#local-6989586621679164052"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164054"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k)) -&gt; Unipol k -&gt; Unipol k
forall poly.
IsOrderedPolynomial poly =&gt;
Ordinal (Arity poly) -&gt; poly -&gt; poly
</span><span class="hs-identifier hs-var">diff</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol k))
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164054"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>      </span><span id="local-6989586621679164050"><span class="annot"><span class="annottext">v :: Unipol k
</span><a href="#local-6989586621679164050"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164054"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164052"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span id="local-6989586621679164049"><span class="annot"><span class="annottext">f&#39; :: Unipol k
</span><a href="#local-6989586621679164049"><span class="hs-identifier hs-var hs-var">f&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164052"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164052"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164050"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; Unipol k
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164053"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164049"><span class="hs-identifier hs-var">f&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-125"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164050"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-126"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164050"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k
forall k. (Eq k, FiniteField k) =&gt; Unipol k -&gt; Unipol k
</span><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreePart"><span class="hs-identifier hs-var">squareFreePart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k
forall r. (CoeffRing r, FiniteField r) =&gt; Unipol r -&gt; Unipol r
</span><a href="Algebra.Ring.Polynomial.Factorise.html#pthRoot"><span class="hs-identifier hs-var">pthRoot</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164049"><span class="hs-identifier hs-var">f&#39;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Yun&#39;s method to compute square-free decomposition of</span><span>
</span><span id="line-129"></span><span class="hs-comment">--   a univariate polynomial over field of characteristic \(0\).</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">--   Use &#39;squareFreeDecompFiniteField&#39; for finite fields.</span><span>
</span><span id="line-132"></span><span id="local-6989586621679164350"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#yun"><span class="hs-identifier hs-type">yun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CoeffRing</span></span><span> </span><span class="annot"><a href="#local-6989586621679164350"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679164350"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164350"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164350"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-134"></span><span id="yun"><span class="annot"><span class="annottext">yun :: Unipol r -&gt; IntMap (Unipol r)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#yun"><span class="hs-identifier hs-var hs-var">yun</span></a></span></span><span> </span><span id="local-6989586621679164048"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164048"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164047"><span class="annot"><span class="annottext">f&#39; :: Unipol r
</span><a href="#local-6989586621679164047"><span class="hs-identifier hs-var hs-var">f&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol r)) -&gt; Unipol r -&gt; Unipol r
forall poly.
IsOrderedPolynomial poly =&gt;
Ordinal (Arity poly) -&gt; poly -&gt; poly
</span><span class="hs-identifier hs-var">diff</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Unipol r))
forall (n :: Nat). (0 &lt; n) =&gt; Ordinal n
</span><span class="hs-identifier hs-var">OZ</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164048"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-135"></span><span>            </span><span id="local-6989586621679164046"><span class="annot"><span class="annottext">u :: Unipol r
</span><a href="#local-6989586621679164046"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164048"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164047"><span class="hs-identifier hs-var">f&#39;</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; IntMap (Unipol r) -&gt; Unipol r -&gt; Unipol r -&gt; IntMap (Unipol r)
forall t.
(IsOrderedPolynomial t, Euclidean t, (1 &lt;=? Arity t) ~ &#39;True) =&gt;
Int -&gt; IntMap t -&gt; t -&gt; t -&gt; IntMap t
</span><a href="#local-6989586621679164045"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol r)
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164048"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164046"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164047"><span class="hs-identifier hs-var">f&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164046"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679164045"><span class="annot"><span class="annottext">go :: Int -&gt; IntMap t -&gt; t -&gt; t -&gt; IntMap t
</span><a href="#local-6989586621679164045"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679164043"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164043"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679164042"><span class="annot"><span class="annottext">IntMap t
</span><a href="#local-6989586621679164042"><span class="hs-identifier hs-var">dic</span></a></span></span><span> </span><span id="local-6989586621679164041"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164041"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679164040"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164040"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164039"><span class="annot"><span class="annottext">t :: t
</span><a href="#local-6989586621679164039"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164040"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity t) -&gt; t -&gt; t
forall poly.
IsOrderedPolynomial poly =&gt;
Ordinal (Arity poly) -&gt; poly -&gt; poly
</span><span class="hs-identifier hs-var">diff</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity t)
forall (n :: Nat). (0 &lt; n) =&gt; Ordinal n
</span><span class="hs-identifier hs-var">OZ</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164041"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-140"></span><span>          </span><span id="local-6989586621679164038"><span class="annot"><span class="annottext">h :: t
</span><a href="#local-6989586621679164038"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164041"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164039"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-141"></span><span>          </span><span id="local-6989586621679164037"><span class="annot"><span class="annottext">v&#39; :: t
</span><a href="#local-6989586621679164037"><span class="hs-identifier hs-var hs-var">v&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164041"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164038"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-142"></span><span>          </span><span id="local-6989586621679164036"><span class="annot"><span class="annottext">w&#39; :: t
</span><a href="#local-6989586621679164036"><span class="hs-identifier hs-var hs-var">w&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164039"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164038"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-143"></span><span>          </span><span id="local-6989586621679164035"><span class="annot"><span class="annottext">dic&#39; :: IntMap t
</span><a href="#local-6989586621679164035"><span class="hs-identifier hs-var hs-var">dic&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; t -&gt; IntMap t -&gt; IntMap t
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164043"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164038"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap t
</span><a href="#local-6989586621679164042"><span class="hs-identifier hs-var">dic</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164037"><span class="hs-identifier hs-var">v&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">t
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-145"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IntMap t
</span><a href="#local-6989586621679164035"><span class="hs-identifier hs-var">dic&#39;</span></a></span><span>
</span><span id="line-146"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap t -&gt; t -&gt; t -&gt; IntMap t
</span><a href="#local-6989586621679164045"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164043"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap t
</span><a href="#local-6989586621679164035"><span class="hs-identifier hs-var">dic&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164037"><span class="hs-identifier hs-var">v&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679164036"><span class="hs-identifier hs-var">w&#39;</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#charUnipol"><span class="hs-identifier hs-type">charUnipol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164408"><span class="annot"><a href="#local-6989586621679164408"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Characteristic</span></span><span> </span><span class="annot"><a href="#local-6989586621679164408"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164408"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-149"></span><span id="charUnipol"><span class="annot"><span class="annottext">charUnipol :: Unipol r -&gt; Natural
</span><a href="Algebra.Ring.Polynomial.Factorise.html#charUnipol"><span class="hs-identifier hs-var hs-var">charUnipol</span></a></span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy r -&gt; Natural
forall r (proxy :: * -&gt; *). Characteristic r =&gt; proxy r -&gt; Natural
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy r
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679164408"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#powerUnipol"><span class="hs-identifier hs-type">powerUnipol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164404"><span class="annot"><a href="#local-6989586621679164404"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164404"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164404"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-152"></span><span id="powerUnipol"><span class="annot"><span class="annottext">powerUnipol :: Unipol r -&gt; Natural
</span><a href="Algebra.Ring.Polynomial.Factorise.html#powerUnipol"><span class="hs-identifier hs-var hs-var">powerUnipol</span></a></span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy r -&gt; Natural
forall k (proxy :: * -&gt; *). FiniteField k =&gt; proxy k -&gt; Natural
</span><span class="hs-identifier hs-var">power</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy r
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679164404"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#pthRoot"><span class="hs-identifier hs-type">pthRoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164370"><span class="annot"><a href="#local-6989586621679164370"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CoeffRing</span></span><span> </span><span class="annot"><a href="#local-6989586621679164370"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164370"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164370"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164370"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-155"></span><span id="pthRoot"><span class="annot"><span class="annottext">pthRoot :: Unipol r -&gt; Unipol r
</span><a href="Algebra.Ring.Polynomial.Factorise.html#pthRoot"><span class="hs-identifier hs-var hs-var">pthRoot</span></a></span></span><span> </span><span id="local-6989586621679164031"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164031"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679164030"><span class="annot"><span class="annottext">p :: Natural
</span><a href="#local-6989586621679164030"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Natural
forall r. Characteristic r =&gt; Unipol r -&gt; Natural
</span><a href="Algebra.Ring.Polynomial.Factorise.html#charUnipol"><span class="hs-identifier hs-var">charUnipol</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164031"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679164029"><span class="annot"><span class="annottext">q :: Natural
</span><a href="#local-6989586621679164029"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy r -&gt; Natural
forall k (proxy :: * -&gt; *). FiniteField k =&gt; proxy k -&gt; Natural
</span><span class="hs-identifier hs-var">order</span></span><span> </span><span class="annot"><span class="annottext">(Proxy r -&gt; Natural) -&gt; Proxy r -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy r
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679164370"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679164028"><span class="annot"><span class="annottext">s :: Natural
</span><a href="#local-6989586621679164028"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164029"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164030"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Unipol r] -&gt; Unipol r
forall (f :: * -&gt; *) m. (Foldable f, Monoidal m) =&gt; f m -&gt; m
</span><span class="hs-identifier hs-var">sum</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679164027"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">r -&gt; Natural -&gt; r
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164028"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; Unipol r -&gt; Unipol r
forall r m. Module (Scalar r) m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*.</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;x&quot; (Unipol r)
Unipol r
</span><a href="#local-6989586621679164025"><span class="hs-var">#x</span></a></span><span class="annot"><span class="annottext">Unipol r -&gt; Natural -&gt; Unipol r
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164024"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-160"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679164023"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164023"><span class="hs-identifier hs-var">ip</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164027"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679164027"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IntMap r -&gt; [(Int, r)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">(IntMap r -&gt; [(Int, r)]) -&gt; IntMap r -&gt; [(Int, r)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; IntMap r
forall k. Unipol k -&gt; IntMap k
</span><span class="hs-identifier hs-var">termsUnipol</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679164031"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-161"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679164024"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164024"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164023"><span class="hs-identifier hs-var">ip</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; (Natural, Natural)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`P.divMod`</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679164030"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Square-free decomposition of polynomials over a finite field.</span><span>
</span><span id="line-165"></span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span class="hs-comment">--   Use &#39;yun&#39; for a polynomials over a field of characteristic zero.</span><span>
</span><span id="line-167"></span><span id="local-6989586621679164339"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreeDecompFiniteField"><span class="hs-identifier hs-type">squareFreeDecompFiniteField</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679164339"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164339"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164339"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164339"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-170"></span><span id="squareFreeDecompFiniteField"><span class="annot"><span class="annottext">squareFreeDecompFiniteField :: Unipol k -&gt; IntMap (Unipol k)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreeDecompFiniteField"><span class="hs-identifier hs-var hs-var">squareFreeDecompFiniteField</span></a></span></span><span> </span><span id="local-6989586621679164019"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164019"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164018"><span class="annot"><span class="annottext">dcmp :: IntMap (Unipol k)
</span><a href="#local-6989586621679164018"><span class="hs-identifier hs-var hs-var">dcmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; IntMap (Unipol k)
forall r. (CoeffRing r, Field r) =&gt; Unipol r -&gt; IntMap (Unipol r)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#yun"><span class="hs-identifier hs-var">yun</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164019"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span id="local-6989586621679164017"><span class="annot"><span class="annottext">h&#39; :: Unipol k
</span><a href="#local-6989586621679164017"><span class="hs-identifier hs-var hs-var">h&#39;</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mult (Unipol k) -&gt; Unipol k
forall a. Mult a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runMult</span></span><span> </span><span class="annot"><span class="annottext">(Mult (Unipol k) -&gt; Unipol k) -&gt; Mult (Unipol k) -&gt; Unipol k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Unipol k -&gt; Mult (Unipol k))
-&gt; IntMap (Unipol k) -&gt; Mult (Unipol k)
forall i (f :: * -&gt; *) m a.
(FoldableWithIndex i f, Monoid m) =&gt;
(i -&gt; a -&gt; m) -&gt; f a -&gt; m
</span><span class="hs-identifier hs-var">ifoldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679164015"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164015"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679164014"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164014"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Mult (Unipol k)
forall a. a -&gt; Mult a
</span><span class="hs-identifier hs-var">Mult</span></span><span> </span><span class="annot"><span class="annottext">(Unipol k -&gt; Mult (Unipol k)) -&gt; Unipol k -&gt; Mult (Unipol k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164014"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; Unipol k
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164015"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164018"><span class="hs-identifier hs-var">dcmp</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span id="local-6989586621679164012"><span class="annot"><span class="annottext">fhInv :: Unipol k
</span><a href="#local-6989586621679164012"><span class="hs-identifier hs-var hs-var">fhInv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164019"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164017"><span class="hs-identifier hs-var">h&#39;</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621679164011"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679164011"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Int) -&gt; Natural -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural
forall r. Characteristic r =&gt; Unipol r -&gt; Natural
</span><a href="Algebra.Ring.Polynomial.Factorise.html#charUnipol"><span class="hs-identifier hs-var">charUnipol</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164019"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span id="local-6989586621679164010"><span class="annot"><span class="annottext">powers :: IntMap (Unipol k)
</span><a href="#local-6989586621679164010"><span class="hs-identifier hs-var hs-var">powers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a. (Int -&gt; Int) -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.mapKeysMonotonic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164011"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap (Unipol k) -&gt; IntMap (Unipol k))
-&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">Unipol k -&gt; IntMap (Unipol k)
forall k. (Eq k, FiniteField k) =&gt; Unipol k -&gt; IntMap (Unipol k)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreeDecompFiniteField"><span class="hs-identifier hs-var">squareFreeDecompFiniteField</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol k -&gt; IntMap (Unipol k)) -&gt; Unipol k -&gt; IntMap (Unipol k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k
forall r. (CoeffRing r, FiniteField r) =&gt; Unipol r -&gt; Unipol r
</span><a href="Algebra.Ring.Polynomial.Factorise.html#pthRoot"><span class="hs-identifier hs-var">pthRoot</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164012"><span class="hs-identifier hs-var">fhInv</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679164008"><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164008"><span class="hs-identifier hs-var">pns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164007"><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164007"><span class="hs-identifier hs-var">pnjs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164006"><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164006"><span class="hs-identifier hs-var">js</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><span class="annottext">((IntMap (Unipol k), IntMap (Unipol k))
 -&gt; Int
 -&gt; Unipol k
 -&gt; ((IntMap (Unipol k), IntMap (Unipol k)), Unipol k))
-&gt; (IntMap (Unipol k), IntMap (Unipol k))
-&gt; IntMap (Unipol k)
-&gt; ((IntMap (Unipol k), IntMap (Unipol k)), IntMap (Unipol k))
forall a b c.
(a -&gt; Int -&gt; b -&gt; (a, c)) -&gt; a -&gt; IntMap b -&gt; (a, IntMap c)
</span><span class="hs-identifier hs-var">IM.mapAccumWithKey</span></span><span>
</span><span id="line-180"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679164004"><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164004"><span class="hs-identifier hs-var">ps&#39;</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164003"><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164003"><span class="hs-identifier hs-var">pnjs&#39;</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679164002"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164002"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679164001"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164001"><span class="hs-identifier hs-var">g0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679164000"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164000"><span class="hs-identifier hs-var">g&#39;</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163999"><span class="annot"><span class="annottext">IntMap (Unipol k, Unipol k)
</span><a href="#local-6989586621679163999"><span class="hs-identifier hs-var">pnjsps&#39;&#39;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>                      </span><span class="annot"><span class="annottext">(Unipol k -&gt; Unipol k -&gt; (Unipol k, (Unipol k, Unipol k)))
-&gt; Unipol k
-&gt; IntMap (Unipol k)
-&gt; (Unipol k, IntMap (Unipol k, Unipol k))
forall a b c. (a -&gt; b -&gt; (a, c)) -&gt; a -&gt; IntMap b -&gt; (a, IntMap c)
</span><span class="hs-identifier hs-var">IM.mapAccum</span></span><span>
</span><span id="line-183"></span><span>                        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679163997"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163997"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679163996"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163996"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163995"><span class="annot"><span class="annottext">u :: Unipol k
</span><a href="#local-6989586621679163995"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163997"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`gcd`</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163996"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-185"></span><span>                              </span><span id="local-6989586621679163994"><span class="annot"><span class="annottext">h&#39; :: Unipol k
</span><a href="#local-6989586621679163994"><span class="hs-identifier hs-var hs-var">h&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163996"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163995"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-186"></span><span>                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163997"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163995"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163995"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163994"><span class="hs-identifier hs-var">h&#39;</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                      </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164001"><span class="hs-identifier hs-var">g0</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164004"><span class="hs-identifier hs-var">ps&#39;</span></a></span><span>
</span><span id="line-189"></span><span>                    </span><span id="local-6989586621679163993"><span class="annot"><span class="annottext">pnjs&#39;&#39; :: IntMap (Unipol k)
</span><a href="#local-6989586621679163993"><span class="hs-identifier hs-var hs-var">pnjs&#39;&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Unipol k -&gt; Bool) -&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Unipol k -&gt; Int) -&gt; Unipol k -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                      </span><span class="annot"><span class="annottext">(IntMap (Unipol k) -&gt; IntMap (Unipol k))
-&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a. (Int -&gt; Int) -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.mapKeysMonotonic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164002"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>                      </span><span class="annot"><span class="annottext">(IntMap (Unipol k) -&gt; IntMap (Unipol k))
-&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Unipol k, Unipol k) -&gt; Unipol k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Unipol k, Unipol k) -&gt; Unipol k)
-&gt; IntMap (Unipol k, Unipol k) -&gt; IntMap (Unipol k)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k, Unipol k)
</span><a href="#local-6989586621679163999"><span class="hs-identifier hs-var">pnjsps&#39;&#39;</span></a></span><span>
</span><span id="line-192"></span><span>                    </span><span id="local-6989586621679163990"><span class="annot"><span class="annottext">ps&#39;&#39; :: IntMap (Unipol k)
</span><a href="#local-6989586621679163990"><span class="hs-identifier hs-var hs-var">ps&#39;&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Unipol k -&gt; Bool) -&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Unipol k -&gt; Int) -&gt; Unipol k -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                        </span><span class="annot"><span class="annottext">(IntMap (Unipol k) -&gt; IntMap (Unipol k))
-&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Unipol k, Unipol k) -&gt; Unipol k
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Unipol k, Unipol k) -&gt; Unipol k)
-&gt; IntMap (Unipol k, Unipol k) -&gt; IntMap (Unipol k)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k, Unipol k)
</span><a href="#local-6989586621679163999"><span class="hs-identifier hs-var">pnjsps&#39;&#39;</span></a></span><span>
</span><span id="line-194"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679163990"><span class="hs-identifier hs-var">ps&#39;&#39;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164003"><span class="hs-identifier hs-var">pnjs&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k) -&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679163993"><span class="hs-identifier hs-var">pnjs&#39;&#39;</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164000"><span class="hs-identifier hs-var">g&#39;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164010"><span class="hs-identifier hs-var">powers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>            </span><span class="annot"><span class="annottext">(IntMap (Unipol k)
 -&gt; ((IntMap (Unipol k), IntMap (Unipol k)), IntMap (Unipol k)))
-&gt; IntMap (Unipol k)
-&gt; ((IntMap (Unipol k), IntMap (Unipol k)), IntMap (Unipol k))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (Unipol k), IntMap (Unipol k)) -&gt; IntMap (Unipol k)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap (Unipol k) -&gt; (IntMap (Unipol k), IntMap (Unipol k))
forall a. Int -&gt; IntMap a -&gt; (IntMap a, IntMap a)
</span><span class="hs-identifier hs-var">IM.split</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164011"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164018"><span class="hs-identifier hs-var">dcmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Int, Unipol k) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (Unipol k) -&gt; (Int, Unipol k)
forall a. IntMap a -&gt; (Int, a)
</span><span class="hs-identifier hs-var">IM.findMax</span></span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164018"><span class="hs-identifier hs-var">dcmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679164011"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679164012"><span class="hs-identifier hs-var">fhInv</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164018"><span class="hs-identifier hs-var">dcmp</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[IntMap (Unipol k)] -&gt; IntMap (Unipol k)
forall (f :: * -&gt; *) a. Foldable f =&gt; f (IntMap a) -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.unions</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Unipol k -&gt; Bool) -&gt; IntMap (Unipol k) -&gt; IntMap (Unipol k)
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Unipol k -&gt; Int) -&gt; Unipol k -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164006"><span class="hs-identifier hs-var">js</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164007"><span class="hs-identifier hs-var">pnjs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap (Unipol k)
</span><a href="#local-6989586621679164008"><span class="hs-identifier hs-var">pns</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">newtype</span><span> </span><span id="GCD"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span></span><span> </span><span id="local-6989586621679164317"><span class="annot"><a href="#local-6989586621679164317"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GCD"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runGCD"><span class="annot"><span class="annottext">GCD a -&gt; a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#runGCD"><span class="hs-identifier hs-var hs-var">runGCD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679164317"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621679163983"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679163978"><span id="local-6989586621679163980"><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679163983"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#GCD"><span class="hs-identifier hs-type">GCD</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163983"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>  </span><span id="local-6989586621679163976"><span class="annot"><span class="annottext">&lt;&gt; :: GCD a -&gt; GCD a -&gt; GCD a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; GCD a
forall a. a -&gt; GCD a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; GCD a) -&gt; (GCD a -&gt; a) -&gt; GCD a -&gt; GCD a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((GCD a -&gt; a) -&gt; GCD a -&gt; GCD a)
-&gt; (GCD a -&gt; GCD a -&gt; a) -&gt; GCD a -&gt; GCD a -&gt; GCD a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; (GCD a -&gt; a) -&gt; GCD a -&gt; GCD a -&gt; a
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">GCD a -&gt; a
forall a. GCD a -&gt; a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#runGCD"><span class="hs-identifier hs-var hs-var">runGCD</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-207"></span><span id="local-6989586621679163974"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679163969"><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679163974"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#GCD"><span class="hs-identifier hs-type">GCD</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163974"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679163967"><span class="annot"><span class="annottext">mappend :: GCD a -&gt; GCD a -&gt; GCD a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GCD a -&gt; GCD a -&gt; GCD a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679163966"><span class="annot"><span class="annottext">mempty :: GCD a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; GCD a
forall a. a -&gt; GCD a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span><span> </span><span class="annot"><span class="annottext">a
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-keyword">newtype</span><span> </span><span id="LCM"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span></span><span> </span><span id="local-6989586621679164307"><span class="annot"><a href="#local-6989586621679164307"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LCM"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runLCM"><span class="annot"><span class="annottext">LCM a -&gt; a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#runLCM"><span class="hs-identifier hs-var hs-var">runLCM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679164307"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span id="local-6989586621679163963"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679163958"><span id="local-6989586621679163960"><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679163963"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#LCM"><span class="hs-identifier hs-type">LCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163963"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679163957"><span class="annot"><span class="annottext">&lt;&gt; :: LCM a -&gt; LCM a -&gt; LCM a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; LCM a
forall a. a -&gt; LCM a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; LCM a) -&gt; (LCM a -&gt; a) -&gt; LCM a -&gt; LCM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((LCM a -&gt; a) -&gt; LCM a -&gt; LCM a)
-&gt; (LCM a -&gt; LCM a -&gt; a) -&gt; LCM a -&gt; LCM a -&gt; LCM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">lcm</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; (LCM a -&gt; a) -&gt; LCM a -&gt; LCM a -&gt; a
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">LCM a -&gt; a
forall a. LCM a -&gt; a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#runLCM"><span class="hs-identifier hs-var hs-var">runLCM</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-215"></span><span id="local-6989586621679163956"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679163951"><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679163956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#LCM"><span class="hs-identifier hs-type">LCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679163950"><span class="annot"><span class="annottext">mappend :: LCM a -&gt; LCM a -&gt; LCM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LCM a -&gt; LCM a -&gt; LCM a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679163949"><span class="annot"><span class="annottext">mempty :: LCM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; LCM a
forall a. a -&gt; LCM a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span><span> </span><span class="annot"><span class="annottext">a
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Factorise a polynomial over finite field using Cantor-Zassenhaus algorithm</span><span>
</span><span id="line-220"></span><span id="local-6989586621679164218"><span id="local-6989586621679164219"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorise"><span class="hs-identifier hs-type">factorise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679164219"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoeffRing</span></span><span> </span><span class="annot"><a href="#local-6989586621679164218"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679164218"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Random</span></span><span> </span><span class="annot"><a href="#local-6989586621679164218"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164218"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164219"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164218"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-222"></span><span id="factorise"><span class="annot"><span class="annottext">factorise :: Unipol k -&gt; m [(Unipol k, Natural)]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorise"><span class="hs-identifier hs-var hs-var">factorise</span></a></span></span><span> </span><span id="local-6989586621679163948"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163948"><span class="hs-identifier hs-var">f0</span></a></span></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163948"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Unipol k, Natural)] -&gt; m [(Unipol k, Natural)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163947"><span class="annot"><span class="annottext">f :: Unipol k
</span><a href="#local-6989586621679163947"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k
forall poly.
(Field (Coefficient poly), IsOrderedPolynomial poly) =&gt;
poly -&gt; poly
</span><span class="hs-identifier hs-var">monoize</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163948"><span class="hs-identifier hs-var">f0</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span id="local-6989586621679163945"><span class="annot"><span class="annottext">c :: Coefficient (Unipol k)
</span><a href="#local-6989586621679163945"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Coefficient (Unipol k)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163948"><span class="hs-identifier hs-var">f0</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679163943"><span class="annot"><span class="annottext">[(Unipol k, Natural)]
</span><a href="#local-6989586621679163943"><span class="hs-identifier hs-var">monoFacts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[(Unipol k, Natural)]] -&gt; [(Unipol k, Natural)]
forall w. Monoid w =&gt; [w] -&gt; w
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="annottext">([[(Unipol k, Natural)]] -&gt; [(Unipol k, Natural)])
-&gt; m [[(Unipol k, Natural)]] -&gt; m [(Unipol k, Natural)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Int, Unipol k) -&gt; m [(Unipol k, Natural)])
-&gt; [(Int, Unipol k)] -&gt; m [[(Unipol k, Natural)]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679163942"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163942"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163941"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163941"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Unipol k -&gt; (Unipol k, Natural))
-&gt; [Unipol k] -&gt; [(Unipol k, Natural)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163942"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Unipol k] -&gt; [(Unipol k, Natural)])
-&gt; m [Unipol k] -&gt; m [(Unipol k, Natural)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; m [Unipol k]
forall k (m :: * -&gt; *).
(Eq k, Random k, FiniteField k, MonadRandom m) =&gt;
Unipol k -&gt; m [Unipol k]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorSquareFree"><span class="hs-identifier hs-var">factorSquareFree</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163941"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (Unipol k) -&gt; [(Int, Unipol k)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (Unipol k) -&gt; [(Int, Unipol k)])
-&gt; IntMap (Unipol k) -&gt; [(Int, Unipol k)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="annot"><span class="annottext">Unipol k -&gt; IntMap (Unipol k)
forall k. (Eq k, FiniteField k) =&gt; Unipol k -&gt; IntMap (Unipol k)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#squareFreeDecompFiniteField"><span class="hs-identifier hs-var">squareFreeDecompFiniteField</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163947"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">[(Unipol k, Natural)] -&gt; m [(Unipol k, Natural)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([(Unipol k, Natural)] -&gt; m [(Unipol k, Natural)])
-&gt; [(Unipol k, Natural)] -&gt; m [(Unipol k, Natural)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
Coefficient (Unipol k)
</span><a href="#local-6989586621679163945"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(Unipol k, Natural)]
</span><a href="#local-6989586621679163943"><span class="hs-identifier hs-var">monoFacts</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient (Unipol k) -&gt; Unipol k
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly
</span><span class="hs-identifier hs-var">injectCoeff</span></span><span> </span><span class="annot"><span class="annottext">Coefficient (Unipol k)
</span><a href="#local-6989586621679163945"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Unipol k, Natural)
-&gt; [(Unipol k, Natural)] -&gt; [(Unipol k, Natural)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Unipol k, Natural)]
</span><a href="#local-6989586621679163943"><span class="hs-identifier hs-var">monoFacts</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span id="local-6989586621679164272"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#clearDenom"><span class="hs-identifier hs-type">clearDenom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CoeffRing</span></span><span> </span><span class="annot"><a href="#local-6989586621679164272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679164272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fraction</span></span><span> </span><span class="annot"><a href="#local-6989586621679164272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679164272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-235"></span><span id="clearDenom"><span class="annot"><span class="annottext">clearDenom :: Unipol (Fraction a) -&gt; (a, Unipol a)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#clearDenom"><span class="hs-identifier hs-var hs-var">clearDenom</span></a></span></span><span> </span><span id="local-6989586621679163940"><span class="annot"><span class="annottext">Unipol (Fraction a)
</span><a href="#local-6989586621679163940"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163939"><span class="annot"><span class="annottext">g :: a
</span><a href="#local-6989586621679163939"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Fraction a -&gt; a -&gt; a) -&gt; a -&gt; Map (Monomial 1) (Fraction a) -&gt; a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">lcm</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; (Fraction a -&gt; a) -&gt; Fraction a -&gt; a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Fraction a -&gt; a
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">denominator</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial 1) (Fraction a) -&gt; a)
-&gt; Map (Monomial 1) (Fraction a) -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Fraction a)
-&gt; Map
     (Monomial (Arity (Unipol (Fraction a))))
     (Coefficient (Unipol (Fraction a)))
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><span class="hs-identifier hs-var">terms&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Fraction a)
</span><a href="#local-6989586621679163940"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163939"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Fraction a -&gt; a) -&gt; Unipol (Fraction a) -&gt; Unipol a
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fraction a -&gt; a
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">(Fraction a -&gt; a) -&gt; (Fraction a -&gt; Fraction a) -&gt; Fraction a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163939"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Fraction a
forall d. GCDDomain d =&gt; d -&gt; d -&gt; Fraction d
</span><span class="hs-operator hs-var">F.%</span></span><span> </span><span class="annot"><span class="annottext">a
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Fraction a -&gt; Fraction a -&gt; Fraction a
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol (Fraction a)
</span><a href="#local-6989586621679163940"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Factorise the given primitive and square-freeinteger-coefficient polynomial,</span><span>
</span><span id="line-240"></span><span class="hs-comment">--   choosing a large enough prime.</span><span>
</span><span id="line-241"></span><span id="local-6989586621679163932"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorQBigPrime"><span class="hs-identifier hs-type">factorQBigPrime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679163932"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679163932"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-243"></span><span id="factorQBigPrime"><span class="annot"><span class="annottext">factorQBigPrime :: Unipol Integer -&gt; m (Integer, IntMap (Set (Unipol Integer)))
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorQBigPrime"><span class="hs-identifier hs-var hs-var">factorQBigPrime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; m [Unipol Integer])
-&gt; Unipol Integer -&gt; m (Integer, IntMap (Set (Unipol Integer)))
forall (m :: * -&gt; *).
MonadRandom m =&gt;
(Unipol Integer -&gt; m [Unipol Integer])
-&gt; Unipol Integer -&gt; m (Integer, IntMap (Set (Unipol Integer)))
</span><a href="Algebra.Ring.Polynomial.Factorise.html#wrapSQFFactor"><span class="hs-identifier hs-var">wrapSQFFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; m [Unipol Integer]
forall (m :: * -&gt; *).
MonadRandom m =&gt;
Unipol Integer -&gt; m [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorSqFreeQBP"><span class="hs-identifier hs-var">factorSqFreeQBP</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Factorise the given</span><span>
</span><span id="line-246"></span><span class="hs-comment">--   interger-coefficient polynomial by Hensel lifting.</span><span>
</span><span id="line-247"></span><span id="local-6989586621679163929"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorHensel"><span class="hs-identifier hs-type">factorHensel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679163929"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679163929"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-249"></span><span id="factorHensel"><span class="annot"><span class="annottext">factorHensel :: Unipol Integer -&gt; m (Integer, IntMap (Set (Unipol Integer)))
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorHensel"><span class="hs-identifier hs-var hs-var">factorHensel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; m [Unipol Integer])
-&gt; Unipol Integer -&gt; m (Integer, IntMap (Set (Unipol Integer)))
forall (m :: * -&gt; *).
MonadRandom m =&gt;
(Unipol Integer -&gt; m [Unipol Integer])
-&gt; Unipol Integer -&gt; m (Integer, IntMap (Set (Unipol Integer)))
</span><a href="Algebra.Ring.Polynomial.Factorise.html#wrapSQFFactor"><span class="hs-identifier hs-var">wrapSQFFactor</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; m [Unipol Integer]
forall (m :: * -&gt; *).
MonadRandom m =&gt;
Unipol Integer -&gt; m [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorHenselSqFree"><span class="hs-identifier hs-var">factorHenselSqFree</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span id="local-6989586621679164284"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#wrapSQFFactor"><span class="hs-identifier hs-type">wrapSQFFactor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679164284"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164284"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164284"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-254"></span><span id="wrapSQFFactor"><span class="annot"><span class="annottext">wrapSQFFactor :: (Unipol Integer -&gt; m [Unipol Integer])
-&gt; Unipol Integer -&gt; m (Integer, IntMap (Set (Unipol Integer)))
</span><a href="Algebra.Ring.Polynomial.Factorise.html#wrapSQFFactor"><span class="hs-identifier hs-var hs-var">wrapSQFFactor</span></a></span></span><span> </span><span id="local-6989586621679163927"><span class="annot"><span class="annottext">Unipol Integer -&gt; m [Unipol Integer]
</span><a href="#local-6989586621679163927"><span class="hs-identifier hs-var">fac</span></a></span></span><span> </span><span id="local-6989586621679163926"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163926"><span class="hs-identifier hs-var">f0</span></a></span></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163925"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, IntMap (Set (Unipol Integer)))
-&gt; m (Integer, IntMap (Set (Unipol Integer)))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163926"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap (Set (Unipol Integer))
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163925"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, IntMap (Set (Unipol Integer)))
-&gt; m (Integer, IntMap (Set (Unipol Integer)))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly.
(IsPolynomial poly, Euclidean (Coefficient poly)) =&gt;
poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">content</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163926"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Set (Unipol Integer) -&gt; IntMap (Set (Unipol Integer))
forall a. Int -&gt; a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.singleton</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Set (Unipol Integer) -&gt; IntMap (Set (Unipol Integer)))
-&gt; Set (Unipol Integer) -&gt; IntMap (Set (Unipol Integer))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Set (Unipol Integer)
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Set (Unipol Integer))
-&gt; Unipol Integer -&gt; Set (Unipol Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Unipol Integer
forall poly.
(Euclidean (Coefficient poly), IsPolynomial poly) =&gt;
poly -&gt; poly
</span><span class="hs-identifier hs-var">pp</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163926"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163920"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163920"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163919"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163919"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Unipol Integer
forall poly.
(Euclidean (Coefficient poly), IsPolynomial poly) =&gt;
poly -&gt; poly
</span><span class="hs-identifier hs-var">pp</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163926"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly.
(IsPolynomial poly, Euclidean (Coefficient poly)) =&gt;
poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">content</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163926"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679163918"><span class="annot"><span class="annottext">IntMap (Integer, [Unipol Integer])
</span><a href="#local-6989586621679163918"><span class="hs-identifier hs-var">ts0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Unipol (Fraction Integer) -&gt; m (Integer, [Unipol Integer]))
-&gt; IntMap (Unipol (Fraction Integer))
-&gt; m (IntMap (Integer, [Unipol Integer]))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">F.mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Unipol Integer -&gt; m [Unipol Integer])
-&gt; (Integer, Unipol Integer) -&gt; m (Integer, [Unipol Integer])
forall (f :: * -&gt; *) t a t1.
Functor f =&gt;
(t -&gt; f a) -&gt; (t1, t) -&gt; f (t1, a)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#secondM"><span class="hs-identifier hs-var">secondM</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; m [Unipol Integer]
</span><a href="#local-6989586621679163927"><span class="hs-identifier hs-var">fac</span></a></span><span> </span><span class="annot"><span class="annottext">((Integer, Unipol Integer) -&gt; m (Integer, [Unipol Integer]))
-&gt; (Unipol (Fraction Integer) -&gt; (Integer, Unipol Integer))
-&gt; Unipol (Fraction Integer)
-&gt; m (Integer, [Unipol Integer])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Fraction Integer) -&gt; (Integer, Unipol Integer)
forall a.
(CoeffRing a, Euclidean a) =&gt;
Unipol (Fraction a) -&gt; (a, Unipol a)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#clearDenom"><span class="hs-identifier hs-var">clearDenom</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol (Fraction Integer) -&gt; IntMap (Unipol (Fraction Integer))
forall r. (CoeffRing r, Field r) =&gt; Unipol r -&gt; IntMap (Unipol r)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#yun"><span class="hs-identifier hs-var">yun</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol (Fraction Integer) -&gt; IntMap (Unipol (Fraction Integer)))
-&gt; Unipol (Fraction Integer) -&gt; IntMap (Unipol (Fraction Integer))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Fraction Integer) -&gt; Unipol (Fraction Integer)
forall poly.
(Field (Coefficient poly), IsOrderedPolynomial poly) =&gt;
poly -&gt; poly
</span><span class="hs-identifier hs-var">monoize</span></span><span> </span><span class="annot"><span class="annottext">(Unipol (Fraction Integer) -&gt; Unipol (Fraction Integer))
-&gt; Unipol (Fraction Integer) -&gt; Unipol (Fraction Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Fraction Integer)
-&gt; Unipol Integer -&gt; Unipol (Fraction Integer)
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Fraction Integer
forall d. GCDDomain d =&gt; d -&gt; d -&gt; Fraction d
</span><span class="hs-operator hs-var">F.%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163920"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163916"><span class="annot"><span class="annottext">anss :: [(Int, (Integer, [Unipol Integer]))]
</span><a href="#local-6989586621679163916"><span class="hs-identifier hs-var hs-var">anss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap (Integer, [Unipol Integer])
-&gt; [(Int, (Integer, [Unipol Integer]))]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">IntMap (Integer, [Unipol Integer])
</span><a href="#local-6989586621679163918"><span class="hs-identifier hs-var">ts0</span></a></span><span>
</span><span id="line-261"></span><span>        </span><span id="local-6989586621679163915"><span class="annot"><span class="annottext">k :: Integer
</span><a href="#local-6989586621679163915"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163919"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163920"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (f :: * -&gt; *) r. (Foldable f, Unital r) =&gt; f r -&gt; r
</span><span class="hs-identifier hs-var">product</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, (Integer, [Unipol Integer])) -&gt; Integer)
-&gt; [(Int, (Integer, [Unipol Integer]))] -&gt; [Integer]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679163913"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163913"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679163912"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163912"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Unipol Integer]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163912"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">P.^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163913"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, (Integer, [Unipol Integer]))]
</span><a href="#local-6989586621679163916"><span class="hs-identifier hs-var">anss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="annottext">(Integer, IntMap (Set (Unipol Integer)))
-&gt; m (Integer, IntMap (Set (Unipol Integer)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163915"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Int, Set (Unipol Integer))] -&gt; IntMap (Set (Unipol Integer))
forall a. [(Int, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Int, Set (Unipol Integer))] -&gt; IntMap (Set (Unipol Integer)))
-&gt; [(Int, Set (Unipol Integer))] -&gt; IntMap (Set (Unipol Integer))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, (Integer, [Unipol Integer])) -&gt; (Int, Set (Unipol Integer)))
-&gt; [(Int, (Integer, [Unipol Integer]))]
-&gt; [(Int, Set (Unipol Integer))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Integer, [Unipol Integer]) -&gt; Set (Unipol Integer))
-&gt; (Int, (Integer, [Unipol Integer]))
-&gt; (Int, Set (Unipol Integer))
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(((Integer, [Unipol Integer]) -&gt; Set (Unipol Integer))
 -&gt; (Int, (Integer, [Unipol Integer]))
 -&gt; (Int, Set (Unipol Integer)))
-&gt; ((Integer, [Unipol Integer]) -&gt; Set (Unipol Integer))
-&gt; (Int, (Integer, [Unipol Integer]))
-&gt; (Int, Set (Unipol Integer))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer] -&gt; Set (Unipol Integer)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Unipol Integer] -&gt; Set (Unipol Integer))
-&gt; ((Integer, [Unipol Integer]) -&gt; [Unipol Integer])
-&gt; (Integer, [Unipol Integer])
-&gt; Set (Unipol Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Integer, [Unipol Integer]) -&gt; [Unipol Integer]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, (Integer, [Unipol Integer]))]
</span><a href="#local-6989586621679163916"><span class="hs-identifier hs-var">anss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679163925"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679163925"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163926"><span class="hs-identifier hs-var">f0</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span id="local-6989586621679164273"><span id="local-6989586621679164274"><span id="local-6989586621679164275"><span id="local-6989586621679164276"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#secondM"><span class="hs-identifier hs-type">secondM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679164276"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679164275"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164276"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164274"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679164273"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679164275"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164276"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679164273"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679164274"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-267"></span><span id="secondM"><span class="annot"><span class="annottext">secondM :: (t -&gt; f a) -&gt; (t1, t) -&gt; f (t1, a)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#secondM"><span class="hs-identifier hs-var hs-var">secondM</span></a></span></span><span> </span><span id="local-6989586621679163907"><span class="annot"><span class="annottext">t -&gt; f a
</span><a href="#local-6989586621679163907"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163906"><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679163906"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163905"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679163905"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679163906"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (t1, a)) -&gt; f a -&gt; f (t1, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; f a
</span><a href="#local-6989586621679163907"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679163905"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Factors square-free primitive integer-coefficient polynomial,</span><span>
</span><span id="line-270"></span><span class="hs-comment">--   using big enough prime.</span><span>
</span><span id="line-271"></span><span id="local-6989586621679164283"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorSqFreeQBP"><span class="hs-identifier hs-type">factorSqFreeQBP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679164283"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164283"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-273"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorSqFreeQBP"><span class="hs-pragma hs-type">factorSqFreeQBP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-274"></span><span id="factorSqFreeQBP"><span class="annot"><span class="annottext">factorSqFreeQBP :: Unipol Integer -&gt; m [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorSqFreeQBP"><span class="hs-identifier hs-var hs-var">factorSqFreeQBP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><span class="annottext">(Prime Integer -&gt; Unipol Integer -&gt; BasicConsts)
-&gt; (BasicConsts -&gt; Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; (BasicConsts -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; (BasicConsts
    -&gt; Prime Integer
    -&gt; Unipol Integer
    -&gt; [Unipol Integer]
    -&gt; [Unipol Integer])
-&gt; Unipol Integer
-&gt; m [Unipol Integer]
forall (m :: * -&gt; *) a.
MonadRandom m =&gt;
(Prime Integer -&gt; Unipol Integer -&gt; a)
-&gt; (a -&gt; Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; (a -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; (a
    -&gt; Prime Integer
    -&gt; Unipol Integer
    -&gt; [Unipol Integer]
    -&gt; [Unipol Integer])
-&gt; Unipol Integer
-&gt; m [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorPrimitiveIntegerPolWith"><span class="hs-identifier hs-var">factorPrimitiveIntegerPolWith</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Unipol Integer -&gt; BasicConsts)
-&gt; Prime Integer -&gt; Unipol Integer -&gt; BasicConsts
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; BasicConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#calcBasicConsts"><span class="hs-identifier hs-var">calcBasicConsts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#BasicConsts"><span class="hs-identifier hs-type">BasicConsts</span></a></span><span class="hs-special">{</span><span id="local-6989586621679163898"><span id="local-6989586621679163899"><span id="local-6989586621679163900"><span class="annot"><span class="annottext">Double
Integer
lc :: BasicConsts -&gt; Integer
kB :: BasicConsts -&gt; Double
kA :: BasicConsts -&gt; Integer
lc :: Integer
kB :: Double
kA :: Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#lc"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Integer)
-&gt; Unipol Integer -&gt; Maybe (Integer, Integer)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Integer, Integer)
 -&gt; Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; Maybe (Integer, Integer)
-&gt; Unipol Integer
-&gt; Maybe (Integer, Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Maybe (Integer, Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Integer) -&gt; Double -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163899"><span class="hs-identifier hs-var">kB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Integer) -&gt; Double -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163899"><span class="hs-identifier hs-var">kB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prime Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; BasicConsts -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Prime Integer -&gt; Unipol Integer -&gt; Integer)
 -&gt; BasicConsts -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; (Prime Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; BasicConsts
-&gt; Prime Integer
-&gt; Unipol Integer
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; (Prime Integer -&gt; Integer)
-&gt; Prime Integer
-&gt; Unipol Integer
-&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer -&gt; Integer
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">unPrime</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">((BasicConsts
  -&gt; Prime Integer
  -&gt; Unipol Integer
  -&gt; [Unipol Integer]
  -&gt; [Unipol Integer])
 -&gt; Unipol Integer -&gt; m [Unipol Integer])
-&gt; (BasicConsts
    -&gt; Prime Integer
    -&gt; Unipol Integer
    -&gt; [Unipol Integer]
    -&gt; [Unipol Integer])
-&gt; Unipol Integer
-&gt; m [Unipol Integer]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Prime Integer
 -&gt; Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer])
-&gt; BasicConsts
-&gt; Prime Integer
-&gt; Unipol Integer
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Prime Integer
  -&gt; Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer])
 -&gt; BasicConsts
 -&gt; Prime Integer
 -&gt; Unipol Integer
 -&gt; [Unipol Integer]
 -&gt; [Unipol Integer])
-&gt; (Prime Integer
    -&gt; Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer])
-&gt; BasicConsts
-&gt; Prime Integer
-&gt; Unipol Integer
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer])
-&gt; Prime Integer
-&gt; Unipol Integer
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer])
 -&gt; Prime Integer
 -&gt; Unipol Integer
 -&gt; [Unipol Integer]
 -&gt; [Unipol Integer])
-&gt; (Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer])
-&gt; Prime Integer
-&gt; Unipol Integer
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Unipol Integer] -&gt; [Unipol Integer])
-&gt; Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer] -&gt; [Unipol Integer]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">data</span><span> </span><span id="BasicConsts"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#BasicConsts"><span class="hs-identifier hs-var">BasicConsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>  </span><span id="BasicConsts"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#BasicConsts"><span class="hs-identifier hs-var">BasicConsts</span></a></span></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="kA"><span class="annot"><span class="annottext">BasicConsts -&gt; Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#kA"><span class="hs-identifier hs-var hs-var">kA</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="kB"><span class="annot"><span class="annottext">BasicConsts -&gt; Double
</span><a href="Algebra.Ring.Polynomial.Factorise.html#kB"><span class="hs-identifier hs-var hs-var">kB</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lc"><span class="annot"><span class="annottext">BasicConsts -&gt; Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#lc"><span class="hs-identifier hs-var hs-var">lc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">data</span><span> </span><span id="HenselConsts"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#HenselConsts"><span class="hs-identifier hs-var">HenselConsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HenselConsts"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#HenselConsts"><span class="hs-identifier hs-var">HenselConsts</span></a></span></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="basicConsts"><span class="annot"><span class="annottext">HenselConsts -&gt; BasicConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#basicConsts"><span class="hs-identifier hs-var hs-var">basicConsts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#BasicConsts"><span class="hs-identifier hs-type">BasicConsts</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="primePower"><span class="annot"><span class="annottext">HenselConsts -&gt; Natural
</span><a href="Algebra.Ring.Polynomial.Factorise.html#primePower"><span class="hs-identifier hs-var hs-var">primePower</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span id="local-6989586621679163889"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorHenselSqFree"><span class="hs-identifier hs-type">factorHenselSqFree</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679163889"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679163889"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-298"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorHenselSqFree"><span class="hs-pragma hs-type">factorHenselSqFree</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-299"></span><span id="factorHenselSqFree"><span class="annot"><span class="annottext">factorHenselSqFree :: Unipol Integer -&gt; m [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorHenselSqFree"><span class="hs-identifier hs-var hs-var">factorHenselSqFree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>  </span><span class="annot"><span class="annottext">(Prime Integer -&gt; Unipol Integer -&gt; HenselConsts)
-&gt; (HenselConsts -&gt; Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; (HenselConsts -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; (HenselConsts
    -&gt; Prime Integer
    -&gt; Unipol Integer
    -&gt; [Unipol Integer]
    -&gt; [Unipol Integer])
-&gt; Unipol Integer
-&gt; m [Unipol Integer]
forall (m :: * -&gt; *) a.
MonadRandom m =&gt;
(Prime Integer -&gt; Unipol Integer -&gt; a)
-&gt; (a -&gt; Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; (a -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; (a
    -&gt; Prime Integer
    -&gt; Unipol Integer
    -&gt; [Unipol Integer]
    -&gt; [Unipol Integer])
-&gt; Unipol Integer
-&gt; m [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorPrimitiveIntegerPolWith"><span class="hs-identifier hs-var">factorPrimitiveIntegerPolWith</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">Prime Integer -&gt; Unipol Integer -&gt; HenselConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#calcHenselConsts"><span class="hs-identifier hs-var">calcHenselConsts</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; HenselConsts -&gt; Unipol Integer -&gt; Maybe (Integer, Integer)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Unipol Integer -&gt; Maybe (Integer, Integer))
 -&gt; HenselConsts -&gt; Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; (Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; HenselConsts
-&gt; Unipol Integer
-&gt; Maybe (Integer, Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Integer)
-&gt; Unipol Integer -&gt; Maybe (Integer, Integer)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Integer)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#HenselConsts"><span class="hs-identifier hs-type">HenselConsts</span></a></span><span class="hs-special">{</span><span id="local-6989586621679163886"><span id="local-6989586621679163887"><span class="annot"><span class="annottext">Natural
BasicConsts
primePower :: Natural
basicConsts :: BasicConsts
primePower :: HenselConsts -&gt; Natural
basicConsts :: HenselConsts -&gt; BasicConsts
</span><a href="#local-6989586621679163886"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prime Integer -&gt; Integer
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">unPrime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679163885"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163885"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-304"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163885"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural -&gt; Integer
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163886"><span class="hs-identifier hs-var">primePower</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">((HenselConsts
  -&gt; Prime Integer
  -&gt; Unipol Integer
  -&gt; [Unipol Integer]
  -&gt; [Unipol Integer])
 -&gt; Unipol Integer -&gt; m [Unipol Integer])
-&gt; (HenselConsts
    -&gt; Prime Integer
    -&gt; Unipol Integer
    -&gt; [Unipol Integer]
    -&gt; [Unipol Integer])
-&gt; Unipol Integer
-&gt; m [Unipol Integer]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#HenselConsts"><span class="hs-identifier hs-type">HenselConsts</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">basicConsts :: HenselConsts -&gt; BasicConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#basicConsts"><span class="hs-identifier hs-var">basicConsts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#BasicConsts"><span class="hs-identifier hs-type">BasicConsts</span></a></span><span class="hs-special">{</span><span id="local-6989586621679163882"><span id="local-6989586621679163883"><span id="local-6989586621679163884"><span class="annot"><span class="annottext">Double
Integer
lc :: Integer
kB :: Double
kA :: Integer
lc :: BasicConsts -&gt; Integer
kB :: BasicConsts -&gt; Double
kA :: BasicConsts -&gt; Integer
</span><a href="#local-6989586621679163882"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163881"><span class="annot"><span class="annottext">Natural
primePower :: Natural
primePower :: HenselConsts -&gt; Natural
</span><a href="#local-6989586621679163881"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prime Integer -&gt; Integer
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">unPrime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679163880"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163880"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679163879"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163879"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679163878"><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163878"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">Natural
-&gt; Int -&gt; Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#multiHensel"><span class="hs-identifier hs-var">multiHensel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163880"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163881"><span class="hs-identifier hs-var">primePower</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163879"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163878"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#calcHenselConsts"><span class="hs-pragma hs-type">calcHenselConsts</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-310"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#calcHenselConsts"><span class="hs-identifier hs-type">calcHenselConsts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#HenselConsts"><span class="hs-identifier hs-type">HenselConsts</span></a></span><span>
</span><span id="line-311"></span><span id="calcHenselConsts"><span class="annot"><span class="annottext">calcHenselConsts :: Prime Integer -&gt; Unipol Integer -&gt; HenselConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#calcHenselConsts"><span class="hs-identifier hs-var hs-var">calcHenselConsts</span></a></span></span><span> </span><span id="local-6989586621679163877"><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163877"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679163876"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163876"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163875"><span class="annot"><span class="annottext">primePower :: Natural
</span><a href="#local-6989586621679163875"><span class="hs-identifier hs-var hs-var">primePower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Natural
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Natural) -&gt; Double -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">logBase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Double) -&gt; Integer -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer -&gt; Integer
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">unPrime</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163877"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163873"><span class="hs-identifier hs-var">kB</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-313"></span><span>      </span><span id="local-6989586621679163872"><span class="annot"><span class="annottext">basicConsts :: BasicConsts
</span><a href="#local-6989586621679163872"><span class="hs-identifier hs-var">basicConsts</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#BasicConsts"><span class="hs-identifier hs-type">BasicConsts</span></a></span><span class="hs-special">{</span><span id="local-6989586621679163870"><span id="local-6989586621679163871"><span id="local-6989586621679163873"><span class="annot"><span class="annottext">Double
Integer
lc :: Integer
kA :: Integer
kB :: Double
lc :: BasicConsts -&gt; Integer
kB :: BasicConsts -&gt; Double
kA :: BasicConsts -&gt; Integer
</span><a href="#local-6989586621679163870"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; BasicConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#calcBasicConsts"><span class="hs-identifier hs-var">calcBasicConsts</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163876"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HenselConsts :: BasicConsts -&gt; Natural -&gt; HenselConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#HenselConsts"><span class="hs-identifier hs-type">HenselConsts</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">Natural
BasicConsts
basicConsts :: BasicConsts
primePower :: Natural
primePower :: Natural
basicConsts :: BasicConsts
</span><a href="#local-6989586621679163872"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#calcBasicConsts"><span class="hs-identifier hs-type">calcBasicConsts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#BasicConsts"><span class="hs-identifier hs-type">BasicConsts</span></a></span><span>
</span><span id="line-317"></span><span id="calcBasicConsts"><span class="annot"><span class="annottext">calcBasicConsts :: Unipol Integer -&gt; BasicConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#calcBasicConsts"><span class="hs-identifier hs-var hs-var">calcBasicConsts</span></a></span></span><span> </span><span id="local-6989586621679163869"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163869"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163868"><span class="annot"><span class="annottext">lc :: Coefficient (Unipol Integer)
</span><a href="#local-6989586621679163868"><span class="hs-identifier hs-var hs-var">lc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163869"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-319"></span><span>      </span><span id="local-6989586621679163867"><span class="annot"><span class="annottext">kA :: Norm (Coefficient (Unipol Integer))
</span><a href="#local-6989586621679163867"><span class="hs-identifier hs-var hs-var">kA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Norm (Coefficient (Unipol Integer))
forall poly.
(IsPolynomial poly, Normed (Coefficient poly)) =&gt;
poly -&gt; Norm (Coefficient poly)
</span><span class="hs-identifier hs-var">maxNorm</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163869"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span id="local-6989586621679163865"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679163865"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163869"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-321"></span><span>      </span><span id="local-6989586621679163864"><span class="annot"><span class="annottext">kB :: Double
</span><a href="#local-6989586621679163864"><span class="hs-identifier hs-var hs-var">kB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163865"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">P.^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163865"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
Norm (Coefficient (Unipol Integer))
</span><a href="#local-6989586621679163867"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
Coefficient (Unipol Integer)
</span><a href="#local-6989586621679163868"><span class="hs-identifier hs-var">lc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BasicConsts :: Integer -&gt; Double -&gt; Integer -&gt; BasicConsts
</span><a href="Algebra.Ring.Polynomial.Factorise.html#BasicConsts"><span class="hs-identifier hs-type">BasicConsts</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">Double
Integer
Coefficient (Unipol Integer)
Norm (Coefficient (Unipol Integer))
kB :: Double
kA :: Norm (Coefficient (Unipol Integer))
lc :: Coefficient (Unipol Integer)
lc :: Integer
kB :: Double
kA :: Integer
</span><a href="#local-6989586621679163864"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span id="local-6989586621679164252"><span id="local-6989586621679164253"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#factorPrimitiveIntegerPolWith"><span class="hs-identifier hs-type">factorPrimitiveIntegerPolWith</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679164253"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Prime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164252"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-comment">-- ^ Preprocess</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679164252"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-comment">-- ^ Possible searching range for primes</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679164252"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-comment">-- ^ Modulus for final coefficients</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679164252"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-comment">-- ^ Post processor for factor; identity in big-prime, multiHensel for hensel.</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164253"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-336"></span><span id="factorPrimitiveIntegerPolWith"><span class="annot"><span class="annottext">factorPrimitiveIntegerPolWith :: (Prime Integer -&gt; Unipol Integer -&gt; a)
-&gt; (a -&gt; Unipol Integer -&gt; Maybe (Integer, Integer))
-&gt; (a -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer)
-&gt; (a
    -&gt; Prime Integer
    -&gt; Unipol Integer
    -&gt; [Unipol Integer]
    -&gt; [Unipol Integer])
-&gt; Unipol Integer
-&gt; m [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorPrimitiveIntegerPolWith"><span class="hs-identifier hs-var hs-var">factorPrimitiveIntegerPolWith</span></a></span></span><span> </span><span id="local-6989586621679163862"><span class="annot"><span class="annottext">Prime Integer -&gt; Unipol Integer -&gt; a
</span><a href="#local-6989586621679163862"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621679163861"><span class="annot"><span class="annottext">a -&gt; Unipol Integer -&gt; Maybe (Integer, Integer)
</span><a href="#local-6989586621679163861"><span class="hs-identifier hs-var">mRange</span></a></span></span><span> </span><span id="local-6989586621679163860"><span class="annot"><span class="annottext">a -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer
</span><a href="#local-6989586621679163860"><span class="hs-identifier hs-var">modulus</span></a></span></span><span> </span><span id="local-6989586621679163859"><span class="annot"><span class="annottext">a
-&gt; Prime Integer
-&gt; Unipol Integer
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163859"><span class="hs-identifier hs-var">postProcess</span></a></span></span><span> </span><span id="local-6989586621679163858"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163857"><span class="annot"><span class="annottext">lc :: Coefficient (Unipol Integer)
</span><a href="#local-6989586621679163857"><span class="hs-identifier hs-var hs-var">lc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span id="local-6989586621679163856"><span class="annot"><span class="annottext">info :: a
</span><a href="#local-6989586621679163856"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prime Integer -&gt; Unipol Integer -&gt; a
</span><a href="#local-6989586621679163862"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163855"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-339"></span><span>      </span><span id="local-6989586621679163854"><span class="annot"><span class="annottext">range :: [Prime Integer]
</span><a href="#local-6989586621679163854"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Prime Integer]
-&gt; ((Integer, Integer) -&gt; [Prime Integer])
-&gt; Maybe (Integer, Integer)
-&gt; [Prime Integer]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[Prime Integer]
forall a. Integral a =&gt; [Prime a]
</span><span class="hs-identifier hs-var">PRIMES.primes</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679163851"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163851"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679163850"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163850"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; Prime Integer
forall a.
(Bits a, Integral a, UniqueFactorisation a) =&gt;
a -&gt; Prime a
</span><span class="hs-identifier hs-var">precPrime</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163851"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Prime Integer
forall a.
(Bits a, Integral a, UniqueFactorisation a) =&gt;
a -&gt; Prime a
</span><span class="hs-identifier hs-var">precPrime</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163850"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>          </span><span class="annot"><span class="annottext">(Maybe (Integer, Integer) -&gt; [Prime Integer])
-&gt; Maybe (Integer, Integer) -&gt; [Prime Integer]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Unipol Integer -&gt; Maybe (Integer, Integer)
</span><a href="#local-6989586621679163861"><span class="hs-identifier hs-var">mRange</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163856"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-341"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679163855"><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163855"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prime Integer -&gt; Bool) -&gt; [Prime Integer] -&gt; Maybe (Prime Integer)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer -&gt; Bool
</span><a href="#local-6989586621679163848"><span class="hs-identifier hs-var">isGoodPrime</span></a></span><span> </span><span class="annot"><span class="annottext">[Prime Integer]
</span><a href="#local-6989586621679163854"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; (forall (p :: Nat).
    KnownNat p =&gt;
    Proxy (F p) -&gt; m [Unipol Integer])
-&gt; m [Unipol Integer]
forall a.
Integer -&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">reifyPrimeField</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prime Integer -&gt; Integer
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">unPrime</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163855"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall (p :: Nat).
  KnownNat p =&gt;
  Proxy (F p) -&gt; m [Unipol Integer])
 -&gt; m [Unipol Integer])
-&gt; (forall (p :: Nat).
    KnownNat p =&gt;
    Proxy (F p) -&gt; m [Unipol Integer])
-&gt; m [Unipol Integer]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679163846"><span class="annot"><span class="annottext">Proxy (F p)
</span><a href="#local-6989586621679163846"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163845"><span class="annot"><span class="annottext">lc&#39; :: F p
</span><a href="#local-6989586621679163845"><span class="hs-identifier hs-var hs-var">lc&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (F p) -&gt; Integer -&gt; F p
forall k (proxy :: * -&gt; *) (p :: k).
Reifies p Integer =&gt;
proxy (F p) -&gt; Integer -&gt; F p
</span><span class="hs-identifier hs-var">modNat&#39;</span></span><span> </span><span class="annot"><span class="annottext">Proxy (F p)
</span><a href="#local-6989586621679163846"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
Coefficient (Unipol Integer)
</span><a href="#local-6989586621679163857"><span class="hs-identifier hs-var">lc</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span id="local-6989586621679163843"><span class="annot"><span class="annottext">f0 :: Unipol (F p)
</span><a href="#local-6989586621679163843"><span class="hs-identifier hs-var hs-var">f0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Unipol Integer -&gt; Unipol (F p)
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">F p -&gt; F p -&gt; F p
forall r. Division r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679163845"><span class="hs-identifier hs-var">lc&#39;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(F p -&gt; F p) -&gt; (Integer -&gt; F p) -&gt; Integer -&gt; F p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Proxy (F p) -&gt; Integer -&gt; F p
forall k (proxy :: * -&gt; *) (p :: k).
Reifies p Integer =&gt;
proxy (F p) -&gt; Integer -&gt; F p
</span><span class="hs-identifier hs-var">modNat&#39;</span></span><span> </span><span class="annot"><span class="annottext">Proxy (F p)
</span><a href="#local-6989586621679163846"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679163841"><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163841"><span class="hs-identifier hs-var">fps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Unipol (F p), Natural) -&gt; Unipol Integer)
-&gt; [(Unipol (F p), Natural)] -&gt; [Unipol Integer]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#normalizeMod"><span class="hs-identifier hs-var">normalizeMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prime Integer -&gt; Integer
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">unPrime</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163855"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>              </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Unipol Integer)
-&gt; ((Unipol (F p), Natural) -&gt; Unipol Integer)
-&gt; (Unipol (F p), Natural)
-&gt; Unipol Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(F p -&gt; Integer) -&gt; Unipol (F p) -&gt; Unipol Integer
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (p :: k). F p -&gt; Integer
</span><span class="hs-identifier hs-var">naturalRepr</span></span><span> </span><span class="annot"><span class="annottext">(Unipol (F p) -&gt; Unipol Integer)
-&gt; ((Unipol (F p), Natural) -&gt; Unipol (F p))
-&gt; (Unipol (F p), Natural)
-&gt; Unipol Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Unipol (F p), Natural) -&gt; Unipol (F p)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="annottext">([(Unipol (F p), Natural)] -&gt; [Unipol Integer])
-&gt; m [(Unipol (F p), Natural)] -&gt; m [Unipol Integer]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Unipol (F p) -&gt; m [(Unipol (F p), Natural)]
forall (m :: * -&gt; *) k.
(MonadRandom m, CoeffRing k, FiniteField k, Random k) =&gt;
Unipol k -&gt; m [(Unipol k, Natural)]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#factorise"><span class="hs-identifier hs-var">factorise</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol (F p)
</span><a href="#local-6989586621679163843"><span class="hs-identifier hs-var">f0</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163838"><span class="annot"><span class="annottext">gs :: Vector (Unipol Integer)
</span><a href="#local-6989586621679163838"><span class="hs-identifier hs-var hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Unipol Integer] -&gt; Vector (Unipol Integer)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Unipol Integer] -&gt; Vector (Unipol Integer))
-&gt; [Unipol Integer] -&gt; Vector (Unipol Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Prime Integer
-&gt; Unipol Integer
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163859"><span class="hs-identifier hs-var">postProcess</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163856"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163855"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163841"><span class="hs-identifier hs-var">fps</span></a></span><span>
</span><span id="line-349"></span><span>        </span><span id="local-6989586621679163836"><span class="annot"><span class="annottext">count :: Int
</span><a href="#local-6989586621679163836"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer) -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163838"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span id="local-6989586621679163834"><span class="annot"><span class="annottext">alives :: [Int]
</span><a href="#local-6989586621679163834"><span class="hs-identifier hs-var hs-var">alives</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163836"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="annottext">[Unipol Integer] -&gt; m [Unipol Integer]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Unipol Integer] -&gt; m [Unipol Integer])
-&gt; [Unipol Integer] -&gt; m [Unipol Integer]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; [Int]
-&gt; Int
-&gt; Int
-&gt; Unipol Integer
-&gt; Vector (Unipol Integer)
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163833"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Prime Integer -&gt; Unipol Integer -&gt; Integer
</span><a href="#local-6989586621679163860"><span class="hs-identifier hs-var">modulus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163856"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163855"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163834"><span class="hs-identifier hs-var">alives</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163836"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163838"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621679163832"><span class="annot"><span class="annottext">lc :: Coefficient (Unipol Integer)
</span><a href="#local-6989586621679163832"><span class="hs-identifier hs-var hs-var">lc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621679163848"><span class="annot"><span class="annottext">isGoodPrime :: Prime Integer -&gt; Bool
</span><a href="#local-6989586621679163848"><span class="hs-identifier hs-var hs-var">isGoodPrime</span></a></span></span><span> </span><span id="local-6989586621679163831"><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163831"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; Bool) -&gt; Bool
forall a.
Integer -&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">reifyPrimeField</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prime Integer -&gt; Integer
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">unPrime</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163831"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; Bool) -&gt; Bool)
-&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; Bool) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679163830"><span class="annot"><span class="annottext">Proxy (F p)
</span><a href="#local-6989586621679163830"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><span class="annottext">Integer
Coefficient (Unipol Integer)
</span><a href="#local-6989586621679163832"><span class="hs-identifier hs-var">lc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer -&gt; Integer
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">unPrime</span></span><span> </span><span class="annot"><span class="annottext">Prime Integer
</span><a href="#local-6989586621679163831"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Unipol (F p) -&gt; Bool
forall poly.
(IsOrderedPolynomial poly, GCDDomain poly) =&gt;
poly -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Factorise.html#isSquareFree"><span class="hs-identifier hs-var">isSquareFree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Unipol Integer -&gt; Unipol (F p)
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (F p) -&gt; Integer -&gt; F p
forall k (proxy :: * -&gt; *) (p :: k).
Reifies p Integer =&gt;
proxy (F p) -&gt; Integer -&gt; F p
</span><span class="hs-identifier hs-var">modNat&#39;</span></span><span> </span><span class="annot"><span class="annottext">Proxy (F p)
</span><a href="#local-6989586621679163830"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>    </span><span id="local-6989586621679163828"><span class="annot"><span class="annottext">kA :: Norm (Coefficient (Unipol Integer))
</span><a href="#local-6989586621679163828"><span class="hs-identifier hs-var hs-var">kA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Norm (Coefficient (Unipol Integer))
forall poly.
(IsPolynomial poly, Normed (Coefficient poly)) =&gt;
poly -&gt; Norm (Coefficient poly)
</span><span class="hs-identifier hs-var">maxNorm</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621679163827"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679163827"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163858"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><a href="#local-6989586621679163826"><span class="hs-identifier hs-type">kB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621679163826"><span class="annot"><span class="annottext">kB :: Double
</span><a href="#local-6989586621679163826"><span class="hs-identifier hs-var hs-var">kB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163827"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">P.^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163827"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
Norm (Coefficient (Unipol Integer))
</span><a href="#local-6989586621679163828"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
Coefficient (Unipol Integer)
</span><a href="#local-6989586621679163832"><span class="hs-identifier hs-var">lc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621679163833"><span class="annot"><span class="annottext">loop :: Integer
-&gt; [Int]
-&gt; Int
-&gt; Int
-&gt; Unipol Integer
-&gt; Vector (Unipol Integer)
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163833"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679163825"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163825"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679163824"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163824"><span class="hs-identifier hs-var">alives</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679163823"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163823"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679163822"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163822"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679163821"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163821"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679163820"><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163820"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621679163819"><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163819"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163822"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163823"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-362"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163821"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Unipol Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163819"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163821"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163819"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; [Int]
-&gt; Int
-&gt; Int
-&gt; [([Int], [Int])]
-&gt; Unipol Integer
-&gt; Integer
-&gt; Vector (Unipol Integer)
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163818"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163825"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163824"><span class="hs-identifier hs-var">alives</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163823"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163822"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-364"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [([Int], [Int])]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#combinations"><span class="hs-identifier hs-var">combinations</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163822"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163824"><span class="hs-identifier hs-var">alives</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163821"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163821"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163820"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163819"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span id="local-6989586621679163818"><span class="annot"><span class="annottext">go :: Integer
-&gt; [Int]
-&gt; Int
-&gt; Int
-&gt; [([Int], [Int])]
-&gt; Unipol Integer
-&gt; Integer
-&gt; Vector (Unipol Integer)
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163818"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679163816"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163816"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679163815"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163815"><span class="hs-identifier hs-var">alives</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679163814"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163814"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span id="local-6989586621679163813"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163813"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679163812"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163812"><span class="hs-identifier hs-var">f&#39;</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679163811"><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163811"><span class="hs-identifier hs-var">pols</span></a></span></span><span> </span><span id="local-6989586621679163810"><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163810"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; [Int]
-&gt; Int
-&gt; Int
-&gt; Unipol Integer
-&gt; Vector (Unipol Integer)
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163833"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163816"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163815"><span class="hs-identifier hs-var">alives</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163814"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163813"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163812"><span class="hs-identifier hs-var">f&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163811"><span class="hs-identifier hs-var">pols</span></a></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163810"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="#local-6989586621679163818"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679163809"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163809"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679163808"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163808"><span class="hs-identifier hs-var">alives</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679163807"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163807"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span id="local-6989586621679163806"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163806"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679163805"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163805"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163804"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163804"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679163803"><span class="annot"><span class="annottext">[([Int], [Int])]
</span><a href="#local-6989586621679163803"><span class="hs-identifier hs-var">cands</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679163802"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163802"><span class="hs-identifier hs-var">f&#39;</span></a></span></span><span> </span><span id="local-6989586621679163801"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163801"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679163800"><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163800"><span class="hs-identifier hs-var">pols</span></a></span></span><span> </span><span id="local-6989586621679163799"><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163799"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Norm (Coefficient (Unipol Integer))
forall poly.
(IsPolynomial poly, Normed (Coefficient poly),
 Monoidal (Norm (Coefficient poly))) =&gt;
poly -&gt; Norm (Coefficient poly)
</span><span class="hs-identifier hs-var">oneNorm</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163797"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Norm (Coefficient (Unipol Integer))
forall poly.
(IsPolynomial poly, Normed (Coefficient poly),
 Monoidal (Norm (Coefficient poly))) =&gt;
poly -&gt; Norm (Coefficient poly)
</span><span class="hs-identifier hs-var">oneNorm</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163796"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163826"><span class="hs-identifier hs-var">kB</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>          </span><span class="annot"><span class="annottext">Integer
-&gt; [Int]
-&gt; Int
-&gt; Int
-&gt; Unipol Integer
-&gt; Vector (Unipol Integer)
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163833"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163809"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163804"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163807"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163806"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163806"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Unipol Integer
forall poly.
(Euclidean (Coefficient poly), IsPolynomial poly) =&gt;
poly -&gt; poly
</span><span class="hs-identifier hs-var">pp</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163796"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163800"><span class="hs-identifier hs-var">pols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Unipol Integer
forall poly.
(Euclidean (Coefficient poly), IsPolynomial poly) =&gt;
poly -&gt; poly
</span><span class="hs-identifier hs-var">pp</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163797"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163799"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; [Int]
-&gt; Int
-&gt; Int
-&gt; [([Int], [Int])]
-&gt; Unipol Integer
-&gt; Integer
-&gt; Vector (Unipol Integer)
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
</span><a href="#local-6989586621679163818"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163809"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163808"><span class="hs-identifier hs-var">alives</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163807"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163806"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[([Int], [Int])]
</span><a href="#local-6989586621679163803"><span class="hs-identifier hs-var">cands</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163802"><span class="hs-identifier hs-var">f&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163801"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163800"><span class="hs-identifier hs-var">pols</span></a></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer]
</span><a href="#local-6989586621679163799"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>        </span><span id="local-6989586621679163797"><span class="annot"><span class="annottext">g :: Unipol Integer
</span><a href="#local-6989586621679163797"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#normalizeMod"><span class="hs-identifier hs-var">normalizeMod</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163809"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Unipol Integer)
-&gt; Unipol Integer -&gt; Unipol Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163801"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
forall r m. LeftModule r m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*</span></span><span> </span><span class="annot"><span class="annottext">Mult (Unipol Integer) -&gt; Unipol Integer
forall a. Mult a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runMult</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Mult (Unipol Integer)) -&gt; [Int] -&gt; Mult (Unipol Integer)
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Mult (Unipol Integer)
forall a. a -&gt; Mult a
</span><span class="hs-identifier hs-var">Mult</span></span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Mult (Unipol Integer))
-&gt; (Int -&gt; Unipol Integer) -&gt; Int -&gt; Mult (Unipol Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer) -&gt; Int -&gt; Unipol Integer
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163800"><span class="hs-identifier hs-var">pols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163805"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>        </span><span id="local-6989586621679163796"><span class="annot"><span class="annottext">h :: Unipol Integer
</span><a href="#local-6989586621679163796"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#normalizeMod"><span class="hs-identifier hs-var">normalizeMod</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163809"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Unipol Integer)
-&gt; Unipol Integer -&gt; Unipol Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163801"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
forall r m. LeftModule r m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*</span></span><span> </span><span class="annot"><span class="annottext">Mult (Unipol Integer) -&gt; Unipol Integer
forall a. Mult a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runMult</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Mult (Unipol Integer)) -&gt; [Int] -&gt; Mult (Unipol Integer)
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Mult (Unipol Integer)
forall a. a -&gt; Mult a
</span><span class="hs-identifier hs-var">Mult</span></span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Mult (Unipol Integer))
-&gt; (Int -&gt; Unipol Integer) -&gt; Int -&gt; Mult (Unipol Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer) -&gt; Int -&gt; Unipol Integer
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163800"><span class="hs-identifier hs-var">pols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679163804"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-comment">-- | Given that @f = gh (mod m)@ with @sg + th = 1 (mod m)@ and @leadingCoeff f@ isn&#39;t zero divisor mod m,</span><span>
</span><span id="line-375"></span><span class="hs-comment">--   @henselStep m f g h s t@ calculates the unique (g&#39;, h&#39;, s&#39;, t&#39;) s.t.</span><span>
</span><span id="line-376"></span><span class="hs-comment">--   @f = g&#39; h&#39; (mod m^2), g&#39; = g (mod m), h&#39; = h (mod m), s&#39; = s (mod m), t&#39; = t (mod m)@, @h&#39;@ monic.</span><span>
</span><span id="line-377"></span><span id="local-6989586621679164188"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#henselStep"><span class="hs-identifier hs-type">henselStep</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span>        </span><span class="hs-comment">-- ^ modulus</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679164188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-386"></span><span id="henselStep"><span class="annot"><span class="annottext">henselStep :: r
-&gt; Unipol r
-&gt; Unipol r
-&gt; Unipol r
-&gt; Unipol r
-&gt; Unipol r
-&gt; (Unipol r, Unipol r, Unipol r, Unipol r)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#henselStep"><span class="hs-identifier hs-var hs-var">henselStep</span></a></span></span><span> </span><span id="local-6989586621679163791"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679163791"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679163790"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163790"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679163789"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163789"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679163788"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163788"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679163787"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163787"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679163786"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163786"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163785"><span class="annot"><span class="annottext">modCoeff :: Unipol r -&gt; Unipol r
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var hs-var">modCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; Unipol r -&gt; Unipol r
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`rem`</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679163791"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">r -&gt; Natural -&gt; r
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>      </span><span id="local-6989586621679163783"><span class="annot"><span class="annottext">divModSq :: Unipol r -&gt; Unipol r -&gt; (Unipol r, Unipol r)
</span><a href="#local-6989586621679163783"><span class="hs-identifier hs-var hs-var">divModSq</span></a></span></span><span> </span><span id="local-6989586621679163782"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163782"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679163781"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-389"></span><span>        </span><span class="annot"><span class="annottext">(r -&gt; Fraction r) -&gt; Unipol r -&gt; Unipol (Fraction r)
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Fraction r
forall d. GCDDomain d =&gt; d -&gt; d -&gt; Fraction d
</span><span class="hs-operator hs-var">F.%</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163782"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol (Fraction r)
-&gt; Unipol (Fraction r)
-&gt; (Unipol (Fraction r), Unipol (Fraction r))
forall d. Euclidean d =&gt; d -&gt; d -&gt; (d, d)
</span><span class="hs-operator hs-var">`divide`</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Fraction r) -&gt; Unipol r -&gt; Unipol (Fraction r)
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Fraction r
forall d. GCDDomain d =&gt; d -&gt; d -&gt; Fraction d
</span><span class="hs-operator hs-var">F.%</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163781"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-390"></span><span>        </span><span class="annot"><span class="annottext">(Unipol (Fraction r), Unipol (Fraction r))
-&gt; ((Unipol (Fraction r), Unipol (Fraction r))
    -&gt; (Unipol r, Unipol r))
-&gt; (Unipol r, Unipol r)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Unipol (Fraction r) -&gt; Identity (Unipol r))
-&gt; (Unipol (Fraction r), Unipol (Fraction r))
-&gt; Identity (Unipol r, Unipol r)
forall (r :: * -&gt; * -&gt; *) a b.
Bitraversable r =&gt;
Traversal (r a a) (r b b) a b
</span><span class="hs-identifier hs-var">both</span></span><span> </span><span class="annot"><span class="annottext">((Unipol (Fraction r) -&gt; Identity (Unipol r))
 -&gt; (Unipol (Fraction r), Unipol (Fraction r))
 -&gt; Identity (Unipol r, Unipol r))
-&gt; (Unipol (Fraction r) -&gt; Unipol r)
-&gt; (Unipol (Fraction r), Unipol (Fraction r))
-&gt; (Unipol r, Unipol r)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Fraction r -&gt; r) -&gt; Unipol (Fraction r) -&gt; Unipol r
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe r -&gt; r
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe r -&gt; r) -&gt; (Fraction r -&gt; Maybe r) -&gt; Fraction r -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Fraction r -&gt; Maybe r
forall s. (Euclidean s, Eq s) =&gt; s -&gt; Fraction s -&gt; Maybe s
</span><a href="Algebra.Ring.Polynomial.Factorise.html#modFraction"><span class="hs-identifier hs-var">modFraction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679163791"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">r -&gt; Natural -&gt; r
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>      </span><span id="local-6989586621679163778"><span class="annot"><span class="annottext">e :: Unipol r
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var">modCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol r -&gt; Unipol r) -&gt; Unipol r -&gt; Unipol r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163790"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163789"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163788"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679163777"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163777"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163776"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163776"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; (Unipol r, Unipol r)
</span><a href="#local-6989586621679163783"><span class="hs-identifier hs-var">divModSq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163787"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163788"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-393"></span><span>      </span><span id="local-6989586621679163775"><span class="annot"><span class="annottext">g&#39; :: Unipol r
</span><a href="#local-6989586621679163775"><span class="hs-identifier hs-var hs-var">g&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var">modCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol r -&gt; Unipol r) -&gt; Unipol r -&gt; Unipol r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163789"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163786"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163778"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163777"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163789"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-394"></span><span>      </span><span id="local-6989586621679163774"><span class="annot"><span class="annottext">h&#39; :: Unipol r
</span><a href="#local-6989586621679163774"><span class="hs-identifier hs-var hs-var">h&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var">modCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol r -&gt; Unipol r) -&gt; Unipol r -&gt; Unipol r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163788"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163776"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span id="local-6989586621679163773"><span class="annot"><span class="annottext">b :: Unipol r
</span><a href="#local-6989586621679163773"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var">modCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol r -&gt; Unipol r) -&gt; Unipol r -&gt; Unipol r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163787"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163775"><span class="hs-identifier hs-var">g&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163786"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163774"><span class="hs-identifier hs-var">h&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-396"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679163772"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163772"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163771"><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163771"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; (Unipol r, Unipol r)
</span><a href="#local-6989586621679163783"><span class="hs-identifier hs-var">divModSq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163787"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163773"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163774"><span class="hs-identifier hs-var">h&#39;</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span id="local-6989586621679163770"><span class="annot"><span class="annottext">s&#39; :: Unipol r
</span><a href="#local-6989586621679163770"><span class="hs-identifier hs-var hs-var">s&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var">modCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol r -&gt; Unipol r) -&gt; Unipol r -&gt; Unipol r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163787"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163771"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-398"></span><span>      </span><span id="local-6989586621679163769"><span class="annot"><span class="annottext">t&#39; :: Unipol r
</span><a href="#local-6989586621679163769"><span class="hs-identifier hs-var hs-var">t&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r
</span><a href="#local-6989586621679163785"><span class="hs-identifier hs-var">modCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(Unipol r -&gt; Unipol r) -&gt; Unipol r -&gt; Unipol r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163786"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163786"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163773"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163772"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Unipol r -&gt; Unipol r -&gt; Unipol r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163775"><span class="hs-identifier hs-var">g&#39;</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163775"><span class="hs-identifier hs-var">g&#39;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163774"><span class="hs-identifier hs-var">h&#39;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163770"><span class="hs-identifier hs-var">s&#39;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol r
</span><a href="#local-6989586621679163769"><span class="hs-identifier hs-var">t&#39;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Repeatedly applies hensel lifting for monics.</span><span>
</span><span id="line-402"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#repeatHensel"><span class="hs-identifier hs-type">repeatHensel</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span id="repeatHensel"><span class="annot"><span class="annottext">repeatHensel :: Integer
-&gt; Int
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; (Unipol Integer, Unipol Integer, Unipol Integer, Unipol Integer)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#repeatHensel"><span class="hs-identifier hs-var hs-var">repeatHensel</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679163767"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163767"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679163766"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163766"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679163765"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163765"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679163764"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163764"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679163763"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163763"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#normalizeMod"><span class="hs-identifier hs-var">normalizeMod</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163767"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163766"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#normalizeMod"><span class="hs-identifier hs-var">normalizeMod</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163767"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163765"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163764"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163763"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#repeatHensel"><span class="hs-identifier hs-var">repeatHensel</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679163762"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163762"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679163761"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679163760"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679163759"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163759"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679163758"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163758"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679163757"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163757"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679163756"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163756"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163755"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163755"><span class="hs-identifier hs-var">g&#39;</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163754"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163754"><span class="hs-identifier hs-var">h&#39;</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163753"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163753"><span class="hs-identifier hs-var">s&#39;</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163752"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163752"><span class="hs-identifier hs-var">t&#39;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; (Unipol Integer, Unipol Integer, Unipol Integer, Unipol Integer)
forall r.
(Eq r, Euclidean r) =&gt;
r
-&gt; Unipol r
-&gt; Unipol r
-&gt; Unipol r
-&gt; Unipol r
-&gt; Unipol r
-&gt; (Unipol r, Unipol r, Unipol r, Unipol r)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#henselStep"><span class="hs-identifier hs-var">henselStep</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163762"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163759"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163758"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163757"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163756"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; Int
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; (Unipol Integer, Unipol Integer, Unipol Integer, Unipol Integer)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#repeatHensel"><span class="hs-identifier hs-var">repeatHensel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163762"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural -&gt; Integer
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163761"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163760"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163755"><span class="hs-identifier hs-var">g&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163754"><span class="hs-identifier hs-var">h&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163753"><span class="hs-identifier hs-var">s&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163752"><span class="hs-identifier hs-var">t&#39;</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">-- | Monic hensel lifting for many factors.</span><span>
</span><span id="line-414"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#multiHensel"><span class="hs-identifier hs-type">multiHensel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>          </span><span class="hs-comment">-- ^ prime @p@</span><span>
</span><span id="line-415"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>              </span><span class="hs-comment">-- ^ iteration count @k@.</span><span>
</span><span id="line-416"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>   </span><span class="hs-comment">-- ^ original polynomial</span><span>
</span><span id="line-417"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ monic coprime factorisation mod @p@</span><span>
</span><span id="line-418"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ coprime factorisation mod @p^(2^k)@.</span><span>
</span><span id="line-419"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#multiHensel"><span class="hs-pragma hs-type">multiHensel</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-420"></span><span id="multiHensel"><span class="annot"><span class="annottext">multiHensel :: Natural
-&gt; Int -&gt; Unipol Integer -&gt; [Unipol Integer] -&gt; [Unipol Integer]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#multiHensel"><span class="hs-identifier hs-var hs-var">multiHensel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679163751"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163751"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679163750"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163750"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679163749"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163749"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DList (Unipol Integer) -&gt; [Unipol Integer]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span> </span><span class="annot"><span class="annottext">(DList (Unipol Integer) -&gt; [Unipol Integer])
-&gt; ([Unipol Integer] -&gt; DList (Unipol Integer))
-&gt; [Unipol Integer]
-&gt; [Unipol Integer]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Vector (Unipol Integer) -&gt; DList (Unipol Integer)
</span><a href="#local-6989586621679163747"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163749"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Unipol Integer) -&gt; DList (Unipol Integer))
-&gt; ([Unipol Integer] -&gt; Vector (Unipol Integer))
-&gt; [Unipol Integer]
-&gt; DList (Unipol Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Unipol Integer] -&gt; Vector (Unipol Integer)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621679163747"><span class="annot"><span class="annottext">go :: Unipol Integer -&gt; Vector (Unipol Integer) -&gt; DList (Unipol Integer)
</span><a href="#local-6989586621679163747"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679163746"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163746"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679163745"><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163745"><span class="hs-identifier hs-var">gs</span></a></span></span><span>
</span><span id="line-423"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163744"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList (Unipol Integer)
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163744"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; DList (Unipol Integer)
forall a. a -&gt; DList a
</span><span class="hs-identifier hs-var">DL.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; DList (Unipol Integer))
-&gt; Unipol Integer -&gt; DList (Unipol Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-425"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163741"><span class="annot"><span class="annottext">q :: Integer
</span><a href="#local-6989586621679163741"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163751"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">P.^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163750"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-426"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621679163740"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163740"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679163739"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163739"><span class="hs-identifier hs-var">bInv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; (Integer, Integer, Integer)
forall d. PID d =&gt; d -&gt; d -&gt; (d, d, d)
</span><span class="hs-identifier hs-var">egcd</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163741"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163746"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Unipol Integer -&gt; Unipol Integer
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163741"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>            </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Unipol Integer)
-&gt; Unipol Integer -&gt; Unipol Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163739"><span class="hs-identifier hs-var">bInv</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163740"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
forall r m. Module (Scalar r) m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*.</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163746"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; (forall (p :: Nat).
    KnownNat p =&gt;
    Proxy (F p) -&gt; DList (Unipol Integer))
-&gt; DList (Unipol Integer)
forall a.
Integer -&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">reifyPrimeField</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163751"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (p :: Nat).
  KnownNat p =&gt;
  Proxy (F p) -&gt; DList (Unipol Integer))
 -&gt; DList (Unipol Integer))
-&gt; (forall (p :: Nat).
    KnownNat p =&gt;
    Proxy (F p) -&gt; DList (Unipol Integer))
-&gt; DList (Unipol Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679163737"><span class="annot"><span class="annottext">Proxy (F p)
</span><a href="#local-6989586621679163737"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-430"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163736"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679163736"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163744"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-431"></span><span>            </span><span id="local-6989586621679163735"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679163735"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><span class="hs-identifier hs-var">ceilingLogBase2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163750"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-432"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679163733"><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163733"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163732"><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163732"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Vector (Unipol Integer)
-&gt; (Vector (Unipol Integer), Vector (Unipol Integer))
forall a. Int -&gt; Vector a -&gt; (Vector a, Vector a)
</span><span class="hs-identifier hs-var">V.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163736"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163745"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679163730"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163730"><span class="hs-identifier hs-var">g0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163729"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163729"><span class="hs-identifier hs-var">h0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol Integer -&gt; Coefficient (Unipol Integer)
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">leadingCoeff</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163746"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Unipol Integer -&gt; Unipol Integer
forall r m. Module (Scalar r) m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer) -&gt; Unipol Integer
forall (f :: * -&gt; *) r. (Foldable f, Unital r) =&gt; f r -&gt; r
</span><span class="hs-identifier hs-var">product</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163733"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer) -&gt; Unipol Integer
forall (f :: * -&gt; *) r. (Foldable f, Unital r) =&gt; f r -&gt; r
</span><span class="hs-identifier hs-var">product</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163732"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>              </span><span class="annot"><span class="annottext">(Unipol Integer, Unipol Integer)
-&gt; ((Unipol Integer, Unipol Integer)
    -&gt; (Unipol Integer, Unipol Integer))
-&gt; (Unipol Integer, Unipol Integer)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Unipol Integer -&gt; Identity (Unipol Integer))
-&gt; (Unipol Integer, Unipol Integer)
-&gt; Identity (Unipol Integer, Unipol Integer)
forall (r :: * -&gt; * -&gt; *) a b.
Bitraversable r =&gt;
Traversal (r a a) (r b b) a b
</span><span class="hs-identifier hs-var">both</span></span><span> </span><span class="annot"><span class="annottext">((Unipol Integer -&gt; Identity (Unipol Integer))
 -&gt; (Unipol Integer, Unipol Integer)
 -&gt; Identity (Unipol Integer, Unipol Integer))
-&gt; (Unipol Integer -&gt; Unipol Integer)
-&gt; (Unipol Integer, Unipol Integer)
-&gt; (Unipol Integer, Unipol Integer)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Unipol Integer -&gt; Unipol Integer
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163751"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol (F p)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163728"><span class="annot"><span class="annottext">Unipol (F p)
</span><a href="#local-6989586621679163728"><span class="hs-identifier hs-var">s0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163727"><span class="annot"><span class="annottext">Unipol (F p)
</span><a href="#local-6989586621679163727"><span class="hs-identifier hs-var">t0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol (F p)
-&gt; Unipol (F p) -&gt; (Unipol (F p), Unipol (F p), Unipol (F p))
forall d. PID d =&gt; d -&gt; d -&gt; (d, d, d)
</span><span class="hs-identifier hs-var">egcd</span></span><span>
</span><span id="line-436"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Unipol Integer -&gt; Unipol (F p)
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (F p) -&gt; Integer -&gt; F p
forall k (proxy :: * -&gt; *) (p :: k).
Reifies p Integer =&gt;
proxy (F p) -&gt; Integer -&gt; F p
</span><span class="hs-identifier hs-var">modNat&#39;</span></span><span> </span><span class="annot"><span class="annottext">Proxy (F p)
</span><a href="#local-6989586621679163737"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163730"><span class="hs-identifier hs-var">g0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Unipol Integer -&gt; Unipol (F p)
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (F p) -&gt; Integer -&gt; F p
forall k (proxy :: * -&gt; *) (p :: k).
Reifies p Integer =&gt;
proxy (F p) -&gt; Integer -&gt; F p
</span><span class="hs-identifier hs-var">modNat&#39;</span></span><span> </span><span class="annot"><span class="annottext">Proxy (F p)
</span><a href="#local-6989586621679163737"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163729"><span class="hs-identifier hs-var">h0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679163726"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163725"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163725"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol (F p)
</span><a href="#local-6989586621679163728"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol (F p)
</span><a href="#local-6989586621679163727"><span class="hs-identifier hs-var">t0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Unipol (F p), Unipol (F p))
-&gt; ((Unipol (F p), Unipol (F p))
    -&gt; (Unipol Integer, Unipol Integer))
-&gt; (Unipol Integer, Unipol Integer)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Unipol (F p) -&gt; Identity (Unipol Integer))
-&gt; (Unipol (F p), Unipol (F p))
-&gt; Identity (Unipol Integer, Unipol Integer)
forall (r :: * -&gt; * -&gt; *) a b.
Bitraversable r =&gt;
Traversal (r a a) (r b b) a b
</span><span class="hs-identifier hs-var">both</span></span><span> </span><span class="annot"><span class="annottext">((Unipol (F p) -&gt; Identity (Unipol Integer))
 -&gt; (Unipol (F p), Unipol (F p))
 -&gt; Identity (Unipol Integer, Unipol Integer))
-&gt; (Unipol (F p) -&gt; Unipol Integer)
-&gt; (Unipol (F p), Unipol (F p))
-&gt; (Unipol Integer, Unipol Integer)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(F p -&gt; Integer) -&gt; Unipol (F p) -&gt; Unipol Integer
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (p :: k). F p -&gt; Integer
</span><span class="hs-identifier hs-var">naturalRepr</span></span><span>
</span><span id="line-439"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679163724"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163724"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163723"><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163723"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; Int
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; Unipol Integer
-&gt; (Unipol Integer, Unipol Integer, Unipol Integer, Unipol Integer)
</span><a href="Algebra.Ring.Polynomial.Factorise.html#repeatHensel"><span class="hs-identifier hs-var">repeatHensel</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163751"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163735"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163746"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163730"><span class="hs-identifier hs-var">g0</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163729"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163726"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163725"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-440"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Vector (Unipol Integer) -&gt; DList (Unipol Integer)
</span><a href="#local-6989586621679163747"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163724"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163733"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">DList (Unipol Integer)
-&gt; DList (Unipol Integer) -&gt; DList (Unipol Integer)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Unipol Integer -&gt; Vector (Unipol Integer) -&gt; DList (Unipol Integer)
</span><a href="#local-6989586621679163747"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol Integer
</span><a href="#local-6989586621679163723"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163732"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163744"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679163744"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer) -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector (Unipol Integer)
</span><a href="#local-6989586621679163745"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span id="local-6989586621679164176"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#recipMod"><span class="hs-identifier hs-type">recipMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679164176"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679164176"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164176"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164176"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679164176"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-444"></span><span id="recipMod"><span class="annot"><span class="annottext">recipMod :: a -&gt; a -&gt; Maybe a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#recipMod"><span class="hs-identifier hs-var hs-var">recipMod</span></a></span></span><span> </span><span id="local-6989586621679163721"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163721"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679163720"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163720"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163719"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163718"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163718"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, a, a)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; [(a, a, a)]
forall d. Euclidean d =&gt; d -&gt; d -&gt; [(d, d, d)]
</span><span class="hs-identifier hs-var">euclid</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163720"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163721"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-447"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163718"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span id="local-6989586621679164189"><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#modFraction"><span class="hs-identifier hs-type">modFraction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679164189"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679164189"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164189"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fraction</span></span><span> </span><span class="annot"><a href="#local-6989586621679164189"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679164189"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-450"></span><span id="modFraction"><span class="annot"><span class="annottext">modFraction :: s -&gt; Fraction s -&gt; Maybe s
</span><a href="Algebra.Ring.Polynomial.Factorise.html#modFraction"><span class="hs-identifier hs-var hs-var">modFraction</span></a></span></span><span> </span><span id="local-6989586621679163716"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679163716"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679163715"><span class="annot"><span class="annottext">Fraction s
</span><a href="#local-6989586621679163715"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fraction s -&gt; s
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Fraction s
</span><a href="#local-6989586621679163715"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`rem`</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679163716"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(s -&gt; s) -&gt; Maybe s -&gt; Maybe s
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; Maybe s
forall a. (Euclidean a, Eq a) =&gt; a -&gt; a -&gt; Maybe a
</span><a href="Algebra.Ring.Polynomial.Factorise.html#recipMod"><span class="hs-identifier hs-var">recipMod</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679163716"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fraction s -&gt; s
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Fraction s
</span><a href="#local-6989586621679163715"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#combinations"><span class="hs-identifier hs-type">combinations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span id="combinations"><span class="annot"><span class="annottext">combinations :: Int -&gt; [Int] -&gt; [([Int], [Int])]
</span><a href="Algebra.Ring.Polynomial.Factorise.html#combinations"><span class="hs-identifier hs-var hs-var">combinations</span></a></span></span><span> </span><span id="local-6989586621679163714"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163714"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FMList ([Int], [Int]) -&gt; [([Int], [Int])]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">FML.toList</span></span><span> </span><span class="annot"><span class="annottext">(FMList ([Int], [Int]) -&gt; [([Int], [Int])])
-&gt; ([Int] -&gt; FMList ([Int], [Int])) -&gt; [Int] -&gt; [([Int], [Int])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; FMList ([Int], [Int])
forall r a. (Eq r, Num r, Group r) =&gt; r -&gt; [a] -&gt; FMList ([a], [a])
</span><a href="#local-6989586621679163712"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163714"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-455"></span><span>    </span><span id="local-6989586621679163712"><span class="annot"><span class="annottext">go :: r -&gt; [a] -&gt; FMList ([a], [a])
</span><a href="#local-6989586621679163712"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679163711"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679163711"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a], [a]) -&gt; FMList ([a], [a])
forall a. a -&gt; FMList a
</span><span class="hs-identifier hs-var">FML.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679163711"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><a href="#local-6989586621679163712"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FMList ([a], [a])
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">FML.empty</span></span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><a href="#local-6989586621679163712"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679163708"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679163708"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163707"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163707"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679163706"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679163706"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163705"><span class="annot"><span class="annottext">present :: FMList ([a], [a])
</span><a href="#local-6989586621679163705"><span class="hs-identifier hs-var hs-var">present</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; [a] -&gt; FMList ([a], [a])
</span><a href="#local-6989586621679163712"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679163708"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679163706"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-459"></span><span>          </span><span id="local-6989586621679163704"><span class="annot"><span class="annottext">absent :: FMList ([a], [a])
</span><a href="#local-6989586621679163704"><span class="hs-identifier hs-var hs-var">absent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; [a] -&gt; FMList ([a], [a])
</span><a href="#local-6989586621679163712"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679163708"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679163706"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(([a], [a]) -&gt; ([a], [a]))
-&gt; FMList ([a], [a]) -&gt; FMList ([a], [a])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a], [a]) -&gt; ([a], [a])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">(([a] -&gt; [a]) -&gt; ([a], [a]) -&gt; ([a], [a]))
-&gt; ([a] -&gt; [a]) -&gt; ([a], [a]) -&gt; ([a], [a])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163707"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FMList ([a], [a])
</span><a href="#local-6989586621679163705"><span class="hs-identifier hs-var">present</span></a></span><span>
</span><span id="line-461"></span><span>        </span><span class="annot"><span class="annottext">FMList ([a], [a]) -&gt; FMList ([a], [a]) -&gt; FMList ([a], [a])
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(([a], [a]) -&gt; ([a], [a]))
-&gt; FMList ([a], [a]) -&gt; FMList ([a], [a])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a], [a]) -&gt; ([a], [a])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(([a] -&gt; [a]) -&gt; ([a], [a]) -&gt; ([a], [a]))
-&gt; ([a] -&gt; [a]) -&gt; ([a], [a]) -&gt; ([a], [a])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679163707"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FMList ([a], [a])
</span><a href="#local-6989586621679163704"><span class="hs-identifier hs-var">absent</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#normalizeMod"><span class="hs-identifier hs-type">normalizeMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-464"></span><span id="normalizeMod"><span class="annot"><span class="annottext">normalizeMod :: Integer -&gt; Unipol Integer -&gt; Unipol Integer
</span><a href="Algebra.Ring.Polynomial.Factorise.html#normalizeMod"><span class="hs-identifier hs-var hs-var">normalizeMod</span></a></span></span><span> </span><span id="local-6989586621679163703"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163703"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Unipol Integer -&gt; Unipol Integer
forall b a. DecidableZero b =&gt; (a -&gt; b) -&gt; Unipol a -&gt; Unipol b
</span><span class="hs-identifier hs-var">mapCoeffUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163701"><span class="hs-identifier hs-var">half</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; (Integer -&gt; Integer) -&gt; Integer -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163703"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; (Integer -&gt; Integer) -&gt; Integer -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163701"><span class="hs-identifier hs-var">half</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163701"><span class="annot"><span class="annottext">half :: Integer
</span><a href="#local-6989586621679163701"><span class="hs-identifier hs-var hs-var">half</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679163703"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#isSquareFree"><span class="hs-identifier hs-type">isSquareFree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164213"><span class="annot"><a href="#local-6989586621679164213"><span class="hs-identifier hs-type">poly</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679164213"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCDDomain</span></span><span> </span><span class="annot"><a href="#local-6989586621679164213"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164213"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-468"></span><span id="isSquareFree"><span class="annot"><span class="annottext">isSquareFree :: poly -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Factorise.html#isSquareFree"><span class="hs-identifier hs-var hs-var">isSquareFree</span></a></span></span><span> </span><span id="local-6989586621679163700"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679163700"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679163700"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`gcd`</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; poly -&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
Ordinal (Arity poly) -&gt; poly -&gt; poly
</span><span class="hs-identifier hs-var">diff</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679163700"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">poly
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Reducibility test for univariate polynomials over finite fields.</span><span>
</span><span id="line-471"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Factorise.html#isReducible"><span class="hs-identifier hs-type">isReducible</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679163699"><span class="annot"><a href="#local-6989586621679163699"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FiniteField</span></span><span> </span><span class="annot"><a href="#local-6989586621679163699"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679163699"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="annot"><a href="#local-6989586621679163699"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-474"></span><span id="isReducible"><span class="annot"><span class="annottext">isReducible :: Unipol k -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Factorise.html#isReducible"><span class="hs-identifier hs-var hs-var">isReducible</span></a></span></span><span> </span><span id="local-6989586621679163698"><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163698"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163697"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163697"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163696"><span class="annot"><span class="annottext">divisors :: [Natural]
</span><a href="#local-6989586621679163696"><span class="hs-identifier hs-var hs-var">divisors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Prime Natural, Word) -&gt; Natural)
-&gt; [(Prime Natural, Word)] -&gt; [Natural]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prime Natural -&gt; Natural
forall a. Prime a -&gt; a
</span><span class="hs-identifier hs-var hs-var">PRIMES.unPrime</span></span><span> </span><span class="annot"><span class="annottext">(Prime Natural -&gt; Natural)
-&gt; ((Prime Natural, Word) -&gt; Prime Natural)
-&gt; (Prime Natural, Word)
-&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Prime Natural, Word) -&gt; Prime Natural
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Prime Natural, Word)] -&gt; [Natural])
-&gt; [(Prime Natural, Word)] -&gt; [Natural]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; [(Prime Natural, Word)]
forall a. UniqueFactorisation a =&gt; a -&gt; [(Prime a, Word)]
</span><span class="hs-identifier hs-var">PRIMES.factorise</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163697"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-479"></span><span>        </span><span id="local-6989586621679163694"><span class="annot"><span class="annottext">q :: Natural
</span><a href="#local-6989586621679163694"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy k -&gt; Natural
forall k (proxy :: * -&gt; *). FiniteField k =&gt; proxy k -&gt; Natural
</span><span class="hs-identifier hs-var">order</span></span><span> </span><span class="annot"><span class="annottext">(Proxy k -&gt; Natural) -&gt; Proxy k -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy k
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163699"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-480"></span><span>        </span><span id="local-6989586621679163693"><span class="annot"><span class="annottext">xqn :: Unipol k
</span><a href="#local-6989586621679163693"><span class="hs-identifier hs-var hs-var">xqn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; Unipol k -&gt; Unipol k
forall poly. Euclidean poly =&gt; poly -&gt; Natural -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Factorise.html#modPow"><span class="hs-identifier hs-var">modPow</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;x&quot; (Unipol k)
Unipol k
</span><a href="#local-6989586621679163692"><span class="hs-var">#x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163694"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163697"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163698"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-481"></span><span>              </span><span class="hs-comment">-- FIXME: Use the fast modular composition algorithm</span><span>
</span><span id="line-482"></span><span>              </span><span class="hs-comment">-- using Horner&#39;s rule</span><span>
</span><span id="line-483"></span><span>        </span><span id="local-6989586621679163691"><span class="annot"><span class="annottext">test :: Natural -&gt; Bool
</span><a href="#local-6989586621679163691"><span class="hs-identifier hs-var hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679163690"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163690"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163689"><span class="annot"><span class="annottext">b :: Unipol k
</span><a href="#local-6989586621679163689"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Natural -&gt; Unipol k -&gt; Unipol k
forall poly. Euclidean poly =&gt; poly -&gt; Natural -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Factorise.html#modPow"><span class="hs-identifier hs-var">modPow</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;x&quot; (Unipol k)
Unipol k
</span><a href="#local-6989586621679163688"><span class="hs-var">#x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163694"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163697"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679163690"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163698"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-485"></span><span>              </span><span class="hs-comment">-- FIXME: Use the fast modular composition algorithm</span><span>
</span><span id="line-486"></span><span>              </span><span class="hs-comment">-- using Horner&#39;s rule</span><span>
</span><span id="line-487"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163689"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Unipol k
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;x&quot; (Unipol k)
Unipol k
</span><a href="#local-6989586621679163687"><span class="hs-var">#x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163698"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163693"><span class="hs-identifier hs-var">xqn</span></a></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Unipol k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;x&quot; (Unipol k)
Unipol k
</span><a href="#local-6989586621679163686"><span class="hs-var">#x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Bool) -&gt; [Natural] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Bool
</span><a href="#local-6989586621679163691"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">[Natural]
</span><a href="#local-6989586621679163696"><span class="hs-identifier hs-var">divisors</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679163697"><span class="annot"><span class="annottext">n :: Natural
</span><a href="#local-6989586621679163697"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integral Int, Num Natural) =&gt; Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Natural) -&gt; Int -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol k -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol k
</span><a href="#local-6989586621679163698"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-491"></span></pre></body></html>