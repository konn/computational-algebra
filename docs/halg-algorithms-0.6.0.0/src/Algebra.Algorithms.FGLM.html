<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds, FlexibleContexts, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude, TemplateHaskell                       #-}</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Algorithms.FGLM</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier">FGLMEnv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#lMap"><span class="hs-identifier">lMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#gLex"><span class="hs-identifier">gLex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#bLex"><span class="hs-identifier">bLex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#proced"><span class="hs-identifier">proced</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>                                </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#monomial"><span class="hs-identifier">monomial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#look"><span class="hs-identifier">look</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#.%3D%3D"><span class="hs-operator">(.==)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#%40%3D%3D"><span class="hs-operator">(@==)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#image"><span class="hs-identifier">image</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#Machine"><span class="hs-identifier">Machine</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algebra.Ring.Polynomial</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.ST</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.STRef</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                 </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Num</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">recip</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^)</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">data</span><span> </span><span id="FGLMEnv"><span class="annot"><a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier hs-var">FGLMEnv</span></a></span></span><span> </span><span id="local-6989586621679375919"><span class="annot"><a href="#local-6989586621679375919"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679375918"><span class="annot"><a href="#local-6989586621679375918"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679375917"><span class="annot"><a href="#local-6989586621679375917"><span class="hs-identifier hs-type">ord</span></a></span></span><span> </span><span id="local-6989586621679375916"><span class="annot"><a href="#local-6989586621679375916"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FGLMEnv"><span class="annot"><a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier hs-var">FGLMEnv</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_lMap"><span class="annot"><span class="annottext">FGLMEnv s r ord n -&gt; OrderedPolynomial r ord n -&gt; Vector r
</span><a href="Algebra.Algorithms.FGLM.html#_lMap"><span class="hs-identifier hs-var hs-var">_lMap</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679375918"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375917"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375916"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679375918"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-17"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span id="_gLex"><span class="annot"><span class="annottext">FGLMEnv s r ord n -&gt; STRef s [OrderedPolynomial r Lex n]
</span><a href="Algebra.Algorithms.FGLM.html#_gLex"><span class="hs-identifier hs-var hs-var">_gLex</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375919"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679375918"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lex</span></span><span> </span><span class="annot"><a href="#local-6989586621679375916"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-18"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span id="_bLex"><span class="annot"><span class="annottext">FGLMEnv s r ord n -&gt; STRef s [OrderedPolynomial r ord n]
</span><a href="Algebra.Algorithms.FGLM.html#_bLex"><span class="hs-identifier hs-var hs-var">_bLex</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375919"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679375918"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375917"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375916"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-19"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span id="_proced"><span class="annot"><span class="annottext">FGLMEnv s r ord n -&gt; STRef s (Maybe (OrderedPolynomial r Lex n))
</span><a href="Algebra.Algorithms.FGLM.html#_proced"><span class="hs-identifier hs-var hs-var">_proced</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375919"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679375918"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lex</span></span><span> </span><span class="annot"><a href="#local-6989586621679375916"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span id="_monomial"><span class="annot"><span class="annottext">FGLMEnv s r ord n -&gt; STRef s (OrderedMonomial Lex n)
</span><a href="Algebra.Algorithms.FGLM.html#_monomial"><span class="hs-identifier hs-var hs-var">_monomial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375919"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OrderedMonomial</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lex</span></span><span> </span><span class="annot"><a href="#local-6989586621679375916"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>                                 </span><span class="hs-special">}</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span id="monomial"><span id="proced"><span id="bLex"><span id="gLex"><span id="lMap"><span id="local-6989586621679375916"><span id="local-6989586621679375917"><span id="local-6989586621679375918"><span id="local-6989586621679375919"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">&#39;&#39;</span><span class="hs-identifier">FGLMEnv</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">type</span><span> </span><span id="Machine"><span class="annot"><a href="Algebra.Algorithms.FGLM.html#Machine"><span class="hs-identifier hs-var">Machine</span></a></span></span><span> </span><span id="local-6989586621679375897"><span class="annot"><a href="#local-6989586621679375897"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679375896"><span class="annot"><a href="#local-6989586621679375896"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679375895"><span class="annot"><a href="#local-6989586621679375895"><span class="hs-identifier hs-type">ord</span></a></span></span><span> </span><span id="local-6989586621679375894"><span class="annot"><a href="#local-6989586621679375894"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier hs-type">FGLMEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375897"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375896"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375895"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375894"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679375897"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span id="local-6989586621679375889"><span id="local-6989586621679375890"><span id="local-6989586621679375891"><span id="local-6989586621679375892"><span id="local-6989586621679375893"><span class="annot"><a href="Algebra.Algorithms.FGLM.html#look"><span class="hs-identifier hs-type">look</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getting</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375893"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375892"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier hs-type">FGLMEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375893"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375891"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375890"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375889"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375893"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375892"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375893"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375891"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375890"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375889"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375892"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-28"></span><span id="look"><span class="annot"><span class="annottext">look :: Getting (STRef s b) (FGLMEnv s r ord n) (STRef s b)
-&gt; Machine s r ord n b
</span><a href="Algebra.Algorithms.FGLM.html#look"><span class="hs-identifier hs-var hs-var">look</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s b -&gt; Machine s r ord n b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(ST s b -&gt; Machine s r ord n b)
-&gt; (STRef s b -&gt; ST s b) -&gt; STRef s b -&gt; Machine s r ord n b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">STRef s b -&gt; ST s b
forall s a. STRef s a -&gt; ST s a
</span><span class="hs-identifier hs-var">readSTRef</span></span><span> </span><span class="annot"><span class="annottext">(STRef s b -&gt; Machine s r ord n b)
-&gt; (Getting (STRef s b) (FGLMEnv s r ord n) (STRef s b)
    -&gt; ReaderT (FGLMEnv s r ord n) (ST s) (STRef s b))
-&gt; Getting (STRef s b) (FGLMEnv s r ord n) (STRef s b)
-&gt; Machine s r ord n b
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Getting (STRef s b) (FGLMEnv s r ord n) (STRef s b)
-&gt; ReaderT (FGLMEnv s r ord n) (ST s) (STRef s b)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span id="local-6989586621679375880"><span id="local-6989586621679375881"><span id="local-6989586621679375882"><span id="local-6989586621679375883"><span class="annot"><a href="Algebra.Algorithms.FGLM.html#.%3D%3D"><span class="hs-operator hs-type">(.==)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679375883"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="#local-6989586621679375882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679375883"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679375881"><span class="hs-identifier hs-type">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getting</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375881"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375880"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679375882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375881"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375880"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375880"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375883"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679375881"><span class="hs-identifier hs-type">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-31"></span><span id="local-6989586621679375879"><span class="annot"><span class="annottext">Getting (STRef s1 a) s (STRef s1 a)
</span><a href="#local-6989586621679375879"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id=".%3D%3D"><span class="annot"><span class="annottext">.== :: Getting (STRef s1 a) s (STRef s1 a) -&gt; a -&gt; t (ST s1) ()
</span><a href="Algebra.Algorithms.FGLM.html#.%3D%3D"><span class="hs-operator hs-var hs-var">.==</span></a></span></span><span> </span><span id="local-6989586621679375878"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375878"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-32"></span><span>  </span><span id="local-6989586621679375877"><span class="annot"><span class="annottext">STRef s1 a
</span><a href="#local-6989586621679375877"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting (STRef s1 a) s (STRef s1 a) -&gt; t (ST s1) (STRef s1 a)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (STRef s1 a) s (STRef s1 a)
</span><a href="#local-6989586621679375879"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="annottext">ST s1 () -&gt; t (ST s1) ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(ST s1 () -&gt; t (ST s1) ()) -&gt; ST s1 () -&gt; t (ST s1) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STRef s1 a -&gt; a -&gt; ST s1 ()
forall s a. STRef s a -&gt; a -&gt; ST s ()
</span><span class="hs-identifier hs-var">writeSTRef</span></span><span> </span><span class="annot"><span class="annottext">STRef s1 a
</span><a href="#local-6989586621679375877"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375878"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span id="local-6989586621679375872"><span id="local-6989586621679375873"><span id="local-6989586621679375874"><span id="local-6989586621679375875"><span class="annot"><a href="Algebra.Algorithms.FGLM.html#%40%3D%3D"><span class="hs-operator hs-type">(@==)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679375875"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="#local-6989586621679375874"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679375875"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679375873"><span class="hs-identifier hs-type">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getting</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375873"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679375874"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STRef</span></span><span> </span><span class="annot"><a href="#local-6989586621679375873"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679375872"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375875"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679375873"><span class="hs-identifier hs-type">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-36"></span><span id="local-6989586621679375871"><span class="annot"><span class="annottext">Getting (STRef s1 a) s (STRef s1 a)
</span><a href="#local-6989586621679375871"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="%40%3D%3D"><span class="annot"><span class="annottext">@== :: Getting (STRef s1 a) s (STRef s1 a) -&gt; (a -&gt; a) -&gt; t (ST s1) ()
</span><a href="Algebra.Algorithms.FGLM.html#%40%3D%3D"><span class="hs-operator hs-var hs-var">@==</span></a></span></span><span> </span><span id="local-6989586621679375870"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679375870"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-37"></span><span>  </span><span id="local-6989586621679375869"><span class="annot"><span class="annottext">STRef s1 a
</span><a href="#local-6989586621679375869"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting (STRef s1 a) s (STRef s1 a) -&gt; t (ST s1) (STRef s1 a)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (STRef s1 a) s (STRef s1 a)
</span><a href="#local-6989586621679375871"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><span class="annottext">ST s1 () -&gt; t (ST s1) ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(ST s1 () -&gt; t (ST s1) ()) -&gt; ST s1 () -&gt; t (ST s1) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STRef s1 a -&gt; (a -&gt; a) -&gt; ST s1 ()
forall s a. STRef s a -&gt; (a -&gt; a) -&gt; ST s ()
</span><span class="hs-identifier hs-var">modifySTRef&#39;</span></span><span> </span><span class="annot"><span class="annottext">STRef s1 a
</span><a href="#local-6989586621679375869"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679375870"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#.%3D%3D"><span class="hs-operator hs-type">.==</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#%40%3D%3D"><span class="hs-operator hs-type">@==</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span id="local-6989586621679375863"><span id="local-6989586621679375864"><span id="local-6989586621679375865"><span id="local-6989586621679375866"><span id="local-6989586621679375867"><span class="annot"><a href="Algebra.Algorithms.FGLM.html#image"><span class="hs-identifier hs-type">image</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier hs-type">FGLMEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375867"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375866"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375865"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375864"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679375863"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679375866"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375865"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375864"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375863"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679375866"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-43"></span><span id="image"><span class="annot"><span class="annottext">image :: OrderedPolynomial r ord n -&gt; f (Vector r)
</span><a href="Algebra.Algorithms.FGLM.html#image"><span class="hs-identifier hs-var hs-var">image</span></a></span></span><span> </span><span id="local-6989586621679375862"><span class="annot"><span class="annottext">OrderedPolynomial r ord n
</span><a href="#local-6989586621679375862"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike&#39;
  (Const (Vector r))
  (FGLMEnv s r ord n)
  (OrderedPolynomial r ord n -&gt; Vector r)
-&gt; ((OrderedPolynomial r ord n -&gt; Vector r) -&gt; Vector r)
-&gt; f (Vector r)
forall s (m :: * -&gt; *) r a.
MonadReader s m =&gt;
LensLike&#39; (Const r) s a -&gt; (a -&gt; r) -&gt; m r
</span><span class="hs-identifier hs-var">views</span></span><span> </span><span class="annot"><span class="annottext">LensLike&#39;
  (Const (Vector r))
  (FGLMEnv s r ord n)
  (OrderedPolynomial r ord n -&gt; Vector r)
forall k s r (ord :: k) (n :: Nat).
Lens&#39; (FGLMEnv s r ord n) (OrderedPolynomial r ord n -&gt; Vector r)
</span><a href="Algebra.Algorithms.FGLM.html#lMap"><span class="hs-identifier hs-var">lMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(OrderedPolynomial r ord n -&gt; Vector r)
-&gt; OrderedPolynomial r ord n -&gt; Vector r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial r ord n
</span><a href="#local-6989586621679375862"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span></pre></body></html>