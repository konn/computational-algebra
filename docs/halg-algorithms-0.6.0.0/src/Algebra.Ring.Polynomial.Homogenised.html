<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin Data.Singletons.TypeNats.Presburger #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.KnownNat.Solver #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.Presburger #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.Normalise #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Ring.Polynomial.Homogenised</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier">Homogenised</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#homogenise"><span class="hs-identifier">homogenise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#unhomogenise"><span class="hs-identifier">unhomogenise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#tryHomogenise"><span class="hs-identifier">tryHomogenise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#HomogOrder"><span class="hs-identifier">HomogOrder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Algebra.Prelude.Core</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Algebra.Ring.Polynomial.Univariate</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.MonoTraversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">osum</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sized</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SV</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">gcastWith</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Natural.Lemma.Arithmetic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">succInj</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">succInj&#39;</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">newtype</span><span> </span><span id="Homogenised"><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-var">Homogenised</span></a></span></span><span> </span><span id="local-6989586621679377858"><span class="annot"><a href="#local-6989586621679377858"><span class="hs-identifier hs-type">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Homogenised"><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-var">Homogenised</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OrderedPolynomial</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377858"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MOrder</span></span><span> </span><span class="annot"><a href="#local-6989586621679377858"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arity</span></span><span> </span><span class="annot"><a href="#local-6989586621679377858"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span id="local-6989586621679377657"><span id="local-6989586621679377659"><span id="local-6989586621679377661"><span id="local-6989586621679377663"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377663"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Additive</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377663"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span id="local-6989586621679377648"><span id="local-6989586621679377650"><span id="local-6989586621679377652"><span id="local-6989586621679377655"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377655"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unital</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377655"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span id="local-6989586621679377642"><span id="local-6989586621679377646"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377646"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LeftModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377646"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span id="local-6989586621679377636"><span id="local-6989586621679377640"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377640"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RightModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377640"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span id="local-6989586621679377630"><span id="local-6989586621679377634"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377634"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LeftModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377634"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span id="local-6989586621679377625"><span id="local-6989586621679377629"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377629"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RightModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377629"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span id="local-6989586621679377618"><span id="local-6989586621679377620"><span id="local-6989586621679377622"><span id="local-6989586621679377624"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377624"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Multiplicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377624"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span id="local-6989586621679377608"><span id="local-6989586621679377610"><span id="local-6989586621679377612"><span id="local-6989586621679377616"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377616"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoidal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377616"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span id="local-6989586621679377595"><span id="local-6989586621679377597"><span id="local-6989586621679377599"><span id="local-6989586621679377601"><span id="local-6989586621679377606"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377606"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377606"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span id="local-6989586621679377593"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377593"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abelian</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377593"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span id="local-6989586621679377590"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377590"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Commutative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377590"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span id="local-6989586621679377583"><span id="local-6989586621679377585"><span id="local-6989586621679377587"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377587"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377587"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span id="local-6989586621679377578"><span id="local-6989586621679377581"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377581"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecidableZero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377581"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621679377576"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377576"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semiring</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377576"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span id="local-6989586621679377566"><span id="local-6989586621679377571"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377571"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377571"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621679377560"><span id="local-6989586621679377564"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377564"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ring</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377564"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span id="local-6989586621679377544"><span id="local-6989586621679377546"><span id="local-6989586621679377548"><span id="local-6989586621679377550"><span id="local-6989586621679377552"><span id="local-6989586621679377554"><span id="local-6989586621679377556"><span id="local-6989586621679377558"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377558"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377558"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span id="local-6989586621679377541"><span id="local-6989586621679377542"><span class="hs-keyword">instance</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377542"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679377541"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377542"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">LeftModule</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scalar</span></span><span> </span><span class="annot"><a href="#local-6989586621679377541"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377542"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679377537"><span class="annot"><span class="annottext">Scalar k
</span><a href="#local-6989586621679377537"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679377536"><span class="annot"><span class="annottext">.* :: Scalar k -&gt; Homogenised poly -&gt; Homogenised poly
</span><span class="hs-operator hs-var hs-var hs-var hs-var">.*</span></span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span id="local-6989586621679377534"><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377534"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall poly.
OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-var">Homogenised</span></a></span><span> </span><span class="annot"><span class="annottext">(OrderedPolynomial
   (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
 -&gt; Homogenised poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient
   (OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly))
 -&gt; Coefficient
      (OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly)))
-&gt; OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly)
-&gt; OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly)
forall poly.
IsPolynomial poly =&gt;
(Coefficient poly -&gt; Coefficient poly) -&gt; poly -&gt; poly
</span><span class="hs-identifier hs-var">mapCoeff&#39;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar k
</span><a href="#local-6989586621679377537"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar k -&gt; Unipol k -&gt; Unipol k
forall r m. LeftModule r m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly)
OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377534"><span class="hs-identifier hs-var">f</span></a></span></span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621679377531"><span id="local-6989586621679377532"><span class="hs-keyword">instance</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377532"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679377531"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377532"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">RightModule</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scalar</span></span><span> </span><span class="annot"><a href="#local-6989586621679377531"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377532"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span id="local-6989586621679377527"><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377527"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679377526"><span class="annot"><span class="annottext">*. :: Homogenised poly -&gt; Scalar k -&gt; Homogenised poly
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*.</span></span></span><span> </span><span id="local-6989586621679377524"><span class="annot"><span class="annottext">Scalar k
</span><a href="#local-6989586621679377524"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall poly.
OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-var">Homogenised</span></a></span><span> </span><span class="annot"><span class="annottext">(OrderedPolynomial
   (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
 -&gt; Homogenised poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient
   (OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly))
 -&gt; Coefficient
      (OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly)))
-&gt; OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly)
-&gt; OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly)
forall poly.
IsPolynomial poly =&gt;
(Coefficient poly -&gt; Coefficient poly) -&gt; poly -&gt; poly
</span><span class="hs-identifier hs-var">mapCoeff&#39;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unipol k -&gt; Scalar k -&gt; Unipol k
forall r m. RightModule r m =&gt; m -&gt; r -&gt; m
</span><span class="hs-operator hs-var">*.</span></span><span> </span><span class="annot"><span class="annottext">Scalar k
</span><a href="#local-6989586621679377524"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial (Unipol k) (MOrder poly) (Arity poly)
OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377527"><span class="hs-identifier hs-var">f</span></a></span></span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="local-6989586621679377523"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377475"><span id="local-6989586621679377477"><span id="local-6989586621679377479"><span id="local-6989586621679377481"><span id="local-6989586621679377483"><span id="local-6989586621679377485"><span id="local-6989586621679377487"><span id="local-6989586621679377489"><span id="local-6989586621679377491"><span id="local-6989586621679377493"><span id="local-6989586621679377496"><span id="local-6989586621679377498"><span id="local-6989586621679377501"><span id="local-6989586621679377503"><span id="local-6989586621679377506"><span id="local-6989586621679377509"><span id="local-6989586621679377511"><span id="local-6989586621679377513"><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsPolynomial</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Coefficient"><span class="annot"><span class="hs-identifier hs-var">Coefficient</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Arity"><span class="annot"><span class="hs-identifier hs-var">Arity</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arity</span></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679377473"><span class="annot"><span class="annottext">sArity :: proxy (Homogenised poly) -&gt; SNat (Arity (Homogenised poly))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sArity</span></span></span><span> </span><span class="annot"><span class="annottext">proxy (Homogenised poly)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SNat (Arity (Homogenised poly))
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679377470"><span class="annot"><span class="annottext">injectCoeff :: Coefficient (Homogenised poly) -&gt; Homogenised poly
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">injectCoeff</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall poly.
OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-var">Homogenised</span></a></span><span> </span><span class="annot"><span class="annottext">(OrderedPolynomial
   (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
 -&gt; Homogenised poly)
-&gt; (Coefficient poly
    -&gt; OrderedPolynomial
         (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
-&gt; Coefficient poly
-&gt; Homogenised poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Coefficient poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly
</span><span class="hs-identifier hs-var">injectCoeff</span></span><span> </span><span class="annot"><span class="annottext">(Unipol (Coefficient poly)
 -&gt; OrderedPolynomial
      (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
-&gt; (Coefficient poly -&gt; Unipol (Coefficient poly))
-&gt; Coefficient poly
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Unipol (Coefficient poly)
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly
</span><span class="hs-identifier hs-var">injectCoeff</span></span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679377467"><span class="annot"><span class="annottext">fromMonomial :: Monomial (Arity (Homogenised poly)) -&gt; Homogenised poly
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromMonomial</span></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679377465"><span id="local-6989586621679377464"><span class="annot"><a href="#local-6989586621679377464"><span class="hs-identifier hs-var">os</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">USized</span></span><span> </span><span class="annot"><a href="#local-6989586621679377465"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span id="local-6989586621679377462"><span class="annot"><a href="#local-6989586621679377462"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">(n1 :~: Arity poly)
-&gt; ((n1 ~ Arity poly) =&gt; Homogenised poly) -&gt; Homogenised poly
forall k (a :: k) (b :: k) r. (a :~: b) -&gt; ((a ~ b) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">gcastWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Succ n1 :~: Succ (Arity poly)) -&gt; n1 :~: Arity poly
forall (n :: Nat) (m :: Nat). (Succ n :~: Succ m) -&gt; n :~: m
</span><span class="hs-identifier hs-var">succInj</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Succ n1 :~: Succ (Arity poly)
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377465"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arity</span></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((n1 ~ Arity poly) =&gt; Homogenised poly) -&gt; Homogenised poly)
-&gt; ((n1 ~ Arity poly) =&gt; Homogenised poly) -&gt; Homogenised poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall poly.
OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-var">Homogenised</span></a></span><span> </span><span class="annot"><span class="annottext">(OrderedPolynomial
   (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
 -&gt; Homogenised poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity (Unipol (Coefficient poly)))
-&gt; Unipol (Coefficient poly)
forall poly. IsPolynomial poly =&gt; Monomial (Arity poly) -&gt; poly
</span><span class="hs-identifier hs-var">fromMonomial</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Sized Vector 1 Int
forall (f :: * -&gt; *) a. (CPointed f, Dom f a) =&gt; a -&gt; Sized f 1 a
</span><span class="hs-identifier hs-var">SV.singleton</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679377462"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coefficient
  (OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly -&gt; poly
</span><span class="hs-operator hs-var">!*</span></span><span> </span><span class="annot"><span class="annottext">Monomial
  (Arity
     (OrderedPolynomial
        (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
forall poly. IsPolynomial poly =&gt; Monomial (Arity poly) -&gt; poly
</span><span class="hs-identifier hs-var">fromMonomial</span></span><span> </span><span class="annot"><span class="annottext">USized n1 Int
Monomial
  (Arity
     (OrderedPolynomial
        (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
</span><a href="#local-6989586621679377464"><span class="hs-identifier hs-var">os</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromMonomial</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity (Homogenised poly))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Homogenised poly
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cannot happen!&quot;</span></span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679377457"><span class="annot"><span class="annottext">terms&#39; :: Homogenised poly
-&gt; Map
     (Monomial (Arity (Homogenised poly)))
     (Coefficient (Homogenised poly))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">terms&#39;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span id="local-6989586621679377455"><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377455"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">[(Sized Vector (Succ (Arity poly)) Int, Coefficient poly)]
-&gt; Map (Sized Vector (Succ (Arity poly)) Int) (Coefficient poly)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sized Vector (Arity poly) Int
</span><a href="#local-6989586621679377453"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">Sized Vector (Arity poly) Int
-&gt; Sized Vector 1 Int -&gt; Sized Vector (Succ (Arity poly)) Int
forall (f :: * -&gt; *) (n :: Nat) (m :: Nat) a.
(CFreeMonoid f, Dom f a) =&gt;
Sized f n a -&gt; Sized f m a -&gt; Sized f (n + m) a
</span><span class="hs-operator hs-var">SV.++</span></span><span> </span><span class="annot"><span class="annottext">Sized Vector 1 Int
</span><a href="#local-6989586621679377451"><span class="hs-identifier hs-var">mr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679377450"><span class="hs-identifier hs-var">cf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679377453"><span class="annot"><span class="annottext">Sized Vector (Arity poly) Int
</span><a href="#local-6989586621679377453"><span class="hs-identifier hs-var">ml</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377449"><span class="annot"><span class="annottext">Unipol (Coefficient poly)
</span><a href="#local-6989586621679377449"><span class="hs-identifier hs-var">fpol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map (Sized Vector (Arity poly) Int) (Unipol (Coefficient poly))
-&gt; [(Sized Vector (Arity poly) Int, Unipol (Coefficient poly))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map (Sized Vector (Arity poly) Int) (Unipol (Coefficient poly))
 -&gt; [(Sized Vector (Arity poly) Int, Unipol (Coefficient poly))])
-&gt; Map (Sized Vector (Arity poly) Int) (Unipol (Coefficient poly))
-&gt; [(Sized Vector (Arity poly) Int, Unipol (Coefficient poly))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Map
     (Monomial
        (Arity
           (OrderedPolynomial
              (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))))
     (Coefficient
        (OrderedPolynomial
           (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><span class="hs-identifier hs-var">terms&#39;</span></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377455"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-84"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679377451"><span class="annot"><span class="annottext">Sized Vector 1 Int
</span><a href="#local-6989586621679377451"><span class="hs-identifier hs-var">mr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377450"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679377450"><span class="hs-identifier hs-var">cf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map (Sized Vector 1 Int) (Coefficient poly)
-&gt; [(Sized Vector 1 Int, Coefficient poly)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map (Sized Vector 1 Int) (Coefficient poly)
 -&gt; [(Sized Vector 1 Int, Coefficient poly)])
-&gt; Map (Sized Vector 1 Int) (Coefficient poly)
-&gt; [(Sized Vector 1 Int, Coefficient poly)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Coefficient poly)
-&gt; Map
     (Monomial (Arity (Unipol (Coefficient poly))))
     (Coefficient (Unipol (Coefficient poly)))
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><span class="hs-identifier hs-var">terms&#39;</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Coefficient poly)
</span><a href="#local-6989586621679377449"><span class="hs-identifier hs-var">fpol</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679377447"><span class="annot"><span class="annottext">liftMap :: (Ordinal (Arity (Homogenised poly)) -&gt; alg)
-&gt; Homogenised poly -&gt; alg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">liftMap</span></span></span><span> </span><span id="local-6989586621679377445"><span class="annot"><span class="annottext">Ordinal (Arity (Homogenised poly)) -&gt; alg
</span><a href="#local-6989586621679377445"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span id="local-6989586621679377444"><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377444"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">SNat (1 + Arity poly) -&gt; (KnownNat (1 + Arity poly) =&gt; alg) -&gt; alg
forall (n :: Nat) r. SNat n -&gt; (KnownNat n =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withKnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SNat 1
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SNat 1 -&gt; SNat (Arity poly) -&gt; SNat (1 + Arity poly)
forall (n :: Nat) (m :: Nat). SNat n -&gt; SNat m -&gt; SNat (n + m)
</span><span class="hs-operator hs-var">%+</span></span><span> </span><span class="annot"><span class="annottext">KnownNat (Arity poly) =&gt; SNat (Arity poly)
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arity</span></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((KnownNat (1 + Arity poly) =&gt; alg) -&gt; alg)
-&gt; (KnownNat (1 + Arity poly) =&gt; alg) -&gt; alg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-88"></span><span>      </span><span class="annot"><span class="annottext">(Coefficient
   (OrderedPolynomial
      (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
 -&gt; alg -&gt; alg)
-&gt; Sized
     (Arity
        (OrderedPolynomial
           (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
     alg
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; alg
forall poly m.
(IsPolynomial poly, Ring m) =&gt;
(Coefficient poly -&gt; m -&gt; m) -&gt; Sized (Arity poly) m -&gt; poly -&gt; m
</span><span class="hs-identifier hs-var">substWith</span></span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679377440"><span class="annot"><span class="annottext">Coefficient
  (OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679377440"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679377439"><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679377439"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>            </span><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679377439"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">alg -&gt; alg -&gt; alg
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">(Ordinal 1 -&gt; alg) -&gt; Unipol (Coefficient poly) -&gt; alg
forall k r.
(Module (Scalar k) r, Monoidal k, Unital r) =&gt;
(Ordinal 1 -&gt; r) -&gt; Unipol k -&gt; r
</span><span class="hs-identifier hs-var">liftMapUnipol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">alg -&gt; Ordinal 1 -&gt; alg
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(alg -&gt; Ordinal 1 -&gt; alg) -&gt; alg -&gt; Ordinal 1 -&gt; alg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity (Homogenised poly)) -&gt; alg
</span><a href="#local-6989586621679377445"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordinal (Succ (Arity poly))
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arity</span></span><span> </span><span class="annot"><a href="#local-6989586621679377523"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coefficient
  (OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
Unipol (Coefficient poly)
</span><a href="#local-6989586621679377440"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat (Arity poly)
-&gt; (Ordinal (Arity poly) -&gt; alg) -&gt; Sized Vector (Arity poly) alg
forall (f :: * -&gt; *) (n :: Nat) a.
(CFreeMonoid f, Dom f a) =&gt;
SNat n -&gt; (Ordinal n -&gt; a) -&gt; Sized f n a
</span><span class="hs-identifier hs-var">generate</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity poly)
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span> </span><span class="annot"><span class="annottext">((Ordinal (Arity poly) -&gt; alg) -&gt; Sized Vector (Arity poly) alg)
-&gt; (Ordinal (Arity poly) -&gt; alg) -&gt; Sized Vector (Arity poly) alg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Succ (Arity poly)) -&gt; alg
Ordinal (Arity (Homogenised poly)) -&gt; alg
</span><a href="#local-6989586621679377445"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordinal (Succ (Arity poly)) -&gt; alg)
-&gt; (Ordinal (Arity poly) -&gt; Ordinal (Succ (Arity poly)))
-&gt; Ordinal (Arity poly)
-&gt; alg
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; Ordinal (Succ (Arity poly))
forall (n :: Nat) (m :: Nat). (n &lt;= m) =&gt; Ordinal n -&gt; Ordinal m
</span><span class="hs-identifier hs-var">inclusion</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377444"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">type</span><span> </span><span id="HomogOrder"><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#HomogOrder"><span class="hs-identifier hs-var">HomogOrder</span></a></span></span><span> </span><span id="local-6989586621679377432"><span class="annot"><a href="#local-6989586621679377432"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679377431"><span class="annot"><a href="#local-6989586621679377431"><span class="hs-identifier hs-type">ord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProductOrder</span></span><span> </span><span class="annot"><a href="#local-6989586621679377432"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679377431"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lex</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span id="local-6989586621679377428"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377398"><span id="local-6989586621679377400"><span id="local-6989586621679377402"><span id="local-6989586621679377404"><span id="local-6989586621679377406"><span id="local-6989586621679377408"><span id="local-6989586621679377410"><span id="local-6989586621679377412"><span id="local-6989586621679377414"><span id="local-6989586621679377417"><span id="local-6989586621679377419"><span id="local-6989586621679377422"><span id="local-6989586621679377424"><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377428"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377428"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="MOrder"><span class="annot"><span class="hs-identifier hs-var">MOrder</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377428"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#HomogOrder"><span class="hs-identifier hs-type">HomogOrder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arity</span></span><span> </span><span class="annot"><a href="#local-6989586621679377428"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MOrder</span></span><span> </span><span class="annot"><a href="#local-6989586621679377428"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679377396"><span class="annot"><span class="annottext">leadingTerm :: Homogenised poly
-&gt; (Coefficient (Homogenised poly),
    OrderedMonomial
      (MOrder (Homogenised poly)) (Arity (Homogenised poly)))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">leadingTerm</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span id="local-6989586621679377394"><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377394"><span class="hs-identifier hs-var">poly</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679377393"><span class="annot"><span class="annottext">Unipol (Coefficient poly)
</span><a href="#local-6989586621679377393"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377392"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377392"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; (Coefficient
      (OrderedPolynomial
         (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)),
    OrderedMonomial
      (MOrder
         (OrderedPolynomial
            (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
      (Arity
         (OrderedPolynomial
            (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><span class="hs-identifier hs-var">leadingTerm</span></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377394"><span class="hs-identifier hs-var">poly</span></a></span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679377391"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679377391"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377390"><span class="annot"><span class="annottext">OrderedMonomial Grevlex 1
</span><a href="#local-6989586621679377390"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol (Coefficient poly)
-&gt; (Coefficient (Unipol (Coefficient poly)),
    OrderedMonomial
      (MOrder (Unipol (Coefficient poly)))
      (Arity (Unipol (Coefficient poly))))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><span class="hs-identifier hs-var">leadingTerm</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Coefficient poly)
</span><a href="#local-6989586621679377393"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-102"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly
Coefficient (Homogenised poly)
</span><a href="#local-6989586621679377391"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly + 1)
-&gt; OrderedMonomial
     (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1)
forall k (ordering :: k) (n :: Nat).
Monomial n -&gt; OrderedMonomial ordering n
</span><span class="hs-identifier hs-var">OrderedMonomial</span></span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly + 1)
 -&gt; OrderedMonomial
      (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1))
-&gt; Monomial (Arity poly + 1)
-&gt; OrderedMonomial
     (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Monomial (Arity poly)
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><span class="hs-identifier hs-var hs-var">getMonomial</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377392"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly)
-&gt; Sized Vector 1 Int -&gt; Monomial (Arity poly + 1)
forall (f :: * -&gt; *) (n :: Nat) (m :: Nat) a.
(CFreeMonoid f, Dom f a) =&gt;
Sized f n a -&gt; Sized f m a -&gt; Sized f (n + m) a
</span><span class="hs-operator hs-var">SV.++</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial Grevlex 1 -&gt; Sized Vector 1 Int
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><span class="hs-identifier hs-var hs-var">getMonomial</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial Grevlex 1
</span><a href="#local-6989586621679377390"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">leadingTerm</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679377387"><span class="annot"><span class="annottext">splitLeadingTerm :: Homogenised poly
-&gt; ((Coefficient (Homogenised poly),
     OrderedMonomial
       (MOrder (Homogenised poly)) (Arity (Homogenised poly))),
    Homogenised poly)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">splitLeadingTerm</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span id="local-6989586621679377385"><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377385"><span class="hs-identifier hs-var">poly</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679377384"><span class="annot"><span class="annottext">Unipol (Coefficient poly)
</span><a href="#local-6989586621679377384"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377383"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377383"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377382"><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377382"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; ((Coefficient
       (OrderedPolynomial
          (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)),
     OrderedMonomial
       (MOrder
          (OrderedPolynomial
             (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
       (Arity
          (OrderedPolynomial
             (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))),
    OrderedPolynomial
      (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
</span><span class="hs-identifier hs-var">splitLeadingTerm</span></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377385"><span class="hs-identifier hs-var">poly</span></a></span><span>
</span><span id="line-106"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679377381"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679377381"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377380"><span class="annot"><span class="annottext">OrderedMonomial Grevlex 1
</span><a href="#local-6989586621679377380"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377379"><span class="annot"><span class="annottext">Unipol (Coefficient poly)
</span><a href="#local-6989586621679377379"><span class="hs-identifier hs-var">grest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unipol (Coefficient poly)
-&gt; ((Coefficient (Unipol (Coefficient poly)),
     OrderedMonomial
       (MOrder (Unipol (Coefficient poly)))
       (Arity (Unipol (Coefficient poly)))),
    Unipol (Coefficient poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
</span><span class="hs-identifier hs-var">splitLeadingTerm</span></span><span> </span><span class="annot"><span class="annottext">Unipol (Coefficient poly)
</span><a href="#local-6989586621679377384"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-107"></span><span>        </span><span id="local-6989586621679377378"><span class="annot"><span class="annottext">g :: OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377378"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient
   (OrderedPolynomial
      (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)),
 OrderedMonomial
   (MOrder
      (OrderedPolynomial
         (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
   (Arity
      (OrderedPolynomial
         (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))))
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><span class="hs-identifier hs-var">toPolynomial</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient
  (OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
Unipol (Coefficient poly)
</span><a href="#local-6989586621679377379"><span class="hs-identifier hs-var">grest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
OrderedMonomial
  (MOrder
     (OrderedPolynomial
        (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
  (Arity
     (OrderedPolynomial
        (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
</span><a href="#local-6989586621679377383"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377382"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-108"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly
Coefficient (Homogenised poly)
</span><a href="#local-6989586621679377381"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly + 1)
-&gt; OrderedMonomial
     (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1)
forall k (ordering :: k) (n :: Nat).
Monomial n -&gt; OrderedMonomial ordering n
</span><span class="hs-identifier hs-var">OrderedMonomial</span></span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly + 1)
 -&gt; OrderedMonomial
      (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1))
-&gt; Monomial (Arity poly + 1)
-&gt; OrderedMonomial
     (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Monomial (Arity poly)
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><span class="hs-identifier hs-var hs-var">getMonomial</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377383"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly)
-&gt; Sized Vector 1 Int -&gt; Monomial (Arity poly + 1)
forall (f :: * -&gt; *) (n :: Nat) (m :: Nat) a.
(CFreeMonoid f, Dom f a) =&gt;
Sized f n a -&gt; Sized f m a -&gt; Sized f (n + m) a
</span><span class="hs-operator hs-var">SV.++</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial Grevlex 1 -&gt; Sized Vector 1 Int
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><span class="hs-identifier hs-var hs-var">getMonomial</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial Grevlex 1
</span><a href="#local-6989586621679377380"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall poly.
OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-var">Homogenised</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377378"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">splitLeadingTerm</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679377375"><span class="hs-keyword">instance</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679377370"><span id="local-6989586621679377372"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377375"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrettyCoeff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377375"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377375"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679377368"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Homogenised poly -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sized (Arity (Homogenised poly)) [Char]
-&gt; Int -&gt; Homogenised poly -&gt; ShowS
forall poly.
(IsOrderedPolynomial poly, PrettyCoeff (Coefficient poly)) =&gt;
Sized (Arity poly) [Char] -&gt; Int -&gt; poly -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPolynomialWith</span></span><span> </span><span class="annot"><span class="annottext">(Sized (Arity (Homogenised poly)) [Char]
 -&gt; Int -&gt; Homogenised poly -&gt; ShowS)
-&gt; Sized (Arity (Homogenised poly)) [Char]
-&gt; Int
-&gt; Homogenised poly
-&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity poly + 1)
-&gt; (Ordinal (Arity poly + 1) -&gt; [Char])
-&gt; Sized Vector (Arity poly + 1) [Char]
forall (f :: * -&gt; *) (n :: Nat) a.
(CFreeMonoid f, Dom f a) =&gt;
SNat n -&gt; (Ordinal n -&gt; a) -&gt; Sized f n a
</span><span class="hs-identifier hs-var">generate</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity poly + 1)
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679377365"><span class="annot"><span class="annottext">Ordinal (Arity poly + 1)
</span><a href="#local-6989586621679377365"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;X_&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall w. Monoid w =&gt; w -&gt; w -&gt; w
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordinal (Arity poly + 1) -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly + 1)
</span><a href="#local-6989586621679377365"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679377361"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377361"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ZeroProductSemiring</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377361"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679377357"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377357"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377357"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377357"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621679377354"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377351"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377354"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377354"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PID</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377354"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679377349"><span class="hs-keyword">instance</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679377342"><span id="local-6989586621679377344"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377349"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377349"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377349"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679377340"><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377340"><span class="hs-identifier hs-var">f0</span></a></span></span><span> </span><span id="local-6989586621679377339"><span class="annot"><span class="annottext">divide :: Homogenised poly
-&gt; Homogenised poly -&gt; (Homogenised poly, Homogenised poly)
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`divide`</span></span></span><span> </span><span id="local-6989586621679377337"><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377337"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Homogenised poly
-&gt; Homogenised poly -&gt; (Homogenised poly, Homogenised poly)
</span><a href="#local-6989586621679377336"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377340"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>      </span><span id="local-6989586621679377334"><span class="annot"><span class="annottext">lm :: OrderedMonomial
  (MOrder (Homogenised poly)) (Arity (Homogenised poly))
</span><a href="#local-6989586621679377334"><span class="hs-identifier hs-var hs-var">lm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Homogenised poly
-&gt; OrderedMonomial
     (MOrder (Homogenised poly)) (Arity (Homogenised poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><span class="hs-identifier hs-var">leadingMonomial</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377337"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-130"></span><span>      </span><span id="local-6989586621679377336"><span class="annot"><span class="annottext">step :: Homogenised poly
-&gt; Homogenised poly -&gt; (Homogenised poly, Homogenised poly)
</span><a href="#local-6989586621679377336"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679377332"><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377332"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679377331"><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377331"><span class="hs-identifier hs-var">quo</span></a></span></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377332"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377331"><span class="hs-identifier hs-var">quo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377332"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OrderedMonomial
  (MOrder (Homogenised poly)) (Arity (Homogenised poly))
OrderedMonomial
  (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1)
</span><a href="#local-6989586621679377334"><span class="hs-identifier hs-var">lm</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial
  (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1)
-&gt; OrderedMonomial
     (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1)
-&gt; Bool
forall k (n :: Nat) (ord :: k).
KnownNat n =&gt;
OrderedMonomial ord n -&gt; OrderedMonomial ord n -&gt; Bool
</span><span class="hs-operator hs-var">`divs`</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
-&gt; OrderedMonomial
     (MOrder (Homogenised poly)) (Arity (Homogenised poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><span class="hs-identifier hs-var">leadingMonomial</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377332"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679377328"><span class="annot"><span class="annottext">q :: Homogenised poly
</span><a href="#local-6989586621679377328"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient (Homogenised poly),
 OrderedMonomial
   (MOrder (Homogenised poly)) (Arity (Homogenised poly)))
-&gt; Homogenised poly
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><span class="hs-identifier hs-var">toPolynomial</span></span><span> </span><span class="annot"><span class="annottext">((Coefficient (Homogenised poly),
  OrderedMonomial
    (MOrder (Homogenised poly)) (Arity (Homogenised poly)))
 -&gt; Homogenised poly)
-&gt; (Coefficient (Homogenised poly),
    OrderedMonomial
      (MOrder (Homogenised poly)) (Arity (Homogenised poly)))
-&gt; Homogenised poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
-&gt; (Coefficient (Homogenised poly),
    OrderedMonomial
      (MOrder (Homogenised poly)) (Arity (Homogenised poly)))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><span class="hs-identifier hs-var">leadingTerm</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377332"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly,
 OrderedMonomial
   (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1))
-&gt; (Coefficient poly,
    OrderedMonomial
      (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1))
-&gt; (Coefficient poly,
    OrderedMonomial
      (HomogOrder (Arity poly) (MOrder poly)) (Arity poly + 1))
forall k (n :: Nat) r (ord :: k).
(KnownNat n, Field r) =&gt;
(r, OrderedMonomial ord n)
-&gt; (r, OrderedMonomial ord n) -&gt; (r, OrderedMonomial ord n)
</span><span class="hs-operator hs-var">`tryDiv`</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
-&gt; (Coefficient (Homogenised poly),
    OrderedMonomial
      (MOrder (Homogenised poly)) (Arity (Homogenised poly)))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><span class="hs-identifier hs-var">leadingTerm</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377337"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-134"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Homogenised poly
-&gt; Homogenised poly -&gt; (Homogenised poly, Homogenised poly)
</span><a href="#local-6989586621679377336"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377332"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Homogenised poly -&gt; Homogenised poly
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377328"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Homogenised poly -&gt; Homogenised poly
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377337"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377331"><span class="hs-identifier hs-var">quo</span></a></span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Homogenised poly -&gt; Homogenised poly
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377328"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377331"><span class="hs-identifier hs-var">quo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377332"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679377325"><span class="annot"><span class="annottext">degree :: Homogenised poly -&gt; Maybe Natural
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">degree</span></span></span><span> </span><span id="local-6989586621679377323"><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377323"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377323"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Natural
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Maybe Natural
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Maybe Natural) -&gt; Natural -&gt; Maybe Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Natural) -&gt; Int -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">Homogenised poly
</span><a href="#local-6989586621679377323"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679377321"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377315"><span id="local-6989586621679377317"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377321"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377321"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntegralDomain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377321"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span id="local-6989586621679377313"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377304"><span id="local-6989586621679377306"><span id="local-6989586621679377308"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377313"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377313"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCDDomain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377313"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679377302"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377302"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377302"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnitNormalForm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377302"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679377297"><span class="annot"><span class="annottext">splitUnit :: Homogenised poly -&gt; (Homogenised poly, Homogenised poly)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">splitUnit</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; (Homogenised poly, Homogenised poly)
forall r poly.
(UnitNormalForm r, Coefficient poly ~ r,
 IsOrderedPolynomial poly) =&gt;
poly -&gt; (poly, poly)
</span><span class="hs-identifier hs-var">splitUnitDefault</span></span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679377294"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377289"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377294"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377294"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecidableUnits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377294"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679377287"><span class="annot"><span class="annottext">recipUnit :: Homogenised poly -&gt; Maybe (Homogenised poly)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">recipUnit</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Maybe (Homogenised poly)
forall r poly.
(DecidableUnits r, Coefficient poly ~ r, IsPolynomial poly) =&gt;
poly -&gt; Maybe poly
</span><span class="hs-identifier hs-var">recipUnitDefault</span></span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621679377284"><span class="annot"><span class="annottext">isUnit :: Homogenised poly -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">isUnit</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Bool
forall r poly.
(DecidableUnits r, Coefficient poly ~ r, IsPolynomial poly) =&gt;
poly -&gt; Bool
</span><span class="hs-identifier hs-var">isUnitDefault</span></span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621679377281"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Coefficient</span></span><span> </span><span class="annot"><a href="#local-6989586621679377281"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377281"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecidableAssociates</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377281"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679377277"><span class="annot"><span class="annottext">isAssociate :: Homogenised poly -&gt; Homogenised poly -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">isAssociate</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Homogenised poly -&gt; Bool
forall r poly.
(UnitNormalForm r, Coefficient poly ~ r,
 IsOrderedPolynomial poly) =&gt;
poly -&gt; poly -&gt; Bool
</span><span class="hs-identifier hs-var">isAssociateDefault</span></span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span id="local-6989586621679377673"><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#homogenise"><span class="hs-identifier hs-type">homogenise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377673"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377673"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377673"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-156"></span><span id="homogenise"><span class="annot"><span class="annottext">homogenise :: poly -&gt; Homogenised poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#homogenise"><span class="hs-identifier hs-var hs-var">homogenise</span></a></span></span><span> </span><span id="local-6989586621679377274"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377274"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679377273"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679377273"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377274"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-158"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall poly.
OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-var">Homogenised</span></a></span><span> </span><span class="annot"><span class="annottext">(OrderedPolynomial
   (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
 -&gt; Homogenised poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; Homogenised poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">Map
  (OrderedMonomial
     (MOrder
        (OrderedPolynomial
           (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
     (Arity
        (OrderedPolynomial
           (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))))
  (Coefficient
     (OrderedPolynomial
        (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
Map (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; poly
</span><span class="hs-identifier hs-var">polynomial</span></span><span> </span><span class="annot"><span class="annottext">(Map
   (OrderedMonomial
      (MOrder
         (OrderedPolynomial
            (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
      (Arity
         (OrderedPolynomial
            (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))))
   (Coefficient
      (OrderedPolynomial
         (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
 -&gt; OrderedPolynomial
      (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))
-&gt; Map
     (OrderedMonomial
        (MOrder
           (OrderedPolynomial
              (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
        (Arity
           (OrderedPolynomial
              (Unipol (Coefficient poly)) (MOrder poly) (Arity poly))))
     (Coefficient
        (OrderedPolynomial
           (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)))
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-160"></span><span>          </span><span class="annot"><span class="annottext">(OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; Coefficient poly -&gt; Unipol (Coefficient poly))
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly))
     (Unipol (Coefficient poly))
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.mapWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679377270"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377270"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679377269"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679377269"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Coefficient (Unipol (Coefficient poly)),
 OrderedMonomial
   (MOrder (Unipol (Coefficient poly)))
   (Arity (Unipol (Coefficient poly))))
-&gt; Unipol (Coefficient poly)
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><span class="hs-identifier hs-var">toPolynomial</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly
Coefficient (Unipol (Coefficient poly))
</span><a href="#local-6989586621679377269"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Sized Vector 1 Int -&gt; OrderedMonomial Grevlex 1
forall k (ordering :: k) (n :: Nat).
Monomial n -&gt; OrderedMonomial ordering n
</span><span class="hs-identifier hs-var">OrderedMonomial</span></span><span> </span><span class="annot"><span class="annottext">(Sized Vector 1 Int -&gt; OrderedMonomial Grevlex 1)
-&gt; Sized Vector 1 Int -&gt; OrderedMonomial Grevlex 1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Sized Vector 1 Int
forall (f :: * -&gt; *) a. (CPointed f, Dom f a) =&gt; a -&gt; Sized f 1 a
</span><span class="hs-identifier hs-var">SV.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679377273"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Int
forall k (ord :: k) (n :: Nat). OrderedMonomial ord n -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377270"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map
   (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
 -&gt; Map
      (OrderedMonomial (MOrder poly) (Arity poly))
      (Unipol (Coefficient poly)))
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly))
     (Unipol (Coefficient poly))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-161"></span><span>            </span><span class="annot"><span class="annottext">poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
</span><span class="hs-identifier hs-var">terms</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377274"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span id="local-6989586621679377266"><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#unhomogenise"><span class="hs-identifier hs-type">unhomogenise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377266"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377266"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377266"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-164"></span><span id="unhomogenise"><span class="annot"><span class="annottext">unhomogenise :: Homogenised poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#unhomogenise"><span class="hs-identifier hs-var hs-var">unhomogenise</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span id="local-6989586621679377265"><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377265"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="annottext">OrderedPolynomial (Coefficient poly) (MOrder poly) (Arity poly)
-&gt; poly
forall poly poly&#39;.
(IsOrderedPolynomial poly, IsOrderedPolynomial poly&#39;,
 Coefficient poly ~ Coefficient poly&#39;, MOrder poly ~ MOrder poly&#39;,
 Arity poly ~ Arity poly&#39;) =&gt;
poly -&gt; poly&#39;
</span><span class="hs-identifier hs-var">convertPolynomial</span></span><span> </span><span class="annot"><span class="annottext">(OrderedPolynomial (Coefficient poly) (MOrder poly) (Arity poly)
 -&gt; poly)
-&gt; OrderedPolynomial (Coefficient poly) (MOrder poly) (Arity poly)
-&gt; poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">(Unipol (Coefficient poly) -&gt; Coefficient poly)
-&gt; OrderedPolynomial
     (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
-&gt; OrderedPolynomial (Coefficient poly) (MOrder poly) (Arity poly)
forall (n :: Nat) b ord a.
(KnownNat n, CoeffRing b, IsMonomialOrder n ord) =&gt;
(a -&gt; b) -&gt; OrderedPolynomial a ord n -&gt; OrderedPolynomial b ord n
</span><span class="hs-identifier hs-var">mapCoeff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Coefficient (Unipol (Coefficient poly))
 -&gt; Coefficient poly -&gt; Coefficient poly)
-&gt; Sized (Arity (Unipol (Coefficient poly))) (Coefficient poly)
-&gt; Unipol (Coefficient poly)
-&gt; Coefficient poly
forall poly m.
(IsPolynomial poly, Ring m) =&gt;
(Coefficient poly -&gt; m -&gt; m) -&gt; Sized (Arity poly) m -&gt; poly -&gt; m
</span><span class="hs-identifier hs-var">substWith</span></span><span> </span><span class="annot"><span class="annottext">Coefficient (Unipol (Coefficient poly))
-&gt; Coefficient poly -&gt; Coefficient poly
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly -&gt; Sized Vector 1 (Coefficient poly)
forall (f :: * -&gt; *) a. (CPointed f, Dom f a) =&gt; a -&gt; Sized f 1 a
</span><span class="hs-identifier hs-var">SV.singleton</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial
  (Unipol (Coefficient poly)) (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679377265"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span id="local-6989586621679377676"><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#isHomogeneous"><span class="hs-identifier hs-type">isHomogeneous</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377676"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><a href="#local-6989586621679377676"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-172"></span><span id="isHomogeneous"><span class="annot"><span class="annottext">isHomogeneous :: poly -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#isHomogeneous"><span class="hs-identifier hs-var hs-var">isHomogeneous</span></a></span></span><span> </span><span id="local-6989586621679377260"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377260"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679377259"><span class="annot"><span class="annottext">degs :: [Int]
</span><a href="#local-6989586621679377259"><span class="hs-identifier hs-var hs-var">degs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly) -&gt; Int) -&gt; [Monomial (Arity poly)] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; Int
forall mono.
(MonoFoldable mono, Num (Element mono)) =&gt;
mono -&gt; Element mono
</span><span class="hs-identifier hs-var">osum</span></span><span> </span><span class="annot"><span class="annottext">([Monomial (Arity poly)] -&gt; [Int])
-&gt; [Monomial (Arity poly)] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashSet (Monomial (Arity poly)) -&gt; [Monomial (Arity poly)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(HashSet (Monomial (Arity poly)) -&gt; [Monomial (Arity poly)])
-&gt; HashSet (Monomial (Arity poly)) -&gt; [Monomial (Arity poly)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; HashSet (Monomial (Arity poly))
forall poly.
IsPolynomial poly =&gt;
poly -&gt; HashSet (Monomial (Arity poly))
</span><span class="hs-identifier hs-var">monomials</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377260"><span class="hs-identifier hs-var">poly</span></a></span><span>
</span><span id="line-174"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Bool) -&gt; [Int] -&gt; [Int] -&gt; [Bool]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679377259"><span class="hs-identifier hs-var">degs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Int]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679377259"><span class="hs-identifier hs-var">degs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span id="local-6989586621679377253"><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#tryHomogenise"><span class="hs-identifier hs-type">tryHomogenise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679377253"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377253"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679377253"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Homogenised.html#Homogenised"><span class="hs-identifier hs-type">Homogenised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377253"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-177"></span><span id="tryHomogenise"><span class="annot"><span class="annottext">tryHomogenise :: poly -&gt; Either poly (Homogenised poly)
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#tryHomogenise"><span class="hs-identifier hs-var hs-var">tryHomogenise</span></a></span></span><span> </span><span id="local-6989586621679377252"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377252"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Bool
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#isHomogeneous"><span class="hs-identifier hs-var">isHomogeneous</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377252"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Either poly (Homogenised poly)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377252"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Homogenised poly -&gt; Either poly (Homogenised poly)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Homogenised poly -&gt; Either poly (Homogenised poly))
-&gt; Homogenised poly -&gt; Either poly (Homogenised poly)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Homogenised poly
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Homogenised poly
</span><a href="Algebra.Ring.Polynomial.Homogenised.html#homogenise"><span class="hs-identifier hs-var">homogenise</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679377252"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-180"></span></pre></body></html>