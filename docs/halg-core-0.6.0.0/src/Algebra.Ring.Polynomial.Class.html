<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns, ConstraintKinds, DataKinds, ExplicitNamespaces  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts, FlexibleInstances, GADTs                    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LiberalTypeSynonyms, MultiParamTypeClasses, NoImplicitPrelude #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ParallelListComp, PolyKinds, RankNTypes, ScopedTypeVariables  #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies, TypeOperators, UndecidableInstances             #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin Data.Type.Natural.Presburger.MinMaxSolver #-}</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- | This module provides abstract classes for finitary polynomial types.</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Ring.Polynomial.Class</span><span>
</span><span id="line-10"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier">IsPolynomial</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier">IsOrderedPolynomial</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Term"><span class="hs-identifier">Term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#OMonom"><span class="hs-identifier">OMonom</span></a></span><span>
</span><span id="line-12"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#substCoeff"><span class="hs-identifier">substCoeff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#liftMapCoeff"><span class="hs-identifier">liftMapCoeff</span></a></span><span>
</span><span id="line-13"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#CoeffRing"><span class="hs-identifier">CoeffRing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#oneNorm"><span class="hs-identifier">oneNorm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#maxNorm"><span class="hs-identifier">maxNorm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#monoize"><span class="hs-identifier">monoize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sPolynomial"><span class="hs-identifier">sPolynomial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#pDivModPoly"><span class="hs-identifier">pDivModPoly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#content"><span class="hs-identifier">content</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#pp"><span class="hs-identifier">pp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVars"><span class="hs-identifier">injectVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVarsAtEnd"><span class="hs-identifier">injectVarsAtEnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVarsOffset"><span class="hs-identifier">injectVarsOffset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#vars"><span class="hs-identifier">vars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier">PrettyCoeff</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier">ShowSCoeff</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier">showsCoeffAsTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier">showsCoeffWithOp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith"><span class="hs-identifier">showsPolynomialWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith%27"><span class="hs-identifier">showsPolynomialWith&#39;</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showPolynomialWith"><span class="hs-identifier">showPolynomialWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showPolynomialWith%27"><span class="hs-identifier">showPolynomialWith&#39;</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Polynomial division</span></span><span>
</span><span id="line-21"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-identifier">divModPolynomial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divPolynomial"><span class="hs-identifier">divPolynomial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#modPolynomial"><span class="hs-identifier">modPolynomial</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Conversion between polynomial types</span></span><span>
</span><span id="line-23"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial"><span class="hs-identifier">convertPolynomial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial%27"><span class="hs-identifier">convertPolynomial&#39;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapPolynomial"><span class="hs-identifier">mapPolynomial</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Default instances</span></span><span>
</span><span id="line-25"></span><span>         </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#isUnitDefault"><span class="hs-identifier">isUnitDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#recipUnitDefault"><span class="hs-identifier">recipUnitDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#isAssociateDefault"><span class="hs-identifier">isAssociateDefault</span></a></span><span>
</span><span id="line-26"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#splitUnitDefault"><span class="hs-identifier">splitUnitDefault</span></a></span><span>
</span><span id="line-27"></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Algebra.Internal.html"><span class="hs-identifier">Algebra.Internal</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Algebra.Normed.html"><span class="hs-identifier">Algebra.Normed</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html"><span class="hs-identifier">Algebra.Ring.Polynomial.Monomial</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Algebra.Scalar.html"><span class="hs-identifier">Algebra.Scalar</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">AlgebraicPrelude</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Iso&#39;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">folded</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ifoldMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">iso</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                                                   </span><span class="annot"><span class="hs-identifier">ix</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maximumOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(%~)</span></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>                                                   </span><span class="annot"><span class="hs-identifier">_Wrapped</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">First</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.MonoTraversable</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sized</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vector.Instances</span></span><span>            </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Algebra.Complex</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NA</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Field.Fraction</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NA</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Ring.Class</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NA</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Natural.Lemma.Order</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lneqSuccLeq</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">leqTrans</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lneqToLT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">minusPlus</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">plusMonotoneR</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Natural.Lemma.Arithmetic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">plusSuccR</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%2A%3C"><span class="hs-operator hs-type">*&lt;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%3E%2A"><span class="hs-operator hs-type">&gt;*</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%2A%7C%3C"><span class="hs-operator hs-type">*|&lt;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%3E%7C%2A"><span class="hs-operator hs-type">&gt;|*</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%21%2A"><span class="hs-operator hs-type">!*</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Constraint synonym for rings that can be used as polynomial coefficient.</span><span>
</span><span id="line-60"></span><span class="hs-keyword">class</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecidableZero</span></span><span> </span><span class="annot"><a href="#local-6989586621679382054"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ring</span></span><span> </span><span class="annot"><a href="#local-6989586621679382054"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Commutative</span></span><span> </span><span class="annot"><a href="#local-6989586621679382054"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679382054"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Module</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382054"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382054"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="CoeffRing"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#CoeffRing"><span class="hs-identifier hs-var">CoeffRing</span></a></span></span><span> </span><span id="local-6989586621679382054"><span class="annot"><a href="#local-6989586621679382054"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-61"></span><span id="local-6989586621679381639"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecidableZero</span></span><span> </span><span class="annot"><a href="#local-6989586621679381639"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ring</span></span><span> </span><span class="annot"><a href="#local-6989586621679381639"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Commutative</span></span><span> </span><span class="annot"><a href="#local-6989586621679381639"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679381639"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#CoeffRing"><span class="hs-identifier hs-type">CoeffRing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381639"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Polynomial in terms of free associative commutative algebra generated</span><span>
</span><span id="line-64"></span><span class="hs-comment">--   by n-elements.</span><span>
</span><span id="line-65"></span><span class="hs-comment">--   To effectively compute all terms, we need @&#39;monomials&#39;@ in addition to</span><span>
</span><span id="line-66"></span><span class="hs-comment">--   universality of free object.</span><span>
</span><span id="line-67"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#CoeffRing"><span class="hs-identifier hs-type">CoeffRing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecidableZero</span></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Module</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ring</span></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Commutative</span></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>   </span><span class="hs-glyph">=&gt;</span><span> </span><span id="IsPolynomial"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-var">IsPolynomial</span></a></span></span><span> </span><span id="local-6989586621679382053"><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-pragma hs-type">liftMap</span></a></span><span> </span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#monomials"><span class="hs-pragma hs-type">monomials</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-pragma hs-type">terms&#39;</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-pragma hs-type">sArity</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sArity%27"><span class="hs-pragma hs-type">sArity&#39;</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#fromMonomial"><span class="hs-pragma hs-type">fromMonomial</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial%27"><span class="hs-pragma hs-type">toPolynomial&#39;</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#polynomial%27"><span class="hs-pragma hs-type">polynomial&#39;</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-comment">-- | Coefficient ring of polynomial type.</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Coefficient"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-var">Coefficient</span></a></span></span><span> </span><span id="local-6989586621679382053"><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- | Arity of polynomial type.</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Arity"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-var">Arity</span></a></span></span><span> </span><span id="local-6989586621679382053"><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">-- | Universal mapping for free algebra.</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">--   This corresponds to the algebraic substitution operation.</span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679382024"><span id="liftMap"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-identifier hs-type">liftMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Module</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679382024"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ring</span></span><span> </span><span class="annot"><a href="#local-6989586621679382024"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Commutative</span></span><span> </span><span class="annot"><a href="#local-6989586621679382024"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382024"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382024"><span class="hs-identifier hs-type">alg</span></a></span></span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679381624"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-identifier hs-var hs-var">liftMap</span></a></span><span> </span><span id="local-6989586621679381623"><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; alg
</span><a href="#local-6989586621679381623"><span class="hs-identifier hs-var">mor</span></a></span></span><span> </span><span id="local-6989586621679381622"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381622"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">[alg] -&gt; alg
forall (f :: * -&gt; *) m. (Foldable f, Monoidal m) =&gt; f m -&gt; m
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Scalar (Coefficient poly)
forall r. r -&gt; Scalar r
</span><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381619"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar (Coefficient poly) -&gt; alg -&gt; alg
forall r m. LeftModule r m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*</span></span><span> </span><span class="annot"><span class="annottext">[alg] -&gt; alg
forall (f :: * -&gt; *) m. (Foldable f, Monoidal m) =&gt; f m -&gt; m
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Scalar (Coefficient poly)
forall r. r -&gt; Scalar r
</span><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coefficient poly
forall r. Ring r =&gt; Integer -&gt; r
</span><span class="hs-identifier hs-var">fromInteger&#39;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">P.fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381616"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Scalar (Coefficient poly) -&gt; alg -&gt; alg
forall r m. LeftModule r m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; alg
</span><a href="#local-6989586621679381623"><span class="hs-identifier hs-var">mor</span></a></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><a href="#local-6989586621679381615"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-82"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679381616"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381616"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; [Element (Monomial (Arity poly))]
forall mono. MonoFoldable mono =&gt; mono -&gt; [Element mono]
</span><span class="hs-identifier hs-var">otoList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381613"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679381615"><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><a href="#local-6989586621679381615"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SNat (Arity poly) -&gt; [Ordinal (Arity poly)]
forall (n :: Nat). SNat n -&gt; [Ordinal n]
</span><span class="hs-identifier hs-var">enumOrdinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe poly -&gt; SNat (Arity poly)
forall poly (proxy :: * -&gt; *).
IsPolynomial poly =&gt;
proxy poly -&gt; SNat (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-identifier hs-var">sArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe poly
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381613"><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381613"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381619"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381619"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; [(Monomial (Arity poly), Coefficient poly)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381622"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-pragma hs-type">liftMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">-- | A variant of @&#39;liftMap&#39;@, each value is given by @&#39;Sized&#39;@.</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679381886"><span id="subst"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#subst"><span class="hs-identifier hs-type">subst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ring</span></span><span> </span><span class="annot"><a href="#local-6989586621679381886"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Commutative</span></span><span> </span><span class="annot"><a href="#local-6989586621679381886"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Module</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679381886"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679381886"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381886"><span class="hs-identifier hs-type">alg</span></a></span></span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621679381609"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#subst"><span class="hs-identifier hs-var hs-var">subst</span></a></span><span> </span><span id="local-6989586621679381608"><span class="annot"><span class="annottext">Sized (Arity poly) alg
</span><a href="#local-6989586621679381608"><span class="hs-identifier hs-var">dic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity poly) -&gt; alg) -&gt; poly -&gt; alg
forall poly alg.
(IsPolynomial poly, Module (Scalar (Coefficient poly)) alg,
 Ring alg, Commutative alg) =&gt;
(Ordinal (Arity poly) -&gt; alg) -&gt; poly -&gt; alg
</span><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-identifier hs-var">liftMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sized (Arity poly) alg
</span><a href="#local-6989586621679381608"><span class="hs-identifier hs-var">dic</span></a></span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) alg -&gt; Ordinal (Arity poly) -&gt; alg
forall (f :: * -&gt; *) (n :: Nat) c.
(CFoldable f, Dom f c) =&gt;
Sized f n c -&gt; Ordinal n -&gt; c
</span><span class="hs-operator hs-var">V.%!!</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#subst"><span class="hs-pragma hs-type">subst</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- | Another variant of @&#39;liftMap&#39;@.</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">--   This function relies on @&#39;terms&#39;&#39;@; if you have more efficient implementation,</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-comment">--   it is encouraged to override this method.</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">--   Since 0.6.0.0</span><span>
</span><span id="line-98"></span><span>  </span><span id="substWith"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#substWith"><span class="hs-identifier hs-type">substWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679381695"><span class="annot"><a href="#local-6989586621679381695"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ring</span></span><span> </span><span class="annot"><a href="#local-6989586621679381695"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381695"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381695"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679381695"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381695"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679381605"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#substWith"><span class="hs-identifier hs-var hs-var">substWith</span></a></span><span> </span><span id="local-6989586621679381604"><span class="annot"><span class="annottext">Coefficient poly -&gt; m -&gt; m
</span><a href="#local-6989586621679381604"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679381603"><span class="annot"><span class="annottext">Sized (Arity poly) m
</span><a href="#local-6989586621679381603"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span id="local-6989586621679381602"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381602"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">Add m -&gt; m
forall a. Add a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runAdd</span></span><span> </span><span class="annot"><span class="annottext">(Add m -&gt; m) -&gt; Add m -&gt; m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly) -&gt; Coefficient poly -&gt; Add m)
-&gt; Map (Monomial (Arity poly)) (Coefficient poly) -&gt; Add m
forall i (f :: * -&gt; *) m a.
(FoldableWithIndex i f, Monoid m) =&gt;
(i -&gt; a -&gt; m) -&gt; f a -&gt; m
</span><span class="hs-identifier hs-var">ifoldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; Add m
forall a. a -&gt; Add a
</span><span class="hs-identifier hs-var">Add</span></span><span> </span><span class="annot"><span class="annottext">(m -&gt; Add m)
-&gt; (Coefficient poly -&gt; m) -&gt; Coefficient poly -&gt; Add m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Coefficient poly -&gt; m) -&gt; Coefficient poly -&gt; Add m)
-&gt; (Monomial (Arity poly) -&gt; Coefficient poly -&gt; m)
-&gt; Monomial (Arity poly)
-&gt; Coefficient poly
-&gt; Add m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; m -&gt; m) -&gt; m -&gt; Coefficient poly -&gt; m
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; m -&gt; m
</span><a href="#local-6989586621679381604"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">(m -&gt; Coefficient poly -&gt; m)
-&gt; (Monomial (Arity poly) -&gt; m)
-&gt; Monomial (Arity poly)
-&gt; Coefficient poly
-&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; m
</span><a href="#local-6989586621679381597"><span class="hs-identifier hs-var">extractPower</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly) -&gt; Add m)
-&gt; Map (Monomial (Arity poly)) (Coefficient poly) -&gt; Add m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381602"><span class="hs-identifier hs-var">poly</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><a href="#local-6989586621679381597"><span class="hs-identifier hs-type">extractPower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381695"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-104"></span><span>      </span><span id="local-6989586621679381597"><span class="annot"><span class="annottext">extractPower :: Monomial (Arity poly) -&gt; m
</span><a href="#local-6989586621679381597"><span class="hs-identifier hs-var hs-var">extractPower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mult m -&gt; m
forall a. Mult a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runMult</span></span><span> </span><span class="annot"><span class="annottext">(Mult m -&gt; m)
-&gt; (Monomial (Arity poly) -&gt; Mult m) -&gt; Monomial (Arity poly) -&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity poly) -&gt; Int -&gt; Mult m)
-&gt; Monomial (Arity poly) -&gt; Mult m
forall (n :: Nat) m.
(KnownNat n, Monoid m) =&gt;
(Ordinal n -&gt; Int -&gt; m) -&gt; Monomial n -&gt; m
</span><a href="Algebra.Ring.Polynomial.Monomial.html#ifoldMapMonom"><span class="hs-identifier hs-var">ifoldMapMonom</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679381594"><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><a href="#local-6989586621679381594"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679381593"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381593"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m -&gt; Mult m
forall a. a -&gt; Mult a
</span><span class="hs-identifier hs-var">Mult</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; Natural -&gt; m
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-identifier hs-var">pow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sized (Arity poly) m
</span><a href="#local-6989586621679381603"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) m -&gt; Ordinal (Arity poly) -&gt; m
forall (f :: * -&gt; *) (n :: Nat) c.
(CFoldable f, Dom f c) =&gt;
Sized f n c -&gt; Ordinal n -&gt; c
</span><span class="hs-operator hs-var">V.%!!</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><a href="#local-6989586621679381594"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">P.fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381593"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#substWith"><span class="hs-pragma hs-type">substWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- | Arity of given polynomial.</span><span>
</span><span id="line-108"></span><span>  </span><span id="sArity%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sArity%27"><span class="hs-identifier hs-type">sArity&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679381590"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sArity%27"><span class="hs-identifier hs-var hs-var">sArity&#39;</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe poly -&gt; SNat (Arity poly)
forall poly (proxy :: * -&gt; *).
IsPolynomial poly =&gt;
proxy poly -&gt; SNat (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-identifier hs-var">sArity</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe poly -&gt; SNat (Arity poly))
-&gt; (poly -&gt; Maybe poly) -&gt; poly -&gt; SNat (Arity poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Maybe poly
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">-- | Arity of given polynomial, using type proxy.</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679382031"><span id="sArity"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-identifier hs-type">sArity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382031"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621679381589"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-identifier hs-var hs-var">sArity</span></a></span><span> </span><span class="annot"><span class="annottext">proxy poly
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; SNat (Arity poly)
forall poly. IsPolynomial poly =&gt; poly -&gt; SNat (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#sArity%27"><span class="hs-identifier hs-var">sArity&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-pragma hs-type">sArity</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- | Non-dependent version of arity.</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679381587"><span id="arity"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#arity"><span class="hs-identifier hs-type">arity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381587"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Integer</span></span></span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679381585"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#arity"><span class="hs-identifier hs-var hs-var">arity</span></a></span><span> </span><span id="local-6989586621679381584"><span class="annot"><span class="annottext">proxy poly
</span><a href="#local-6989586621679381584"><span class="hs-identifier hs-var">_pxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Integer) -&gt; Natural -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity poly) -&gt; Natural
forall (n :: Nat). SNat n -&gt; Natural
</span><span class="hs-identifier hs-var">toNatural</span></span><span> </span><span class="annot"><span class="annottext">(SNat (Arity poly) -&gt; Natural) -&gt; SNat (Arity poly) -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; SNat (Arity poly)
forall poly. IsPolynomial poly =&gt; poly -&gt; SNat (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#sArity%27"><span class="hs-identifier hs-var">sArity&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#arity"><span class="hs-pragma hs-type">arity</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-comment">-- | Inject coefficient into polynomial.</span><span>
</span><span id="line-122"></span><span>  </span><span id="injectCoeff"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff"><span class="hs-identifier hs-type">injectCoeff</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679381581"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff"><span class="hs-identifier hs-var hs-var">injectCoeff</span></a></span><span> </span><span id="local-6989586621679381580"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381580"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Scalar (Coefficient poly)
forall r. r -&gt; Scalar r
</span><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381580"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar (Coefficient poly) -&gt; poly -&gt; poly
forall r m. LeftModule r m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*</span></span><span> </span><span class="annot"><span class="annottext">poly
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff"><span class="hs-pragma hs-type">injectCoeff</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">-- | Inject coefficient into polynomial with result-type explicitly given.</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679381578"><span id="injectCoeff%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff%27"><span class="hs-identifier hs-type">injectCoeff&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381578"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621679381576"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff%27"><span class="hs-identifier hs-var hs-var">injectCoeff&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">proxy poly
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; poly
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff"><span class="hs-identifier hs-var">injectCoeff</span></a></span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff%27"><span class="hs-pragma hs-type">injectCoeff&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">-- | @&#39;monomials&#39; f@ returns the finite set of all monomials appearing in @f@.</span><span>
</span><span id="line-132"></span><span>  </span><span id="monomials"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#monomials"><span class="hs-identifier hs-type">monomials</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HS.HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679381575"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#monomials"><span class="hs-identifier hs-var hs-var">monomials</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Monomial (Arity poly)] -&gt; HashSet (Monomial (Arity poly))
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><span class="hs-identifier hs-var">HS.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Monomial (Arity poly)] -&gt; HashSet (Monomial (Arity poly)))
-&gt; (poly -&gt; [Monomial (Arity poly)])
-&gt; poly
-&gt; HashSet (Monomial (Arity poly))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; [Monomial (Arity poly)]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly)
 -&gt; [Monomial (Arity poly)])
-&gt; (poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; [Monomial (Arity poly)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#monomials"><span class="hs-pragma hs-type">monomials</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-comment">-- | @&#39;monomials&#39; f@ returns the finite set of all terms appearing in @f@;</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-comment">--   Term is a finite map from monomials to non-zero coefficient.</span><span>
</span><span id="line-138"></span><span>  </span><span id="terms%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-type">terms&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621679381572"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var hs-var">terms&#39;</span></a></span><span> </span><span id="local-6989586621679381571"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381571"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Monomial (Arity poly), Coefficient poly)]
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381569"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381568"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679381569"><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381569"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HashSet (Monomial (Arity poly)) -&gt; [Monomial (Arity poly)]
forall a. HashSet a -&gt; [a]
</span><span class="hs-identifier hs-var">HS.toList</span></span><span> </span><span class="annot"><span class="annottext">(HashSet (Monomial (Arity poly)) -&gt; [Monomial (Arity poly)])
-&gt; HashSet (Monomial (Arity poly)) -&gt; [Monomial (Arity poly)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; HashSet (Monomial (Arity poly))
forall poly.
IsPolynomial poly =&gt;
poly -&gt; HashSet (Monomial (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#monomials"><span class="hs-identifier hs-var">monomials</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381571"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-141"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381568"><span class="annot"><span class="annottext">c :: Coefficient poly
</span><a href="#local-6989586621679381568"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; poly -&gt; Coefficient poly
forall poly.
IsPolynomial poly =&gt;
Monomial (Arity poly) -&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#coeff%27"><span class="hs-identifier hs-var">coeff&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381569"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381571"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-142"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381568"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>                        </span><span class="hs-special">]</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-pragma hs-type">terms&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">-- | @&#39;coeff m f&#39;@ returns the coefficient of monomial @m@ in polynomial @f@.</span><span>
</span><span id="line-147"></span><span>  </span><span id="coeff%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#coeff%27"><span class="hs-identifier hs-type">coeff&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679381563"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#coeff%27"><span class="hs-identifier hs-var hs-var">coeff&#39;</span></a></span><span> </span><span id="local-6989586621679381562"><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381562"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coefficient poly
-&gt; Monomial (Arity poly)
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; Coefficient poly
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">M.findWithDefault</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381562"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly)
 -&gt; Coefficient poly)
-&gt; (poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; Coefficient poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#coeff%27"><span class="hs-pragma hs-type">coeff&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">-- | Calculates constant coefficient.</span><span>
</span><span id="line-152"></span><span>  </span><span id="constantTerm"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#constantTerm"><span class="hs-identifier hs-type">constantTerm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679381559"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#constantTerm"><span class="hs-identifier hs-var hs-var">constantTerm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Coefficient poly) -&gt; Coefficient poly
forall r. Scalar r -&gt; r
</span><a href="Algebra.Scalar.html#runScalar"><span class="hs-identifier hs-var hs-var">runScalar</span></a></span><span> </span><span class="annot"><span class="annottext">(Scalar (Coefficient poly) -&gt; Coefficient poly)
-&gt; (poly -&gt; Scalar (Coefficient poly)) -&gt; poly -&gt; Coefficient poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity poly) -&gt; Scalar (Coefficient poly))
-&gt; poly -&gt; Scalar (Coefficient poly)
forall poly alg.
(IsPolynomial poly, Module (Scalar (Coefficient poly)) alg,
 Ring alg, Commutative alg) =&gt;
(Ordinal (Arity poly) -&gt; alg) -&gt; poly -&gt; alg
</span><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-identifier hs-var">liftMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Scalar (Coefficient poly)
forall r. r -&gt; Scalar r
</span><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#constantTerm"><span class="hs-pragma hs-type">constantTerm</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">-- | Inject monic monomial.</span><span>
</span><span id="line-157"></span><span>  </span><span id="fromMonomial"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#fromMonomial"><span class="hs-identifier hs-type">fromMonomial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679381557"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#fromMonomial"><span class="hs-identifier hs-var hs-var">fromMonomial</span></a></span><span> </span><span id="local-6989586621679381556"><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381556"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, Monomial (Arity poly)) -&gt; poly
forall poly.
IsPolynomial poly =&gt;
(Coefficient poly, Monomial (Arity poly)) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial%27"><span class="hs-identifier hs-var">toPolynomial&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381556"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#fromMonomial"><span class="hs-pragma hs-type">fromMonomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">-- | Inject coefficient with monomial.</span><span>
</span><span id="line-162"></span><span>  </span><span id="toPolynomial%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial%27"><span class="hs-identifier hs-type">toPolynomial&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679381555"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial%27"><span class="hs-identifier hs-var hs-var">toPolynomial&#39;</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381554"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381554"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381553"><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381553"><span class="hs-identifier hs-var">deg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Scalar (Coefficient poly)
forall r. r -&gt; Scalar r
</span><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381554"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar (Coefficient poly) -&gt; poly -&gt; poly
forall r m. LeftModule r m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; poly
forall poly. IsPolynomial poly =&gt; Monomial (Arity poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#fromMonomial"><span class="hs-identifier hs-var">fromMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381553"><span class="hs-identifier hs-var">deg</span></a></span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial%27"><span class="hs-pragma hs-type">toPolynomial&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- | Construct polynomial from the given finite mapping from monomials to coefficients.</span><span>
</span><span id="line-167"></span><span>  </span><span id="polynomial%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#polynomial%27"><span class="hs-identifier hs-type">polynomial&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679381552"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#polynomial%27"><span class="hs-identifier hs-var hs-var">polynomial&#39;</span></a></span><span> </span><span id="local-6989586621679381551"><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="#local-6989586621679381551"><span class="hs-identifier hs-var">dic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">[poly] -&gt; poly
forall (f :: * -&gt; *) m. (Foldable f, Monoidal m) =&gt; f m -&gt; m
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, Monomial (Arity poly)) -&gt; poly
forall poly.
IsPolynomial poly =&gt;
(Coefficient poly, Monomial (Arity poly)) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial%27"><span class="hs-identifier hs-var">toPolynomial&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381550"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381549"><span class="hs-identifier hs-var">deg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381549"><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381549"><span class="hs-identifier hs-var">deg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381550"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381550"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; [(Monomial (Arity poly), Coefficient poly)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="#local-6989586621679381551"><span class="hs-identifier hs-var">dic</span></a></span><span> </span><span class="hs-special">]</span></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#polynomial%27"><span class="hs-pragma hs-type">polynomial&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-comment">-- | Returns total degree.</span><span>
</span><span id="line-173"></span><span>  </span><span id="totalDegree%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#totalDegree%27"><span class="hs-identifier hs-type">totalDegree&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679381547"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#totalDegree%27"><span class="hs-identifier hs-var hs-var">totalDegree&#39;</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; (poly -&gt; Maybe Int) -&gt; poly -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Endo (Endo (Maybe Int))) (HashSet Int) Int
-&gt; HashSet Int -&gt; Maybe Int
forall a s.
Ord a =&gt;
Getting (Endo (Endo (Maybe a))) s a -&gt; s -&gt; Maybe a
</span><span class="hs-identifier hs-var">maximumOf</span></span><span> </span><span class="annot"><span class="annottext">Getting (Endo (Endo (Maybe Int))) (HashSet Int) Int
forall (f :: * -&gt; *) a. Foldable f =&gt; IndexedFold Int (f a) a
</span><span class="hs-identifier hs-var">folded</span></span><span> </span><span class="annot"><span class="annottext">(HashSet Int -&gt; Maybe Int)
-&gt; (poly -&gt; HashSet Int) -&gt; poly -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly) -&gt; Int)
-&gt; HashSet (Monomial (Arity poly)) -&gt; HashSet Int
forall b a.
(Hashable b, Eq b) =&gt;
(a -&gt; b) -&gt; HashSet a -&gt; HashSet b
</span><span class="hs-identifier hs-var">HS.map</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; Int
forall mono.
(MonoFoldable mono, Num (Element mono)) =&gt;
mono -&gt; Element mono
</span><span class="hs-identifier hs-var">osum</span></span><span> </span><span class="annot"><span class="annottext">(HashSet (Monomial (Arity poly)) -&gt; HashSet Int)
-&gt; (poly -&gt; HashSet (Monomial (Arity poly))) -&gt; poly -&gt; HashSet Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; HashSet (Monomial (Arity poly))
forall poly.
IsPolynomial poly =&gt;
poly -&gt; HashSet (Monomial (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#monomials"><span class="hs-identifier hs-var">monomials</span></a></span></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#totalDegree%27"><span class="hs-pragma hs-type">totalDegree&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">-- | @&#39;var&#39; n@ returns a polynomial representing n-th variable.</span><span>
</span><span id="line-178"></span><span>  </span><span id="var"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#var"><span class="hs-identifier hs-type">var</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679381542"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#var"><span class="hs-identifier hs-var hs-var">var</span></a></span><span> </span><span id="local-6989586621679381541"><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><a href="#local-6989586621679381541"><span class="hs-identifier hs-var">nth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; poly
forall poly. IsPolynomial poly =&gt; Monomial (Arity poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#fromMonomial"><span class="hs-identifier hs-var">fromMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly) -&gt; poly) -&gt; Monomial (Arity poly) -&gt; poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity poly) -&gt; Ordinal (Arity poly) -&gt; Monomial (Arity poly)
forall (n :: Nat). SNat n -&gt; Ordinal n -&gt; Monomial n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#varMonom"><span class="hs-identifier hs-var">varMonom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; SNat (Arity poly)
forall poly. IsPolynomial poly =&gt; poly -&gt; SNat (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#sArity%27"><span class="hs-identifier hs-var">sArity&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><a href="#local-6989586621679381541"><span class="hs-identifier hs-var">nth</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- | Adjusting coefficients of each term.</span></span><span>
</span><span id="line-182"></span><span>  </span><span id="mapCoeff%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapCoeff%27"><span class="hs-identifier hs-type">mapCoeff&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679381538"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapCoeff%27"><span class="hs-identifier hs-var hs-var">mapCoeff&#39;</span></a></span><span> </span><span id="local-6989586621679381537"><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly
</span><a href="#local-6989586621679381537"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly
forall poly.
IsPolynomial poly =&gt;
Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#polynomial%27"><span class="hs-identifier hs-var">polynomial&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly)
-&gt; (poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Coefficient poly)
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly
</span><a href="#local-6989586621679381537"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly)
 -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; (poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">-- | @m &#39;&gt;|*&#39; f@ multiplies polynomial @f@ by monomial @m@.</span></span><span>
</span><span id="line-186"></span><span>  </span><span id="%3E%7C%2A"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%3E%7C%2A"><span class="hs-operator hs-type">(&gt;|*)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679381536"><span id="local-6989586621679381535"><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381535"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%3E%7C%2A"><span class="hs-operator hs-var hs-var">&gt;|*</span></a></span><span> </span><span id="local-6989586621679381534"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381534"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, Monomial (Arity poly)) -&gt; poly
forall poly.
IsPolynomial poly =&gt;
(Coefficient poly, Monomial (Arity poly)) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial%27"><span class="hs-identifier hs-var">toPolynomial&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly)
</span><a href="#local-6989586621679381535"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381534"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-comment">-- | Flipped version of @(&#39;&gt;|*&#39;)@</span></span><span>
</span><span id="line-190"></span><span>  </span><span id="%2A%7C%3C"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%2A%7C%3C"><span class="hs-operator hs-type">(*|&lt;)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679381532"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%2A%7C%3C"><span class="hs-operator hs-var hs-var">(*|&lt;)</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly) -&gt; poly -&gt; poly)
-&gt; poly -&gt; Monomial (Arity poly) -&gt; poly
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; poly -&gt; poly
forall poly.
IsPolynomial poly =&gt;
Monomial (Arity poly) -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#%3E%7C%2A"><span class="hs-operator hs-var">(&gt;|*)</span></a></span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>  </span><span id="%21%2A"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%21%2A"><span class="hs-operator hs-type">(!*)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679381531"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%21%2A"><span class="hs-operator hs-var hs-var">(!*)</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; poly -&gt; poly
forall r m. Module (Scalar r) m =&gt; r -&gt; m -&gt; m
</span><a href="Algebra.Scalar.html#.%2A."><span class="hs-operator hs-var">(.*.)</span></a></span></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>  </span><span id="_Terms%27"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#_Terms%27"><span class="hs-identifier hs-type">_Terms&#39;</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iso&#39;</span></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679381528"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#_Terms%27"><span class="hs-identifier hs-var hs-var">_Terms&#39;</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; (Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly)
-&gt; Iso
     poly
     poly
     (Map (Monomial (Arity poly)) (Coefficient poly))
     (Map (Monomial (Arity poly)) (Coefficient poly))
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><span class="hs-identifier hs-var">iso</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly
forall poly.
IsPolynomial poly =&gt;
Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#polynomial%27"><span class="hs-identifier hs-var">polynomial&#39;</span></a></span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#_Terms%27"><span class="hs-pragma hs-type">_Terms&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>  </span><span id="mapMonomial"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapMonomial"><span class="hs-identifier hs-type">mapMonomial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382053"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679381526"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapMonomial"><span class="hs-identifier hs-var hs-var">mapMonomial</span></a></span><span> </span><span id="local-6989586621679381525"><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; Monomial (Arity poly)
</span><a href="#local-6989586621679381525"><span class="hs-identifier hs-var">tr</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly)
 -&gt; Identity (Map (Monomial (Arity poly)) (Coefficient poly)))
-&gt; poly -&gt; Identity poly
forall poly.
IsPolynomial poly =&gt;
Iso
  poly
  poly
  (Map (Monomial (Arity poly)) (Coefficient poly))
  (Map (Monomial (Arity poly)) (Coefficient poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#_Terms%27"><span class="hs-identifier hs-var">_Terms&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">((Map (Monomial (Arity poly)) (Coefficient poly)
  -&gt; Identity (Map (Monomial (Arity poly)) (Coefficient poly)))
 -&gt; poly -&gt; Identity poly)
-&gt; (Map (Monomial (Arity poly)) (Coefficient poly)
    -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; poly
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Coefficient poly -&gt; Coefficient poly)
-&gt; (Monomial (Arity poly) -&gt; Monomial (Arity poly))
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall k2 a k1.
Ord k2 =&gt;
(a -&gt; a -&gt; a) -&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeysWith</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly -&gt; Coefficient poly
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; Monomial (Arity poly)
</span><a href="#local-6989586621679381525"><span class="hs-identifier hs-var">tr</span></a></span></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapMonomial"><span class="hs-pragma hs-type">mapMonomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | Class to lookup ordering from its (type-level) name.</span><span>
</span><span id="line-207"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#IsMonomialOrder"><span class="hs-identifier hs-type">IsMonomialOrder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="IsOrderedPolynomial"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-var">IsOrderedPolynomial</span></a></span></span><span> </span><span id="local-6989586621679381939"><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="MOrder"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-var">MOrder</span></a></span></span><span> </span><span id="local-6989586621679381939"><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-pragma hs-type">leadingTerm</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-pragma hs-type">leadingMonomial</span></a></span><span> </span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-pragma hs-type">leadingCoeff</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-comment">-- | A variant of @&#39;coeff&#39;&#39;@ which takes @&#39;OrderedMonomial&#39;@ instead of @&#39;Monomial&#39;@</span><span>
</span><span id="line-212"></span><span>  </span><span id="coeff"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#coeff"><span class="hs-identifier hs-type">coeff</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679381517"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#coeff"><span class="hs-identifier hs-var hs-var">coeff</span></a></span><span> </span><span id="local-6989586621679381516"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381516"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; poly -&gt; Coefficient poly
forall poly.
IsPolynomial poly =&gt;
Monomial (Arity poly) -&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#coeff%27"><span class="hs-identifier hs-var">coeff&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Monomial (Arity poly)
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#getMonomial"><span class="hs-identifier hs-var hs-var">getMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381516"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#coeff"><span class="hs-pragma hs-type">coeff</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">-- | The default implementation  is not enough efficient.</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-comment">--   So it is strongly recomended to give explicit</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-comment">--   definition to @&#39;terms&#39;@.</span><span>
</span><span id="line-219"></span><span>  </span><span id="terms"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#terms"><span class="hs-identifier hs-type">terms</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679381513"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#terms"><span class="hs-identifier hs-var hs-var">terms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultTerms"><span class="hs-identifier hs-var">defaultTerms</span></a></span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">-- | Leading term with respect to its monomial ordering.</span><span>
</span><span id="line-223"></span><span>  </span><span id="leadingTerm"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-type">leadingTerm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679381511"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-var hs-var">leadingTerm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly
 -&gt; OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)))
-&gt; (poly -&gt; Coefficient poly)
-&gt; poly
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-identifier hs-var">leadingCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(poly
 -&gt; OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)))
-&gt; (poly -&gt; OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-var">leadingMonomial</span></a></span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-pragma hs-type">leadingTerm</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">-- | Leading monomial with respect to its monomial ordering.</span><span>
</span><span id="line-228"></span><span>  </span><span id="leadingMonomial"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-type">leadingMonomial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621679381509"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-var hs-var">leadingMonomial</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
 -&gt; OrderedMonomial (MOrder poly) (Arity poly))
-&gt; (poly
    -&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)))
-&gt; poly
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-var">leadingTerm</span></a></span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-pragma hs-type">leadingMonomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-comment">-- | Leading coefficient with respect to its monomial ordering.</span><span>
</span><span id="line-233"></span><span>  </span><span id="leadingCoeff"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-identifier hs-type">leadingCoeff</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679381508"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-identifier hs-var hs-var">leadingCoeff</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; Coefficient poly
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
 -&gt; Coefficient poly)
-&gt; (poly
    -&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)))
-&gt; poly
-&gt; Coefficient poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-var">leadingTerm</span></a></span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-pragma hs-type">leadingCoeff</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-comment">-- | Splitting leading term, returning a pair of the leading term and the new polynomial</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-comment">--   with the leading term subtracted.</span><span>
</span><span id="line-239"></span><span>  </span><span id="splitLeadingTerm"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#splitLeadingTerm"><span class="hs-identifier hs-type">splitLeadingTerm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679381506"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#splitLeadingTerm"><span class="hs-identifier hs-var hs-var">splitLeadingTerm</span></a></span><span> </span><span id="local-6989586621679381505"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381505"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381504"><span class="annot"><span class="annottext">t :: (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679381504"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-var">leadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381505"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679381504"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381505"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679381504"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#splitLeadingTerm"><span class="hs-pragma hs-type">splitLeadingTerm</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-comment">-- | The collection of all monomials in the given polynomial,</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-comment">--   with metadata of their ordering.</span><span>
</span><span id="line-247"></span><span>  </span><span id="orderedMonomials"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#orderedMonomials"><span class="hs-identifier hs-type">orderedMonomials</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679381500"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#orderedMonomials"><span class="hs-identifier hs-var hs-var">orderedMonomials</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OrderedMonomial (MOrder poly) (Arity poly)]
-&gt; Set (OrderedMonomial (MOrder poly) (Arity poly))
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([OrderedMonomial (MOrder poly) (Arity poly)]
 -&gt; Set (OrderedMonomial (MOrder poly) (Arity poly)))
-&gt; (poly -&gt; [OrderedMonomial (MOrder poly) (Arity poly)])
-&gt; poly
-&gt; Set (OrderedMonomial (MOrder poly) (Arity poly))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly)
 -&gt; OrderedMonomial (MOrder poly) (Arity poly))
-&gt; [Monomial (Arity poly)]
-&gt; [OrderedMonomial (MOrder poly) (Arity poly)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall k (ordering :: k) (n :: Nat).
Monomial n -&gt; OrderedMonomial ordering n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-var">OrderedMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">([Monomial (Arity poly)]
 -&gt; [OrderedMonomial (MOrder poly) (Arity poly)])
-&gt; (poly -&gt; [Monomial (Arity poly)])
-&gt; poly
-&gt; [OrderedMonomial (MOrder poly) (Arity poly)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HashSet (Monomial (Arity poly)) -&gt; [Monomial (Arity poly)]
forall a. HashSet a -&gt; [a]
</span><span class="hs-identifier hs-var">HS.toList</span></span><span> </span><span class="annot"><span class="annottext">(HashSet (Monomial (Arity poly)) -&gt; [Monomial (Arity poly)])
-&gt; (poly -&gt; HashSet (Monomial (Arity poly)))
-&gt; poly
-&gt; [Monomial (Arity poly)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; HashSet (Monomial (Arity poly))
forall poly.
IsPolynomial poly =&gt;
poly -&gt; HashSet (Monomial (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#monomials"><span class="hs-identifier hs-var">monomials</span></a></span></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#orderedMonomials"><span class="hs-pragma hs-type">orderedMonomials</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">-- | A variant of @&#39;fromMonomial&#39;@ which takes @&#39;OrderedMonomial&#39;@ as argument.</span><span>
</span><span id="line-252"></span><span>  </span><span id="fromOrderedMonomial"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#fromOrderedMonomial"><span class="hs-identifier hs-type">fromOrderedMonomial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679381496"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#fromOrderedMonomial"><span class="hs-identifier hs-var hs-var">fromOrderedMonomial</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; poly
forall poly. IsPolynomial poly =&gt; Monomial (Arity poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#fromMonomial"><span class="hs-identifier hs-var">fromMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly) -&gt; poly)
-&gt; (OrderedMonomial (MOrder poly) (Arity poly)
    -&gt; Monomial (Arity poly))
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
-&gt; poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Monomial (Arity poly)
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#getMonomial"><span class="hs-identifier hs-var hs-var">getMonomial</span></a></span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#fromOrderedMonomial"><span class="hs-pragma hs-type">fromOrderedMonomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-comment">-- | A variant of @&#39;toPolynomial&#39;&#39;@ which takes @&#39;OrderedMonomial&#39;@ as argument.</span><span>
</span><span id="line-257"></span><span>  </span><span id="toPolynomial"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-type">toPolynomial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679381495"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var hs-var">toPolynomial</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381494"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381494"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381493"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381493"><span class="hs-identifier hs-var">deg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, Monomial (Arity poly)) -&gt; poly
forall poly.
IsPolynomial poly =&gt;
(Coefficient poly, Monomial (Arity poly)) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial%27"><span class="hs-identifier hs-var">toPolynomial&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381494"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Monomial (Arity poly)
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#getMonomial"><span class="hs-identifier hs-var hs-var">getMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381493"><span class="hs-identifier hs-var">deg</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-pragma hs-type">toPolynomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-comment">-- | A variant of @&#39;polynomial&#39;&#39;@ which takes @&#39;OrderedMonomial&#39;@ as argument.</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-comment">--   The default implementation combines @&#39;Data.Map.mapKeys&#39;@ and @&#39;polynomial&#39;&#39;@,</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-comment">--   hence is not enough efficient. So it is strongly recomended to give explicit</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-comment">-- definition to @&#39;polynomial&#39;@.</span><span>
</span><span id="line-266"></span><span>  </span><span id="polynomial"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#polynomial"><span class="hs-identifier hs-type">polynomial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679381491"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#polynomial"><span class="hs-identifier hs-var hs-var">polynomial</span></a></span><span> </span><span id="local-6989586621679381490"><span class="annot"><span class="annottext">Map (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
</span><a href="#local-6989586621679381490"><span class="hs-identifier hs-var">dic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly
forall poly.
IsPolynomial poly =&gt;
Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#polynomial%27"><span class="hs-identifier hs-var">polynomial&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly)
-&gt; Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; Monomial (Arity poly))
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Monomial (Arity poly)
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#getMonomial"><span class="hs-identifier hs-var hs-var">getMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">Map (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
</span><a href="#local-6989586621679381490"><span class="hs-identifier hs-var">dic</span></a></span></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#polynomial"><span class="hs-pragma hs-type">polynomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-comment">-- | A variant of @&#39;(&gt;|*)&#39;@ which takes @&#39;OrderedMonomial&#39;@ as argument.</span><span>
</span><span id="line-272"></span><span>  </span><span id="%3E%2A"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%3E%2A"><span class="hs-operator hs-type">(&gt;*)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621679381488"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%3E%2A"><span class="hs-operator hs-var hs-var">(&gt;*)</span></a></span><span> </span><span id="local-6989586621679381487"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381487"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly -&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
(OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#mapMonomialMonotonic"><span class="hs-identifier hs-var">mapMonomialMonotonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381487"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&gt;*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-comment">-- | Flipped version of (&gt;*)</span><span>
</span><span id="line-277"></span><span>  </span><span id="%2A%3C"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%2A%3C"><span class="hs-operator hs-type">(*&lt;)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621679381485"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#%2A%3C"><span class="hs-operator hs-var hs-var">(*&lt;)</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OrderedMonomial (MOrder poly) (Arity poly) -&gt; poly -&gt; poly)
-&gt; poly -&gt; OrderedMonomial (MOrder poly) (Arity poly) -&gt; poly
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; poly -&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
OrderedMonomial (MOrder poly) (Arity poly) -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#%3E%2A"><span class="hs-operator hs-var">(&gt;*)</span></a></span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">*&lt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>  </span><span id="_Terms"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#_Terms"><span class="hs-identifier hs-type">_Terms</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iso&#39;</span></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621679381483"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#_Terms"><span class="hs-identifier hs-var hs-var">_Terms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(poly
 -&gt; Map
      (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
-&gt; (Map
      (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
    -&gt; poly)
-&gt; Iso
     poly
     poly
     (Map
        (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
     (Map
        (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><span class="hs-identifier hs-var">iso</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms"><span class="hs-identifier hs-var">terms</span></a></span><span> </span><span class="annot"><span class="annottext">Map (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
Map (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#polynomial"><span class="hs-identifier hs-var">polynomial</span></a></span></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#_Terms"><span class="hs-pragma hs-type">_Terms</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">-- | @diff n f@ partially diffrenciates @n@-th variable in the given polynomial @f@.</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-comment">--   The default implementation uses @&#39;terms&#39;@ and @&#39;polynomial&#39;@</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-comment">--   and is really naive; please consider overrideing for efficiency.</span><span>
</span><span id="line-288"></span><span>  </span><span id="diff"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#diff"><span class="hs-identifier hs-type">diff</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621679381481"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#diff"><span class="hs-identifier hs-var hs-var">diff</span></a></span><span> </span><span id="local-6989586621679381480"><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><a href="#local-6989586621679381480"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map
   (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
 -&gt; Identity
      (Map
         (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)))
-&gt; poly -&gt; Identity poly
forall poly.
IsOrderedPolynomial poly =&gt;
Iso
  poly
  poly
  (Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
  (Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#_Terms"><span class="hs-identifier hs-var">_Terms</span></a></span><span> </span><span class="annot"><span class="annottext">((Map
    (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
  -&gt; Identity
       (Map
          (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)))
 -&gt; poly -&gt; Identity poly)
-&gt; (Map
      (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
    -&gt; Map
         (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; poly
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Coefficient poly -&gt; Coefficient poly)
-&gt; (OrderedMonomial (MOrder poly) (Arity poly)
    -&gt; OrderedMonomial (MOrder poly) (Arity poly))
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall k2 a k1.
Ord k2 =&gt;
(a -&gt; a -&gt; a) -&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeysWith</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly -&gt; Coefficient poly
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Monomial (Arity poly) -&gt; Identity (Monomial (Arity poly)))
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
-&gt; Identity (OrderedMonomial (MOrder poly) (Arity poly))
forall s t. Rewrapping s t =&gt; Iso s t (Unwrapped s) (Unwrapped t)
</span><span class="hs-identifier hs-var">_Wrapped</span></span><span class="annot"><span class="annottext">((Monomial (Arity poly) -&gt; Identity (Monomial (Arity poly)))
 -&gt; OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; Identity (OrderedMonomial (MOrder poly) (Arity poly)))
-&gt; ((Int -&gt; Identity Int)
    -&gt; Monomial (Arity poly) -&gt; Identity (Monomial (Arity poly)))
-&gt; (Int -&gt; Identity Int)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
-&gt; Identity (OrderedMonomial (MOrder poly) (Arity poly))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Monomial (Arity poly))
-&gt; Traversal&#39;
     (Monomial (Arity poly)) (IxValue (Monomial (Arity poly)))
forall m. Ixed m =&gt; Index m -&gt; Traversal&#39; m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index (Monomial (Arity poly))
Ordinal (Arity poly)
</span><a href="#local-6989586621679381480"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Identity Int)
 -&gt; OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; Identity (OrderedMonomial (MOrder poly) (Arity poly)))
-&gt; (Int -&gt; Int)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (Int -&gt; Int) -&gt; Int -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>                   </span><span class="annot"><span class="annottext">(Map
   (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
 -&gt; Map
      (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
-&gt; (Map
      (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
    -&gt; Map
         (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; Coefficient poly -&gt; Maybe (Coefficient poly))
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall k a b. (k -&gt; a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.mapMaybeWithKey</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
-&gt; Coefficient poly -&gt; Maybe (Coefficient poly)
</span><a href="#local-6989586621679381476"><span class="hs-identifier hs-var">df</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>      </span><span id="local-6989586621679381476"><span class="annot"><span class="annottext">df :: OrderedMonomial (MOrder poly) (Arity poly)
-&gt; Coefficient poly -&gt; Maybe (Coefficient poly)
</span><a href="#local-6989586621679381476"><span class="hs-identifier hs-var hs-var">df</span></a></span></span><span> </span><span id="local-6989586621679381475"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381475"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679381474"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381474"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381473"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679381473"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Monomial (Arity poly)
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#getMonomial"><span class="hs-identifier hs-var hs-var">getMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381475"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; Ordinal (Arity poly) -&gt; Int
forall (f :: * -&gt; *) (n :: Nat) c.
(CFoldable f, Dom f c) =&gt;
Sized f n c -&gt; Ordinal n -&gt; c
</span><span class="hs-operator hs-var">V.%!!</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly)
</span><a href="#local-6989586621679381480"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-294"></span><span>            </span><span id="local-6989586621679381472"><span class="annot"><span class="annottext">v&#39; :: Coefficient poly
</span><a href="#local-6989586621679381472"><span class="hs-identifier hs-var hs-var">v&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Coefficient poly
forall n r. (Integral n, Ring r) =&gt; n -&gt; r
</span><span class="hs-identifier hs-var">NA.fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381473"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly -&gt; Coefficient poly
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381474"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381473"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381472"><span class="hs-identifier hs-var">v&#39;</span></a></span><span>
</span><span id="line-296"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Coefficient poly)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-297"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Maybe (Coefficient poly)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381472"><span class="hs-identifier hs-var">v&#39;</span></a></span></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#diff"><span class="hs-pragma hs-type">diff</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-comment">-- | Same as @&#39;mapMonomial&#39;@, but maping function is</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-comment">--   assumed to be strictly monotonic (i.e. @a &lt; b@ implies @f a &lt; f b@).</span><span>
</span><span id="line-302"></span><span>  </span><span id="mapMonomialMonotonic"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapMonomialMonotonic"><span class="hs-identifier hs-type">mapMonomialMonotonic</span></a></span></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381939"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621679381469"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapMonomialMonotonic"><span class="hs-identifier hs-var hs-var">mapMonomialMonotonic</span></a></span><span> </span><span id="local-6989586621679381468"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381468"><span class="hs-identifier hs-var">tr</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">(Map
   (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
 -&gt; Identity
      (Map
         (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)))
-&gt; poly -&gt; Identity poly
forall poly.
IsOrderedPolynomial poly =&gt;
Iso
  poly
  poly
  (Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
  (Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#_Terms"><span class="hs-identifier hs-var">_Terms</span></a></span><span> </span><span class="annot"><span class="annottext">((Map
    (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
  -&gt; Identity
       (Map
          (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)))
 -&gt; poly -&gt; Identity poly)
-&gt; (Map
      (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
    -&gt; Map
         (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; poly
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(OrderedMonomial (MOrder poly) (Arity poly)
 -&gt; OrderedMonomial (MOrder poly) (Arity poly))
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall k1 k2 a. (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeysMonotonic</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381468"><span class="hs-identifier hs-var">tr</span></a></span></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapMonomialMonotonic"><span class="hs-pragma hs-type">mapMonomialMonotonic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">type</span><span> </span><span id="OMonom"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#OMonom"><span class="hs-identifier hs-var">OMonom</span></a></span></span><span> </span><span id="local-6989586621679381466"><span class="annot"><a href="#local-6989586621679381466"><span class="hs-identifier hs-type">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381466"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381466"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span class="hs-keyword">type</span><span> </span><span id="Term"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Term"><span class="hs-identifier hs-var">Term</span></a></span></span><span> </span><span id="local-6989586621679381465"><span class="annot"><a href="#local-6989586621679381465"><span class="hs-identifier hs-type">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381465"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#OMonom"><span class="hs-identifier hs-type">OMonom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381465"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span id="local-6989586621679381933"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#defaultTerms"><span class="hs-identifier hs-type">defaultTerms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381933"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-314"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381933"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381933"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381933"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381933"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-315"></span><span id="defaultTerms"><span class="annot"><span class="annottext">defaultTerms :: poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultTerms"><span class="hs-identifier hs-var hs-var">defaultTerms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly)
 -&gt; OrderedMonomial (MOrder poly) (Arity poly))
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall k (ordering :: k) (n :: Nat).
Monomial n -&gt; OrderedMonomial ordering n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-var">OrderedMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly)
 -&gt; Map
      (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly))
-&gt; (poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span>
</span><span id="line-316"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#defaultTerms"><span class="hs-pragma hs-type">defaultTerms</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-319"></span><span> </span><span id="local-6989586621679381464"><span class="annot"><span class="hs-pragma">&quot;polynomial/terms&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">(</span><span id="local-6989586621679381463"><span class="annot"><a href="#local-6989586621679381463"><span class="hs-pragma hs-var">f</span></a></span></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-pragma hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381464"><span class="hs-pragma hs-type">poly</span></a></span><span> </span><span class="hs-pragma">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381464"><span class="hs-pragma hs-type">poly</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">.</span><span>
</span><span id="line-320"></span><span>   </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#polynomial"><span class="hs-pragma hs-type">polynomial</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#defaultTerms"><span class="hs-pragma hs-type">defaultTerms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381463"><span class="hs-pragma hs-type">f</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679381463"><span class="hs-pragma hs-type">f</span></a></span></span><span>
</span><span id="line-321"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621679381462"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#liftMapCoeff"><span class="hs-identifier hs-type">liftMapCoeff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381462"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381462"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381462"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381462"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381462"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-324"></span><span id="liftMapCoeff"><span class="annot"><span class="annottext">liftMapCoeff :: (Ordinal (Arity poly) -&gt; Coefficient poly)
-&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#liftMapCoeff"><span class="hs-identifier hs-var hs-var">liftMapCoeff</span></a></span></span><span> </span><span id="local-6989586621679381461"><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; Coefficient poly
</span><a href="#local-6989586621679381461"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Coefficient poly) -&gt; Coefficient poly
forall r. Scalar r -&gt; r
</span><a href="Algebra.Scalar.html#runScalar"><span class="hs-identifier hs-var hs-var">runScalar</span></a></span><span> </span><span class="annot"><span class="annottext">(Scalar (Coefficient poly) -&gt; Coefficient poly)
-&gt; (poly -&gt; Scalar (Coefficient poly)) -&gt; poly -&gt; Coefficient poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity poly) -&gt; Scalar (Coefficient poly))
-&gt; poly -&gt; Scalar (Coefficient poly)
forall poly alg.
(IsPolynomial poly, Module (Scalar (Coefficient poly)) alg,
 Ring alg, Commutative alg) =&gt;
(Ordinal (Arity poly) -&gt; alg) -&gt; poly -&gt; alg
</span><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-identifier hs-var">liftMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly -&gt; Scalar (Coefficient poly)
forall r. r -&gt; Scalar r
</span><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Scalar (Coefficient poly))
-&gt; (Ordinal (Arity poly) -&gt; Coefficient poly)
-&gt; Ordinal (Arity poly)
-&gt; Scalar (Coefficient poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; Coefficient poly
</span><a href="#local-6989586621679381461"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#liftMapCoeff"><span class="hs-pragma hs-type">liftMapCoeff</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span id="local-6989586621679381460"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#substCoeff"><span class="hs-identifier hs-type">substCoeff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381460"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381460"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381460"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381460"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381460"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-328"></span><span id="substCoeff"><span class="annot"><span class="annottext">substCoeff :: Sized (Arity poly) (Coefficient poly) -&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#substCoeff"><span class="hs-identifier hs-var hs-var">substCoeff</span></a></span></span><span> </span><span id="local-6989586621679381459"><span class="annot"><span class="annottext">Sized (Arity poly) (Coefficient poly)
</span><a href="#local-6989586621679381459"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Coefficient poly) -&gt; Coefficient poly
forall r. Scalar r -&gt; r
</span><a href="Algebra.Scalar.html#runScalar"><span class="hs-identifier hs-var hs-var">runScalar</span></a></span><span> </span><span class="annot"><span class="annottext">(Scalar (Coefficient poly) -&gt; Coefficient poly)
-&gt; (poly -&gt; Scalar (Coefficient poly)) -&gt; poly -&gt; Coefficient poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) (Scalar (Coefficient poly))
-&gt; poly -&gt; Scalar (Coefficient poly)
forall poly alg.
(IsPolynomial poly, Ring alg, Commutative alg,
 Module (Scalar (Coefficient poly)) alg) =&gt;
Sized (Arity poly) alg -&gt; poly -&gt; alg
</span><a href="Algebra.Ring.Polynomial.Class.html#subst"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Scalar (Coefficient poly))
-&gt; Sized (Arity poly) (Coefficient poly)
-&gt; Sized (Arity poly) (Scalar (Coefficient poly))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Scalar (Coefficient poly)
forall r. r -&gt; Scalar r
</span><a href="Algebra.Scalar.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) (Coefficient poly)
</span><a href="#local-6989586621679381459"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#substCoeff"><span class="hs-pragma hs-type">substCoeff</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">-- | 1-norm of given polynomial, taking sum of @&#39;norm&#39;@s of each coefficients.</span><span>
</span><span id="line-332"></span><span id="local-6989586621679381458"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#oneNorm"><span class="hs-identifier hs-type">oneNorm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381458"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Normed.html#Normed"><span class="hs-identifier hs-type">Normed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381458"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Monoidal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Normed.html#Norm"><span class="hs-identifier hs-type">Norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381458"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381458"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Normed.html#Norm"><span class="hs-identifier hs-type">Norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381458"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-334"></span><span id="oneNorm"><span class="annot"><span class="annottext">oneNorm :: poly -&gt; Norm (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#oneNorm"><span class="hs-identifier hs-var hs-var">oneNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Norm (Coefficient poly)] -&gt; Norm (Coefficient poly)
forall (f :: * -&gt; *) m. (Foldable f, Monoidal m) =&gt; f m -&gt; m
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Norm (Coefficient poly)] -&gt; Norm (Coefficient poly))
-&gt; (poly -&gt; [Norm (Coefficient poly)])
-&gt; poly
-&gt; Norm (Coefficient poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Norm (Coefficient poly))
-&gt; [Coefficient poly] -&gt; [Norm (Coefficient poly)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Norm (Coefficient poly)
forall a. Normed a =&gt; a -&gt; Norm a
</span><a href="Algebra.Normed.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="annot"><span class="annottext">([Coefficient poly] -&gt; [Norm (Coefficient poly)])
-&gt; (poly -&gt; [Coefficient poly])
-&gt; poly
-&gt; [Norm (Coefficient poly)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; [Coefficient poly]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly)
 -&gt; [Coefficient poly])
-&gt; (poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; [Coefficient poly]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span>
</span><span id="line-335"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#oneNorm"><span class="hs-pragma hs-type">oneNorm</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- | Maximum norm of given polynomial, taking maximum of the @&#39;norm&#39;@s of each coefficients.</span><span>
</span><span id="line-338"></span><span id="local-6989586621679381455"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#maxNorm"><span class="hs-identifier hs-type">maxNorm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381455"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Normed.html#Normed"><span class="hs-identifier hs-type">Normed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381455"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381455"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Normed.html#Norm"><span class="hs-identifier hs-type">Norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381455"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-339"></span><span id="maxNorm"><span class="annot"><span class="annottext">maxNorm :: poly -&gt; Norm (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#maxNorm"><span class="hs-identifier hs-var hs-var">maxNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Norm (Coefficient poly)] -&gt; Norm (Coefficient poly)
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">([Norm (Coefficient poly)] -&gt; Norm (Coefficient poly))
-&gt; (poly -&gt; [Norm (Coefficient poly)])
-&gt; poly
-&gt; Norm (Coefficient poly)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Norm (Coefficient poly))
-&gt; [Coefficient poly] -&gt; [Norm (Coefficient poly)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Norm (Coefficient poly)
forall a. Normed a =&gt; a -&gt; Norm a
</span><a href="Algebra.Normed.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="annot"><span class="annottext">([Coefficient poly] -&gt; [Norm (Coefficient poly)])
-&gt; (poly -&gt; [Coefficient poly])
-&gt; poly
-&gt; [Norm (Coefficient poly)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; [Coefficient poly]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly)
 -&gt; [Coefficient poly])
-&gt; (poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; [Coefficient poly]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span>
</span><span id="line-340"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#maxNorm"><span class="hs-pragma hs-type">maxNorm</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | Make the given polynomial monic.</span><span>
</span><span id="line-343"></span><span class="hs-comment">--   If the given polynomial is zero, it returns as it is.</span><span>
</span><span id="line-344"></span><span id="local-6989586621679381452"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#monoize"><span class="hs-identifier hs-type">monoize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381452"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381452"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381452"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381452"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-346"></span><span id="monoize"><span class="annot"><span class="annottext">monoize :: poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#monoize"><span class="hs-identifier hs-var hs-var">monoize</span></a></span></span><span> </span><span id="local-6989586621679381451"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381451"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381451"><span class="hs-identifier hs-var">f</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span>
</span><span id="line-347"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly
forall r. Division r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-identifier hs-var">leadingCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381451"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; poly -&gt; poly
forall r m. Module (Scalar r) m =&gt; r -&gt; m -&gt; m
</span><a href="Algebra.Scalar.html#.%2A."><span class="hs-operator hs-var">.*.</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381451"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-348"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#monoize"><span class="hs-pragma hs-type">monoize</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | @&#39;sPolynomial&#39;@ calculates the S-Polynomial of given two polynomials.</span><span>
</span><span id="line-351"></span><span id="local-6989586621679381449"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#sPolynomial"><span class="hs-identifier hs-type">sPolynomial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381449"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381449"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381449"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-353"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381449"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381449"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-354"></span><span id="sPolynomial"><span class="annot"><span class="annottext">sPolynomial :: poly -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#sPolynomial"><span class="hs-identifier hs-var hs-var">sPolynomial</span></a></span></span><span> </span><span id="local-6989586621679381448"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381448"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679381447"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381447"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381446"><span class="annot"><span class="annottext">h :: (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679381446"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall k (n :: Nat) (ord :: k).
KnownNat n =&gt;
OrderedMonomial ord n
-&gt; OrderedMonomial ord n -&gt; OrderedMonomial ord n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#lcmMonomial"><span class="hs-identifier hs-var">lcmMonomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-var">leadingMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381448"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-var">leadingMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381447"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679381446"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall k (n :: Nat) r (ord :: k).
(KnownNat n, Field r) =&gt;
(r, OrderedMonomial ord n)
-&gt; (r, OrderedMonomial ord n) -&gt; (r, OrderedMonomial ord n)
</span><a href="Algebra.Ring.Polynomial.Monomial.html#tryDiv"><span class="hs-operator hs-var">`tryDiv`</span></a></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-var">leadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381448"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381448"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679381446"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall k (n :: Nat) r (ord :: k).
(KnownNat n, Field r) =&gt;
(r, OrderedMonomial ord n)
-&gt; (r, OrderedMonomial ord n) -&gt; (r, OrderedMonomial ord n)
</span><a href="Algebra.Ring.Polynomial.Monomial.html#tryDiv"><span class="hs-operator hs-var">`tryDiv`</span></a></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-var">leadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381447"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381447"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | @pDivModPoly f g@ calculates the pseudo quotient and reminder of @f@ by @g@.</span><span>
</span><span id="line-359"></span><span id="local-6989586621679381442"><span id="local-6989586621679381443"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#pDivModPoly"><span class="hs-identifier hs-type">pDivModPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381443"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381442"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679381443"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381442"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381442"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381442"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-361"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381442"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679381442"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-362"></span><span id="local-6989586621679381441"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381441"><span class="hs-identifier hs-var">f0</span></a></span></span><span> </span><span id="pDivModPoly"><span class="annot"><span class="annottext">pDivModPoly :: poly -&gt; poly -&gt; (poly, poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#pDivModPoly"><span class="hs-operator hs-var hs-var">`pDivModPoly`</span></a></span></span><span> </span><span id="local-6989586621679381440"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381440"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381439"><span class="annot"><span class="annottext">k :: Integer
</span><a href="#local-6989586621679381439"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; Int -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><a href="Algebra.Ring.Polynomial.Class.html#totalDegree%27"><span class="hs-identifier hs-var">totalDegree&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381441"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-364"></span><span>      </span><span id="local-6989586621679381438"><span class="annot"><span class="annottext">l :: Integer
</span><a href="#local-6989586621679381438"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; Int -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><a href="Algebra.Ring.Polynomial.Class.html#totalDegree%27"><span class="hs-identifier hs-var">totalDegree&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381440"><span class="hs-identifier hs-var">g</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; (poly, poly)
</span><a href="#local-6989586621679381437"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly -&gt; poly
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff"><span class="hs-identifier hs-var">injectCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Natural -&gt; k
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-identifier hs-var">pow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-identifier hs-var">leadingCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381440"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">P.fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Integer -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679381439"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679381438"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381441"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679381436"><span class="annot"><span class="annottext">lm :: OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381436"><span class="hs-identifier hs-var hs-var">lm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-var">leadingMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381440"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679381437"><span class="annot"><span class="annottext">step :: poly -&gt; poly -&gt; (poly, poly)
</span><a href="#local-6989586621679381437"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679381435"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381435"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679381434"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381434"><span class="hs-identifier hs-var">quo</span></a></span></span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381435"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381434"><span class="hs-identifier hs-var">quo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381435"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381436"><span class="hs-identifier hs-var">lm</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly) -&gt; Bool
forall k (n :: Nat) (ord :: k).
KnownNat n =&gt;
OrderedMonomial ord n -&gt; OrderedMonomial ord n -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Monomial.html#divs"><span class="hs-operator hs-var">`divs`</span></a></span><span> </span><span class="annot"><span class="annottext">poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-var">leadingMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381435"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381432"><span class="annot"><span class="annottext">coe :: k
</span><a href="#local-6989586621679381432"><span class="hs-identifier hs-var hs-var">coe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-identifier hs-var">leadingCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381435"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; k
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-identifier hs-var">leadingCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381440"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-372"></span><span>                </span><span id="local-6989586621679381430"><span class="annot"><span class="annottext">mon :: OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381430"><span class="hs-identifier hs-var hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-var">leadingMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381435"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
-&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall r. Division r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingMonomial"><span class="hs-identifier hs-var">leadingMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381440"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-373"></span><span>                </span><span id="local-6989586621679381428"><span class="annot"><span class="annottext">q :: poly
</span><a href="#local-6989586621679381428"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
Coefficient poly
</span><a href="#local-6989586621679381432"><span class="hs-identifier hs-var">coe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381430"><span class="hs-identifier hs-var">mon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; (poly, poly)
</span><a href="#local-6989586621679381437"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381435"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381428"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381440"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381434"><span class="hs-identifier hs-var">quo</span></a></span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381428"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381434"><span class="hs-identifier hs-var">quo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381435"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- | The content of a polynomial f is the @&#39;gcd&#39;@ of all its coefficients.</span><span>
</span><span id="line-378"></span><span id="local-6989586621679381851"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#content"><span class="hs-identifier hs-type">content</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381851"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381851"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381851"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381851"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-379"></span><span id="content"><span class="annot"><span class="annottext">content :: poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#content"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Coefficient poly -&gt; Coefficient poly)
-&gt; Coefficient poly
-&gt; Map (Monomial (Arity poly)) (Coefficient poly)
-&gt; Coefficient poly
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly -&gt; Coefficient poly
forall d. GCDDomain d =&gt; d -&gt; d -&gt; d
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="annot"><span class="annottext">(Map (Monomial (Arity poly)) (Coefficient poly)
 -&gt; Coefficient poly)
-&gt; (poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly))
-&gt; poly
-&gt; Coefficient poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span>
</span><span id="line-380"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#content"><span class="hs-pragma hs-type">content</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | @&#39;pp&#39; f@ calculates the primitive part of given polynomial @f@,</span><span>
</span><span id="line-383"></span><span class="hs-comment">--   namely @f / content(f)@.</span><span>
</span><span id="line-384"></span><span id="local-6989586621679381425"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#pp"><span class="hs-identifier hs-type">pp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381425"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381425"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381425"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381425"><span class="hs-identifier hs-type">poly</span></a></span></span><span>
</span><span id="line-385"></span><span id="pp"><span class="annot"><span class="annottext">pp :: poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#pp"><span class="hs-identifier hs-var hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621679381424"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381424"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; Coefficient poly) -&gt; poly -&gt; poly
forall poly.
IsPolynomial poly =&gt;
(Coefficient poly -&gt; Coefficient poly) -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#mapCoeff%27"><span class="hs-identifier hs-var">mapCoeff&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly -&gt; Coefficient poly
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly.
(IsPolynomial poly, Euclidean (Coefficient poly)) =&gt;
poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381424"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381424"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-386"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#pp"><span class="hs-pragma hs-type">pp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | See also @&#39;injectVarsOffset&#39;@ and @&#39;injectVarsAtEnd&#39;@.</span><span>
</span><span id="line-389"></span><span id="local-6989586621679381422"><span id="local-6989586621679381423"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVars"><span class="hs-identifier hs-type">injectVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381423"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381422"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-390"></span><span>               </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381423"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-391"></span><span>               </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381422"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-392"></span><span>               </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381423"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381422"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381423"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381422"><span class="hs-identifier hs-type">r&#39;</span></a></span></span></span><span>
</span><span id="line-393"></span><span id="injectVars"><span class="annot"><span class="annottext">injectVars :: r -&gt; r&#39;
</span><a href="Algebra.Ring.Polynomial.Class.html#injectVars"><span class="hs-identifier hs-var hs-var">injectVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity r) -&gt; r&#39;) -&gt; r -&gt; r&#39;
forall poly alg.
(IsPolynomial poly, Module (Scalar (Coefficient poly)) alg,
 Ring alg, Commutative alg) =&gt;
(Ordinal (Arity poly) -&gt; alg) -&gt; poly -&gt; alg
</span><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-identifier hs-var">liftMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordinal (Arity r&#39;) -&gt; r&#39;
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity r&#39;) -&gt; r&#39;)
-&gt; (Ordinal (Arity r) -&gt; Ordinal (Arity r&#39;))
-&gt; Ordinal (Arity r)
-&gt; r&#39;
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity r) -&gt; Ordinal (Arity r&#39;)
forall (n :: Nat) (m :: Nat). (n &lt;= m) =&gt; Ordinal n -&gt; Ordinal m
</span><span class="hs-identifier hs-var">inclusion</span></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVars"><span class="hs-pragma hs-type">injectVars</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-395"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;injectVars/identity&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVars"><span class="hs-pragma hs-type">injectVars</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">P.id</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | Similar to @&#39;injectVars&#39;@, but injects variables at the end of</span><span>
</span><span id="line-398"></span><span class="hs-comment">--   the target polynomial ring.</span><span>
</span><span id="line-399"></span><span class="hs-comment">--</span><span>
</span><span id="line-400"></span><span class="hs-comment">--   See also @&#39;injectVars&#39;@ and @&#39;injectVarsOffset&#39;@.</span><span>
</span><span id="line-401"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVarsAtEnd"><span class="hs-identifier hs-type">injectVarsAtEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679381419"><span class="annot"><a href="#local-6989586621679381419"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679381418"><span class="annot"><a href="#local-6989586621679381418"><span class="hs-identifier hs-type">r&#39;</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381419"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381418"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-402"></span><span>                    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381419"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-403"></span><span>                    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381418"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-404"></span><span>                    </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381419"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381418"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381419"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381418"><span class="hs-identifier hs-type">r&#39;</span></a></span><span>
</span><span id="line-405"></span><span id="injectVarsAtEnd"><span class="annot"><span class="annottext">injectVarsAtEnd :: r -&gt; r&#39;
</span><a href="Algebra.Ring.Polynomial.Class.html#injectVarsAtEnd"><span class="hs-identifier hs-var hs-var">injectVarsAtEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381417"><span class="annot"><span class="annottext">sn :: SNat (Arity r)
</span><a href="#local-6989586621679381417"><span class="hs-identifier hs-var hs-var">sn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy r -&gt; SNat (Arity r)
forall poly (proxy :: * -&gt; *).
IsPolynomial poly =&gt;
proxy poly -&gt; SNat (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-identifier hs-var">sArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy r
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679381419"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>      </span><span id="local-6989586621679381415"><span class="annot"><span class="annottext">sm :: SNat (Arity r&#39;)
</span><a href="#local-6989586621679381415"><span class="hs-identifier hs-var hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy r&#39; -&gt; SNat (Arity r&#39;)
forall poly (proxy :: * -&gt; *).
IsPolynomial poly =&gt;
proxy poly -&gt; SNat (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-identifier hs-var">sArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy r&#39;
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679381418"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(((Arity r&#39; - Arity r) + Arity r) :~: Arity r&#39;)
-&gt; ((((Arity r&#39; - Arity r) + Arity r) ~ Arity r&#39;) =&gt; r -&gt; r&#39;)
-&gt; r
-&gt; r&#39;
forall k (a :: k) (b :: k) r. (a :~: b) -&gt; ((a ~ b) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withRefl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat (Arity r&#39;)
-&gt; SNat (Arity r)
-&gt; IsTrue (Arity r &lt;=? Arity r&#39;)
-&gt; ((Arity r&#39; - Arity r) + Arity r) :~: Arity r&#39;
forall (n :: Nat) (m :: Nat).
SNat n -&gt; SNat m -&gt; IsTrue (m &lt;=? n) -&gt; ((n - m) + m) :~: n
</span><span class="hs-identifier hs-var">minusPlus</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity r&#39;)
</span><a href="#local-6989586621679381415"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SNat (Arity r)
</span><a href="#local-6989586621679381417"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">IsTrue (Arity r &lt;=? Arity r&#39;)
IsTrue &#39;True
</span><span class="hs-identifier hs-var">Witness</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((((Arity r&#39; - Arity r) + Arity r) ~ Arity r&#39;) =&gt; r -&gt; r&#39;)
 -&gt; r -&gt; r&#39;)
-&gt; ((((Arity r&#39; - Arity r) + Arity r) ~ Arity r&#39;) =&gt; r -&gt; r&#39;)
-&gt; r
-&gt; r&#39;
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity r&#39; - Arity r) -&gt; r -&gt; r&#39;
forall (n :: Nat) r r&#39;.
((n + Arity r) &lt;= Arity r&#39;, IsPolynomial r, IsPolynomial r&#39;,
 Coefficient r ~ Coefficient r&#39;) =&gt;
SNat n -&gt; r -&gt; r&#39;
</span><a href="Algebra.Ring.Polynomial.Class.html#injectVarsOffset"><span class="hs-identifier hs-var">injectVarsOffset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat (Arity r&#39;)
</span><a href="#local-6989586621679381415"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SNat (Arity r&#39;) -&gt; SNat (Arity r) -&gt; SNat (Arity r&#39; - Arity r)
forall (n :: Nat) (m :: Nat). SNat n -&gt; SNat m -&gt; SNat (n - m)
</span><span class="hs-operator hs-var">%-</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity r)
</span><a href="#local-6989586621679381417"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVarsAtEnd"><span class="hs-pragma hs-type">injectVarsAtEnd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#shift"><span class="hs-identifier hs-type">shift</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679381784"><span class="annot"><a href="#local-6989586621679381784"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679381783"><span class="annot"><a href="#local-6989586621679381783"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679381782"><span class="annot"><a href="#local-6989586621679381782"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381784"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679381783"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679381782"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381783"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381782"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381784"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="annot"><a href="#local-6989586621679381783"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="annot"><a href="#local-6989586621679381782"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-412"></span><span id="shift"><span class="annot"><span class="annottext">shift :: SNat n -&gt; Ordinal m -&gt; Ordinal k
</span><a href="Algebra.Ring.Polynomial.Class.html#shift"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621679381410"><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381410"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OLt</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381408"><span id="local-6989586621679381407"><span class="annot"><span class="annottext">SNat n1
</span><a href="#local-6989586621679381407"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381408"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381406"><span class="annot"><span class="annottext">sm :: SNat m
</span><a href="#local-6989586621679381406"><span class="hs-identifier hs-var hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SNat m
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381783"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-414"></span><span>      </span><span id="local-6989586621679381404"><span class="annot"><span class="annottext">sk :: SNat k
</span><a href="#local-6989586621679381404"><span class="hs-identifier hs-var hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SNat k
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381782"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(CmpNat n1 m :~: &#39;LT)
-&gt; ((CmpNat n1 m ~ &#39;LT) =&gt; Ordinal k) -&gt; Ordinal k
forall k (a :: k) (b :: k) r. (a :~: b) -&gt; ((a ~ b) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withRefl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n1 -&gt; SNat m -&gt; IsTrue (n1 &lt;? m) -&gt; CmpNat n1 m :~: &#39;LT
forall (n :: Nat) (m :: Nat).
SNat n -&gt; SNat m -&gt; IsTrue (n &lt;? m) -&gt; CmpNat n m :~: &#39;LT
</span><span class="hs-identifier hs-var">lneqToLT</span></span><span> </span><span class="annot"><span class="annottext">SNat n1
</span><a href="#local-6989586621679381407"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381406"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">IsTrue (n1 &lt;? m)
IsTrue &#39;True
</span><span class="hs-identifier hs-var">Witness</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((CmpNat n1 m ~ &#39;LT) =&gt; Ordinal k) -&gt; Ordinal k)
-&gt; ((CmpNat n1 m ~ &#39;LT) =&gt; Ordinal k) -&gt; Ordinal k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-416"></span><span>     </span><span class="annot"><span class="annottext">IsTrue (((n + n1) + 1) &lt;=? (n + m))
-&gt; (((((n + n1) + 1) &lt;=? (n + m)) ~ &#39;True) =&gt; Ordinal k)
-&gt; Ordinal k
forall (b :: Bool) r. IsTrue b -&gt; ((b ~ &#39;True) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withWitness</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n
-&gt; SNat n1
-&gt; SNat m
-&gt; IsTrue (n1 &lt;? m)
-&gt; IsTrue (((n + n1) + 1) &lt;=? (n + m))
forall (n :: Nat) (m :: Nat) (l :: Nat).
SNat n
-&gt; SNat m
-&gt; SNat l
-&gt; IsTrue (m &lt;? l)
-&gt; IsTrue ((n + m) &lt;? (n + l))
</span><a href="Algebra.Ring.Polynomial.Class.html#lneqMonotoneR"><span class="hs-identifier hs-var">lneqMonotoneR</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381410"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n1
</span><a href="#local-6989586621679381407"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381406"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">IsTrue (n1 &lt;? m)
IsTrue &#39;True
</span><span class="hs-identifier hs-var">Witness</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((((((n + n1) + 1) &lt;=? (n + m)) ~ &#39;True) =&gt; Ordinal k)
 -&gt; Ordinal k)
-&gt; (((((n + n1) + 1) &lt;=? (n + m)) ~ &#39;True) =&gt; Ordinal k)
-&gt; Ordinal k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-417"></span><span>     </span><span class="annot"><span class="annottext">IsTrue &#39;True -&gt; ((&#39;True ~ &#39;True) =&gt; Ordinal k) -&gt; Ordinal k
forall (b :: Bool) r. IsTrue b -&gt; ((b ~ &#39;True) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withWitness</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat (n + n1)
-&gt; SNat (n + m)
-&gt; SNat k
-&gt; IsTrue (((n + n1) + 1) &lt;=? (n + m))
-&gt; IsTrue ((n + m) &lt;=? k)
-&gt; IsTrue ((n + n1) &lt;? k)
forall (n :: Nat) (m :: Nat) (l :: Nat).
SNat n
-&gt; SNat m
-&gt; SNat l
-&gt; IsTrue (n &lt;? m)
-&gt; IsTrue (m &lt;=? l)
-&gt; IsTrue (n &lt;? l)
</span><a href="Algebra.Ring.Polynomial.Class.html#lneqLeqTrans"><span class="hs-identifier hs-var">lneqLeqTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381410"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n -&gt; SNat n1 -&gt; SNat (n + n1)
forall (n :: Nat) (m :: Nat). SNat n -&gt; SNat m -&gt; SNat (n + m)
</span><span class="hs-operator hs-var">%+</span></span><span> </span><span class="annot"><span class="annottext">SNat n1
</span><a href="#local-6989586621679381407"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381410"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n -&gt; SNat m -&gt; SNat (n + m)
forall (n :: Nat) (m :: Nat). SNat n -&gt; SNat m -&gt; SNat (n + m)
</span><span class="hs-operator hs-var">%+</span></span><span> </span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381406"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SNat k
</span><a href="#local-6989586621679381404"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">IsTrue (((n + n1) + 1) &lt;=? (n + m))
IsTrue &#39;True
</span><span class="hs-identifier hs-var">Witness</span></span><span> </span><span class="annot"><span class="annottext">IsTrue ((n + m) &lt;=? k)
IsTrue &#39;True
</span><span class="hs-identifier hs-var">Witness</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((&#39;True ~ &#39;True) =&gt; Ordinal k) -&gt; Ordinal k)
-&gt; ((&#39;True ~ &#39;True) =&gt; Ordinal k) -&gt; Ordinal k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-418"></span><span>     </span><span class="annot"><span class="annottext">SNat (n + n1) -&gt; Ordinal k
forall (n1 :: Nat) (n :: Nat). (n1 &lt; n) =&gt; SNat n1 -&gt; Ordinal n
</span><span class="hs-identifier hs-var">OLt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381410"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n -&gt; SNat n1 -&gt; SNat (n + n1)
forall (n :: Nat) (m :: Nat). SNat n -&gt; SNat m -&gt; SNat (n + m)
</span><span class="hs-operator hs-var">%+</span></span><span> </span><span class="annot"><span class="annottext">SNat n1
</span><a href="#local-6989586621679381407"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#shift"><span class="hs-pragma hs-type">shift</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-420"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-421"></span><span class="annot"><span class="hs-pragma">&quot;shift/zero&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">(</span><span id="local-6989586621679381399"><span class="annot"><a href="#local-6989586621679381399"><span class="hs-pragma hs-var">ns</span></a></span></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><span class="hs-pragma hs-type">SNat</span></span><span> </span><span class="annot"><span class="hs-pragma">0</span></span><span class="hs-pragma">)</span><span class="hs-pragma">.</span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#shift"><span class="hs-pragma hs-type">shift</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381399"><span class="hs-pragma hs-type">ns</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">inclusion</span></span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span id="local-6989586621679381812"><span id="local-6989586621679381813"><span id="local-6989586621679381814"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#lneqLeqTrans"><span class="hs-identifier hs-type">lneqLeqTrans</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381814"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381813"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381812"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-426"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsTrue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381814"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;?</span></span><span> </span><span class="annot"><a href="#local-6989586621679381813"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsTrue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381813"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="#local-6989586621679381812"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsTrue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381814"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;?</span></span><span> </span><span class="annot"><a href="#local-6989586621679381812"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-427"></span><span id="lneqLeqTrans"><span class="annot"><span class="annottext">lneqLeqTrans :: SNat n
-&gt; SNat m
-&gt; SNat l
-&gt; IsTrue (n &lt;? m)
-&gt; IsTrue (m &lt;=? l)
-&gt; IsTrue (n &lt;? l)
</span><a href="Algebra.Ring.Polynomial.Class.html#lneqLeqTrans"><span class="hs-identifier hs-var hs-var">lneqLeqTrans</span></a></span></span><span> </span><span id="local-6989586621679381398"><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381398"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span id="local-6989586621679381397"><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381397"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679381396"><span class="annot"><span class="annottext">SNat l
</span><a href="#local-6989586621679381396"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679381395"><span class="annot"><span class="annottext">IsTrue (n &lt;? m)
</span><a href="#local-6989586621679381395"><span class="hs-identifier hs-var">nLTm</span></a></span></span><span> </span><span id="local-6989586621679381394"><span class="annot"><span class="annottext">IsTrue (m &lt;=? l)
</span><a href="#local-6989586621679381394"><span class="hs-identifier hs-var">mLEl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><span class="annottext">(((n &lt;? l) ~ &#39;True) :~: ((n &lt;? l) ~ &#39;True))
-&gt; ((((n &lt;? l) ~ &#39;True) ~ ((n &lt;? l) ~ &#39;True)) =&gt; IsTrue (n &lt;? l))
-&gt; IsTrue (n &lt;? l)
forall k (a :: k) (b :: k) r. (a :~: b) -&gt; ((a ~ b) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withRefl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n -&gt; SNat l -&gt; ((n &lt;? l) ~ &#39;True) :~: ((n &lt;? l) ~ &#39;True)
forall (n :: Nat) (m :: Nat).
SNat n -&gt; SNat m -&gt; (n &lt; m) :~: (n &lt; m)
</span><span class="hs-identifier hs-var">lneqSuccLeq</span></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381398"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat l
</span><a href="#local-6989586621679381396"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((((n &lt;? l) ~ &#39;True) ~ ((n &lt;? l) ~ &#39;True)) =&gt; IsTrue (n &lt;? l))
 -&gt; IsTrue (n &lt;? l))
-&gt; ((((n &lt;? l) ~ &#39;True) ~ ((n &lt;? l) ~ &#39;True)) =&gt; IsTrue (n &lt;? l))
-&gt; IsTrue (n &lt;? l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-429"></span><span>  </span><span class="annot"><span class="annottext">(((n &lt;? m) ~ &#39;True) :~: ((n &lt;? m) ~ &#39;True))
-&gt; ((((n &lt;? m) ~ &#39;True) ~ ((n &lt;? m) ~ &#39;True)) =&gt; IsTrue (n &lt;? l))
-&gt; IsTrue (n &lt;? l)
forall k (a :: k) (b :: k) r. (a :~: b) -&gt; ((a ~ b) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withRefl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n -&gt; SNat m -&gt; ((n &lt;? m) ~ &#39;True) :~: ((n &lt;? m) ~ &#39;True)
forall (n :: Nat) (m :: Nat).
SNat n -&gt; SNat m -&gt; (n &lt; m) :~: (n &lt; m)
</span><span class="hs-identifier hs-var">lneqSuccLeq</span></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381398"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381397"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((((n &lt;? m) ~ &#39;True) ~ ((n &lt;? m) ~ &#39;True)) =&gt; IsTrue (n &lt;? l))
 -&gt; IsTrue (n &lt;? l))
-&gt; ((((n &lt;? m) ~ &#39;True) ~ ((n &lt;? m) ~ &#39;True)) =&gt; IsTrue (n &lt;? l))
-&gt; IsTrue (n &lt;? l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><span class="annottext">SNat (n + 1)
-&gt; SNat m
-&gt; SNat l
-&gt; IsTrue (n &lt;? m)
-&gt; IsTrue (m &lt;=? l)
-&gt; IsTrue (n &lt;? l)
forall (n :: Nat) (m :: Nat) (l :: Nat).
SNat n
-&gt; SNat m
-&gt; SNat l
-&gt; IsTrue (n &lt;=? m)
-&gt; IsTrue (m &lt;=? l)
-&gt; IsTrue (n &lt;=? l)
</span><span class="hs-identifier hs-var">leqTrans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n -&gt; SNat (n + 1)
forall (n :: Nat). SNat n -&gt; SNat (Succ n)
</span><span class="hs-identifier hs-var">sSucc</span></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381398"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381397"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SNat l
</span><a href="#local-6989586621679381396"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">IsTrue (n &lt;? m)
</span><a href="#local-6989586621679381395"><span class="hs-identifier hs-var">nLTm</span></a></span><span> </span><span class="annot"><span class="annottext">IsTrue (m &lt;=? l)
</span><a href="#local-6989586621679381394"><span class="hs-identifier hs-var">mLEl</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#lneqMonotoneR"><span class="hs-identifier hs-type">lneqMonotoneR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679381817"><span class="annot"><a href="#local-6989586621679381817"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679381816"><span class="annot"><a href="#local-6989586621679381816"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679381815"><span class="annot"><a href="#local-6989586621679381815"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381817"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381816"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381815"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-433"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsTrue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381816"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;?</span></span><span> </span><span class="annot"><a href="#local-6989586621679381815"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsTrue</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381817"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679381816"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;?</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381817"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679381815"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span id="lneqMonotoneR"><span class="annot"><span class="annottext">lneqMonotoneR :: SNat n
-&gt; SNat m
-&gt; SNat l
-&gt; IsTrue (m &lt;? l)
-&gt; IsTrue ((n + m) &lt;? (n + l))
</span><a href="Algebra.Ring.Polynomial.Class.html#lneqMonotoneR"><span class="hs-identifier hs-var hs-var">lneqMonotoneR</span></a></span></span><span> </span><span id="local-6989586621679381392"><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381392"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span id="local-6989586621679381391"><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381391"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679381390"><span class="annot"><span class="annottext">SNat l
</span><a href="#local-6989586621679381390"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679381389"><span class="annot"><span class="annottext">IsTrue (m &lt;? l)
</span><a href="#local-6989586621679381389"><span class="hs-identifier hs-var">mLTl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><span class="annottext">(((m &lt;? l) ~ &#39;True) :~: ((m &lt;? l) ~ &#39;True))
-&gt; ((((m &lt;? l) ~ &#39;True) ~ ((m &lt;? l) ~ &#39;True)) =&gt;
    IsTrue ((n + m) &lt;? (n + l)))
-&gt; IsTrue ((n + m) &lt;? (n + l))
forall k (a :: k) (b :: k) r. (a :~: b) -&gt; ((a ~ b) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withRefl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat m -&gt; SNat l -&gt; ((m &lt;? l) ~ &#39;True) :~: ((m &lt;? l) ~ &#39;True)
forall (n :: Nat) (m :: Nat).
SNat n -&gt; SNat m -&gt; (n &lt; m) :~: (n &lt; m)
</span><span class="hs-identifier hs-var">lneqSuccLeq</span></span><span> </span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381391"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SNat l
</span><a href="#local-6989586621679381390"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((((m &lt;? l) ~ &#39;True) ~ ((m &lt;? l) ~ &#39;True)) =&gt;
  IsTrue ((n + m) &lt;? (n + l)))
 -&gt; IsTrue ((n + m) &lt;? (n + l)))
-&gt; ((((m &lt;? l) ~ &#39;True) ~ ((m &lt;? l) ~ &#39;True)) =&gt;
    IsTrue ((n + m) &lt;? (n + l)))
-&gt; IsTrue ((n + m) &lt;? (n + l))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><span class="annottext">((((n + m) &lt;? (n + l)) ~ &#39;True) :~: (((n + m) &lt;? (n + l)) ~ &#39;True))
-&gt; (((((n + m) &lt;? (n + l)) ~ &#39;True)
     ~ (((n + m) &lt;? (n + l)) ~ &#39;True)) =&gt;
    IsTrue ((n + m) &lt;? (n + l)))
-&gt; IsTrue ((n + m) &lt;? (n + l))
forall k (a :: k) (b :: k) r. (a :~: b) -&gt; ((a ~ b) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withRefl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat (n + m)
-&gt; SNat (n + l)
-&gt; (((n + m) &lt;? (n + l)) ~ &#39;True)
   :~: (((n + m) &lt;? (n + l)) ~ &#39;True)
forall (n :: Nat) (m :: Nat).
SNat n -&gt; SNat m -&gt; (n &lt; m) :~: (n &lt; m)
</span><span class="hs-identifier hs-var">lneqSuccLeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381392"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n -&gt; SNat m -&gt; SNat (n + m)
forall (n :: Nat) (m :: Nat). SNat n -&gt; SNat m -&gt; SNat (n + m)
</span><span class="hs-operator hs-var">%+</span></span><span> </span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381391"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381392"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n -&gt; SNat l -&gt; SNat (n + l)
forall (n :: Nat) (m :: Nat). SNat n -&gt; SNat m -&gt; SNat (n + m)
</span><span class="hs-operator hs-var">%+</span></span><span> </span><span class="annot"><span class="annottext">SNat l
</span><a href="#local-6989586621679381390"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((((((n + m) &lt;? (n + l)) ~ &#39;True)
   ~ (((n + m) &lt;? (n + l)) ~ &#39;True)) =&gt;
  IsTrue ((n + m) &lt;? (n + l)))
 -&gt; IsTrue ((n + m) &lt;? (n + l)))
-&gt; (((((n + m) &lt;? (n + l)) ~ &#39;True)
     ~ (((n + m) &lt;? (n + l)) ~ &#39;True)) =&gt;
    IsTrue ((n + m) &lt;? (n + l)))
-&gt; IsTrue ((n + m) &lt;? (n + l))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><span class="annottext">((n + (m + 1)) :~: ((n + m) + 1))
-&gt; (((n + (m + 1)) ~ ((n + m) + 1)) =&gt; IsTrue ((n + m) &lt;? (n + l)))
-&gt; IsTrue ((n + m) &lt;? (n + l))
forall k (a :: k) (b :: k) r. (a :~: b) -&gt; ((a ~ b) =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">withRefl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat n -&gt; SNat m -&gt; (n + (m + 1)) :~: ((n + m) + 1)
forall (n :: Nat) (m :: Nat).
SNat n -&gt; SNat m -&gt; (n + S m) :~: S (n + m)
</span><span class="hs-identifier hs-var">plusSuccR</span></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381392"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381391"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((((n + (m + 1)) ~ ((n + m) + 1)) =&gt; IsTrue ((n + m) &lt;? (n + l)))
 -&gt; IsTrue ((n + m) &lt;? (n + l)))
-&gt; (((n + (m + 1)) ~ ((n + m) + 1)) =&gt; IsTrue ((n + m) &lt;? (n + l)))
-&gt; IsTrue ((n + m) &lt;? (n + l))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><span class="annottext">SNat n
-&gt; SNat (m + 1)
-&gt; SNat l
-&gt; IsTrue (m &lt;? l)
-&gt; IsTrue ((n + (m + 1)) &lt;=? (n + l))
forall (n :: Nat) (m :: Nat) (l :: Nat).
SNat n
-&gt; SNat m
-&gt; SNat l
-&gt; IsTrue (m &lt;=? l)
-&gt; IsTrue ((n + m) &lt;=? (n + l))
</span><span class="hs-identifier hs-var">plusMonotoneR</span></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381392"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat m
</span><a href="#local-6989586621679381391"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SNat m -&gt; SNat 1 -&gt; SNat (m + 1)
forall (n :: Nat) (m :: Nat). SNat n -&gt; SNat m -&gt; SNat (n + m)
</span><span class="hs-operator hs-var">%+</span></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SNat 1
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SNat l
</span><a href="#local-6989586621679381390"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsTrue (m &lt;? l)
</span><a href="#local-6989586621679381389"><span class="hs-identifier hs-var">mLTl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsTrue</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381816"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="#local-6989586621679381815"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | Similar to @&#39;injectVars&#39;@, but @&#39;injectVarsOffset&#39; n f@</span><span>
</span><span id="line-441"></span><span class="hs-comment">--   injects variables into the first but @n@ variables.</span><span>
</span><span id="line-442"></span><span class="hs-comment">--</span><span>
</span><span id="line-443"></span><span class="hs-comment">--   See also @&#39;injectVars&#39;@ and @&#39;injectVarsAtEnd&#39;@.</span><span>
</span><span id="line-444"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVarsOffset"><span class="hs-identifier hs-type">injectVarsOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679381832"><span class="annot"><a href="#local-6989586621679381832"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679381831"><span class="annot"><a href="#local-6989586621679381831"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679381830"><span class="annot"><a href="#local-6989586621679381830"><span class="hs-identifier hs-type">r&#39;</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381832"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381831"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381830"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-445"></span><span>                  </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381831"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-446"></span><span>                  </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381830"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-447"></span><span>                  </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381831"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381830"><span class="hs-identifier hs-type">r&#39;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679381832"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381831"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381830"><span class="hs-identifier hs-type">r&#39;</span></a></span><span>
</span><span id="line-448"></span><span id="injectVarsOffset"><span class="annot"><span class="annottext">injectVarsOffset :: SNat n -&gt; r -&gt; r&#39;
</span><a href="Algebra.Ring.Polynomial.Class.html#injectVarsOffset"><span class="hs-identifier hs-var hs-var">injectVarsOffset</span></a></span></span><span> </span><span id="local-6989586621679381388"><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381388"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity r) -&gt; r&#39;) -&gt; r -&gt; r&#39;
forall poly alg.
(IsPolynomial poly, Module (Scalar (Coefficient poly)) alg,
 Ring alg, Commutative alg) =&gt;
(Ordinal (Arity poly) -&gt; alg) -&gt; poly -&gt; alg
</span><a href="Algebra.Ring.Polynomial.Class.html#liftMap"><span class="hs-identifier hs-var">liftMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordinal (Arity r&#39;) -&gt; r&#39;
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity r&#39;) -&gt; r&#39;)
-&gt; (Ordinal (Arity r) -&gt; Ordinal (Arity r&#39;))
-&gt; Ordinal (Arity r)
-&gt; r&#39;
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SNat n -&gt; Ordinal (Arity r) -&gt; Ordinal (Arity r&#39;)
forall (n :: Nat) (m :: Nat) (k :: Nat).
((n + m) &lt;= k, KnownNat m, KnownNat k) =&gt;
SNat n -&gt; Ordinal m -&gt; Ordinal k
</span><a href="Algebra.Ring.Polynomial.Class.html#shift"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><a href="#local-6989586621679381388"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVarsOffset"><span class="hs-pragma hs-type">injectVarsOffset</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-450"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-451"></span><span class="annot"><span class="hs-pragma">&quot;injectVarsOffset eql&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">(</span><span id="local-6989586621679381387"><span class="annot"><a href="#local-6989586621679381387"><span class="hs-pragma hs-var">sn</span></a></span></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><span class="hs-pragma hs-type">SNat</span></span><span> </span><span class="annot"><span class="hs-pragma">0</span></span><span class="hs-pragma">)</span><span class="hs-pragma">.</span><span>
</span><span id="line-452"></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVarsOffset"><span class="hs-pragma hs-type">injectVarsOffset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381387"><span class="hs-pragma hs-type">sn</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#injectVars"><span class="hs-pragma hs-type">injectVars</span></a></span><span>
</span><span id="line-453"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#vars"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679381386"><span class="annot"><a href="#local-6989586621679381386"><span class="hs-identifier hs-type">poly</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381386"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679381386"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-456"></span><span id="vars"><span class="annot"><span class="annottext">vars :: [poly]
</span><a href="Algebra.Ring.Polynomial.Class.html#vars"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity poly) -&gt; poly) -&gt; [Ordinal (Arity poly)] -&gt; [poly]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; poly
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">([Ordinal (Arity poly)] -&gt; [poly])
-&gt; [Ordinal (Arity poly)] -&gt; [poly]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity poly) -&gt; [Ordinal (Arity poly)]
forall (n :: Nat). SNat n -&gt; [Ordinal n]
</span><span class="hs-identifier hs-var">enumOrdinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe poly -&gt; SNat (Arity poly)
forall poly (proxy :: * -&gt; *).
IsPolynomial poly =&gt;
proxy poly -&gt; SNat (Arity poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#sArity"><span class="hs-identifier hs-var">sArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe poly
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679381386"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- | Coefficients which admits pretty-printing</span><span>
</span><span id="line-459"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">P.Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679381780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="PrettyCoeff"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-var">PrettyCoeff</span></a></span></span><span> </span><span id="local-6989586621679381780"><span class="annot"><a href="#local-6989586621679381780"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>  </span><span id="showsCoeff"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-type">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381780"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier hs-type">ShowSCoeff</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span id="local-6989586621679381384"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-var hs-var">showsCoeff</span></a></span><span> </span><span id="local-6989586621679381383"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381383"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679381382"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381382"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; r -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381383"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381382"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span id="local-6989586621679381774"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-type">defaultShowsOrdCoeff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">P.Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679381774"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unital</span></span><span> </span><span class="annot"><a href="#local-6989586621679381774"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Group</span></span><span> </span><span class="annot"><a href="#local-6989586621679381774"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679381774"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381774"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier hs-type">ShowSCoeff</span></a></span></span><span>
</span><span id="line-465"></span><span id="defaultShowsOrdCoeff"><span class="annot"><span class="annottext">defaultShowsOrdCoeff :: Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var hs-var">defaultShowsOrdCoeff</span></a></span></span><span> </span><span id="local-6989586621679381378"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381378"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679381377"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381377"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381377"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">P.==</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. Group r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ShowS
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381377"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">P.&lt;</span></span><span>  </span><span class="annot"><span class="annottext">r
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS -&gt; Maybe ShowS
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; Maybe ShowS) -&gt; ShowS -&gt; Maybe ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; r -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381378"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r
forall r. Group r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381377"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381377"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">P.==</span></span><span> </span><span class="annot"><span class="annottext">r
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381377"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">P.==</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#OneCoeff"><span class="hs-identifier hs-var">OneCoeff</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; r -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381378"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381377"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Integer</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621679381368"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Integer -&gt; ShowSCoeff
</span><a href="#local-6989586621679381368"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>  </span><span id="local-6989586621679381365"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Natural -&gt; ShowSCoeff
</span><a href="#local-6989586621679381365"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span id="local-6989586621679381364"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381364"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679381363"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679381363"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679381363"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Natural -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381364"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679381363"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Int</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-481"></span><span>  </span><span id="local-6989586621679381360"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Int -&gt; ShowSCoeff
</span><a href="#local-6989586621679381360"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>  </span><span id="local-6989586621679381357"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Int64 -&gt; ShowSCoeff
</span><a href="#local-6989586621679381357"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64 -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-485"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-486"></span><span>  </span><span id="local-6989586621679381354"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Int16 -&gt; ShowSCoeff
</span><a href="#local-6989586621679381354"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int16 -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-487"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-488"></span><span>  </span><span id="local-6989586621679381351"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Int32 -&gt; ShowSCoeff
</span><a href="#local-6989586621679381351"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int32 -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-489"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-490"></span><span>  </span><span id="local-6989586621679381348"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Int8 -&gt; ShowSCoeff
</span><a href="#local-6989586621679381348"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int8 -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-493"></span><span>  </span><span id="local-6989586621679381345"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Word64 -&gt; ShowSCoeff
</span><a href="#local-6989586621679381345"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64 -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>  </span><span id="local-6989586621679381342"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Word16 -&gt; ShowSCoeff
</span><a href="#local-6989586621679381342"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word16 -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679381339"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Word32 -&gt; ShowSCoeff
</span><a href="#local-6989586621679381339"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32 -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621679381336"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Word8 -&gt; ShowSCoeff
</span><a href="#local-6989586621679381336"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span id="local-6989586621679381335"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">P.Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679381335"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381335"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R.Ratio</span></span><span> </span><span class="annot"><a href="#local-6989586621679381335"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-505"></span><span>  </span><span id="local-6989586621679381332"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Ratio a -&gt; ShowSCoeff
</span><a href="#local-6989586621679381332"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span id="local-6989586621679381331"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381331"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679381330"><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679381330"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-506"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Ratio a -&gt; a
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">R.denominator</span></span><span> </span><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679381330"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; ShowSCoeff
forall r. PrettyCoeff r =&gt; Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-var">showsCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio a -&gt; a
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">R.numerator</span></span><span> </span><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679381330"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Ratio a -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381331"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679381330"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span id="local-6989586621679381327"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381327"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NA.Complex</span></span><span> </span><span class="annot"><a href="#local-6989586621679381327"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621679381324"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Complex r -&gt; ShowSCoeff
</span><a href="#local-6989586621679381324"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span id="local-6989586621679381323"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381323"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NA.Complex</span></span><span> </span><span id="local-6989586621679381321"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381321"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679381320"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381320"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; r -&gt; ShowSCoeff
forall r. PrettyCoeff r =&gt; Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-var">showsCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381321"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; r -&gt; ShowSCoeff
forall r. PrettyCoeff r =&gt; Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-var">showsCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381320"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span>
</span><span id="line-514"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-type">Positive</span></a></span><span> </span><span id="local-6989586621679381319"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381319"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381319"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; I&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-type">Negative</span></a></span><span> </span><span id="local-6989586621679381317"><span class="annot"><span class="annottext">Maybe ShowS
</span><a href="#local-6989586621679381317"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS -&gt; Maybe ShowS
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; Maybe ShowS) -&gt; ShowS -&gt; Maybe ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Maybe ShowS -&gt; ShowS
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">P.id</span></span><span> </span><span class="annot"><span class="annottext">Maybe ShowS
</span><a href="#local-6989586621679381317"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; I&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-type">Positive</span></a></span><span> </span><span id="local-6989586621679381316"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381316"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381316"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-517"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-type">Negative</span></a></span><span> </span><span id="local-6989586621679381315"><span class="annot"><span class="annottext">Maybe ShowS
</span><a href="#local-6989586621679381315"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ShowS
</span><a href="#local-6989586621679381315"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-518"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679381314"><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381314"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381313"><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381313"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-519"></span><span>        </span><span class="annot"><span class="annottext">ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowSCoeff) -&gt; ShowS -&gt; ShowSCoeff
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381323"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">P.&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-520"></span><span>        </span><span class="annot"><span class="annottext">ShowSCoeff -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier hs-var">showsCoeffAsTerm</span></a></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381314"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier hs-var">showsCoeffWithOp</span></a></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381313"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fraction</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-523"></span><span>  </span><span id="local-6989586621679381308"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Fraction Integer -&gt; ShowSCoeff
</span><a href="#local-6989586621679381308"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span id="local-6989586621679381307"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381307"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679381306"><span class="annot"><span class="annottext">Fraction Integer
</span><a href="#local-6989586621679381306"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Fraction Integer -&gt; Integer
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">NA.denominator</span></span><span> </span><span class="annot"><span class="annottext">Fraction Integer
</span><a href="#local-6989586621679381306"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-525"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ShowSCoeff
forall r. PrettyCoeff r =&gt; Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-var">showsCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381307"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fraction Integer -&gt; Integer
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">NA.numerator</span></span><span> </span><span class="annot"><span class="annottext">Fraction Integer
</span><a href="#local-6989586621679381306"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Fraction Integer -&gt; ShowSCoeff
forall r.
(Show r, Unital r, Group r, Ord r) =&gt;
Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#defaultShowsOrdCoeff"><span class="hs-identifier hs-var">defaultShowsOrdCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381307"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Fraction Integer
</span><a href="#local-6989586621679381306"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span id="local-6989586621679381303"><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381303"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679381303"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="annot"><a href="#local-6989586621679381303"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fraction</span></span><span> </span><span class="annot"><a href="#local-6989586621679381303"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621679381300"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; Fraction r -&gt; ShowSCoeff
</span><a href="#local-6989586621679381300"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span id="local-6989586621679381299"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381299"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679381298"><span class="annot"><span class="annottext">Fraction r
</span><a href="#local-6989586621679381298"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-531"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Fraction r -&gt; r
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">NA.denominator</span></span><span> </span><span class="annot"><span class="annottext">Fraction r
</span><a href="#local-6989586621679381298"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">one</span></span><span>
</span><span id="line-532"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; r -&gt; ShowSCoeff
forall r. PrettyCoeff r =&gt; Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-var">showsCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381299"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fraction r -&gt; r
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">NA.numerator</span></span><span> </span><span class="annot"><span class="annottext">Fraction r
</span><a href="#local-6989586621679381298"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Fraction r -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381299"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Fraction r
</span><a href="#local-6989586621679381298"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="hs-comment">-- | Pretty-printing conditional for coefficients.</span><span>
</span><span id="line-536"></span><span class="hs-comment">--   Each returning @&#39;P.ShowS&#39;@ must not have any sign.</span><span>
</span><span id="line-537"></span><span class="hs-keyword">data</span><span> </span><span id="ShowSCoeff"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier hs-var">ShowSCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Negative"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.ShowS</span></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="Vanished"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span></span><span>
</span><span id="line-539"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="OneCoeff"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#OneCoeff"><span class="hs-identifier hs-var">OneCoeff</span></a></span></span><span>
</span><span id="line-540"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="Positive"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.ShowS</span></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="hs-comment">-- | ShowS coefficients as term.</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- showsCoeffAsTerm &#39;Vanished&#39; &quot;&quot; = &quot;&quot;</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- showsCoeffAsTerm (&#39;Negative&#39; (shows &quot;12&quot;)) &quot;&quot; = &quot;-12&quot;</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- showsCoeffAsTerm (&#39;Positive&#39; (shows &quot;12&quot;)) &quot;&quot; = &quot;12&quot;</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-549"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier hs-type">showsCoeffAsTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier hs-type">ShowSCoeff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.ShowS</span></span><span>
</span><span id="line-550"></span><span id="showsCoeffAsTerm"><span class="annot"><span class="annottext">showsCoeffAsTerm :: ShowSCoeff -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier hs-var hs-var">showsCoeffAsTerm</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">P.id</span></span><span>
</span><span id="line-551"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier hs-var">showsCoeffAsTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-type">Negative</span></a></span><span> </span><span id="local-6989586621679381297"><span class="annot"><span class="annottext">Maybe ShowS
</span><a href="#local-6989586621679381297"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">&#39;-&#39;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Maybe ShowS -&gt; ShowS
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">&#39;1&#39;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ShowS
</span><a href="#local-6989586621679381297"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier hs-var">showsCoeffAsTerm</span></a></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#OneCoeff"><span class="hs-identifier hs-var">OneCoeff</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">&#39;1&#39;</span></span><span>
</span><span id="line-553"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier hs-var">showsCoeffAsTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-type">Positive</span></a></span><span> </span><span id="local-6989586621679381295"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381295"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381295"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- | ShowS coefficients prefixed with infix operator.</span><span>
</span><span id="line-556"></span><span class="hs-comment">--</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- (shows 12 . showsCoeffWithOp &#39;Vanished&#39;) &quot;&quot; = &quot;12&quot;</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- (shows 12 . showsCoeffWithOp (&#39;Negative&#39; (shows 34))) &quot;&quot; = &quot;12 - 34&quot;</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- (shows 12 . showsCoeffWithOp (&#39;Positive&#39; (shows 34))) &quot;&quot; = &quot;12 + 34&quot;</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-562"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier hs-type">showsCoeffWithOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier hs-type">ShowSCoeff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.ShowS</span></span><span>
</span><span id="line-563"></span><span id="showsCoeffWithOp"><span class="annot"><span class="annottext">showsCoeffWithOp :: ShowSCoeff -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier hs-var hs-var">showsCoeffWithOp</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">P.id</span></span><span>
</span><span id="line-564"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier hs-var">showsCoeffWithOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-type">Negative</span></a></span><span> </span><span id="local-6989586621679381294"><span class="annot"><span class="annottext">Maybe ShowS
</span><a href="#local-6989586621679381294"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; - &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Maybe ShowS -&gt; ShowS
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">&#39;1&#39;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ShowS
</span><a href="#local-6989586621679381294"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-565"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier hs-var">showsCoeffWithOp</span></a></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#OneCoeff"><span class="hs-identifier hs-var">OneCoeff</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; + 1&quot;</span></span><span>
</span><span id="line-566"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier hs-var">showsCoeffWithOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-type">Positive</span></a></span><span> </span><span id="local-6989586621679381293"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381293"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; + &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381293"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span id="local-6989586621679381292"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showPolynomialWith"><span class="hs-identifier hs-type">showPolynomialWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381292"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381292"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381292"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.String</span></span><span>
</span><span id="line-570"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-571"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381292"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-572"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.String</span></span></span><span>
</span><span id="line-573"></span><span id="showPolynomialWith"><span class="annot"><span class="annottext">showPolynomialWith :: Sized (Arity poly) String -&gt; Int -&gt; poly -&gt; String
</span><a href="Algebra.Ring.Polynomial.Class.html#showPolynomialWith"><span class="hs-identifier hs-var hs-var">showPolynomialWith</span></a></span></span><span> </span><span id="local-6989586621679381291"><span class="annot"><span class="annottext">Sized (Arity poly) String
</span><a href="#local-6989586621679381291"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679381290"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381290"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679381289"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381289"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) String -&gt; Int -&gt; poly -&gt; ShowS
forall poly.
(IsOrderedPolynomial poly, PrettyCoeff (Coefficient poly)) =&gt;
Sized (Arity poly) String -&gt; Int -&gt; poly -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith"><span class="hs-identifier hs-var">showsPolynomialWith</span></a></span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) String
</span><a href="#local-6989586621679381291"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381290"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381289"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span id="local-6989586621679381288"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showPolynomialWith%27"><span class="hs-identifier hs-type">showPolynomialWith&#39;</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381288"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-577"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381288"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier hs-type">ShowSCoeff</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381288"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.String</span></span><span>
</span><span id="line-579"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-580"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381288"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-581"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.String</span></span></span><span>
</span><span id="line-582"></span><span id="showPolynomialWith%27"><span class="annot"><span class="annottext">showPolynomialWith&#39; :: Bool
-&gt; (Int -&gt; Coefficient poly -&gt; ShowSCoeff)
-&gt; Sized (Arity poly) String
-&gt; Int
-&gt; poly
-&gt; String
</span><a href="Algebra.Ring.Polynomial.Class.html#showPolynomialWith%27"><span class="hs-identifier hs-var hs-var">showPolynomialWith&#39;</span></a></span></span><span> </span><span id="local-6989586621679381287"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679381287"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679381286"><span class="annot"><span class="annottext">Int -&gt; Coefficient poly -&gt; ShowSCoeff
</span><a href="#local-6989586621679381286"><span class="hs-identifier hs-var">showsCoe</span></a></span></span><span> </span><span id="local-6989586621679381285"><span class="annot"><span class="annottext">Sized (Arity poly) String
</span><a href="#local-6989586621679381285"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679381284"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381284"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679381283"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381283"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (Int -&gt; Coefficient poly -&gt; ShowSCoeff)
-&gt; Sized (Arity poly) String
-&gt; Int
-&gt; poly
-&gt; ShowS
forall poly.
IsOrderedPolynomial poly =&gt;
Bool
-&gt; (Int -&gt; Coefficient poly -&gt; ShowSCoeff)
-&gt; Sized (Arity poly) String
-&gt; Int
-&gt; poly
-&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith%27"><span class="hs-identifier hs-var">showsPolynomialWith&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679381287"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Coefficient poly -&gt; ShowSCoeff
</span><a href="#local-6989586621679381286"><span class="hs-identifier hs-var">showsCoe</span></a></span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) String
</span><a href="#local-6989586621679381285"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381284"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381283"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span id="local-6989586621679381763"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith"><span class="hs-identifier hs-type">showsPolynomialWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381763"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381763"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381763"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.String</span></span><span>
</span><span id="line-586"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-587"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381763"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-588"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.ShowS</span></span></span><span>
</span><span id="line-589"></span><span id="showsPolynomialWith"><span class="annot"><span class="annottext">showsPolynomialWith :: Sized (Arity poly) String -&gt; Int -&gt; poly -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith"><span class="hs-identifier hs-var hs-var">showsPolynomialWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (Int -&gt; Coefficient poly -&gt; ShowSCoeff)
-&gt; Sized (Arity poly) String
-&gt; Int
-&gt; poly
-&gt; ShowS
forall poly.
IsOrderedPolynomial poly =&gt;
Bool
-&gt; (Int -&gt; Coefficient poly -&gt; ShowSCoeff)
-&gt; Sized (Arity poly) String
-&gt; Int
-&gt; poly
-&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith%27"><span class="hs-identifier hs-var">showsPolynomialWith&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Coefficient poly -&gt; ShowSCoeff
forall r. PrettyCoeff r =&gt; Int -&gt; r -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-var">showsCoeff</span></a></span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span id="local-6989586621679381761"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith%27"><span class="hs-identifier hs-type">showsPolynomialWith&#39;</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381761"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-593"></span><span>                        </span><span class="hs-comment">-- ^ Whether print multiplication as @*@ or not.</span><span>
</span><span id="line-594"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381761"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier hs-type">ShowSCoeff</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>                        </span><span class="hs-comment">-- ^ Coefficient printer</span><span>
</span><span id="line-596"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381761"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.String</span></span><span>
</span><span id="line-597"></span><span>                        </span><span class="hs-comment">-- ^ Variables</span><span>
</span><span id="line-598"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-599"></span><span>                        </span><span class="hs-comment">-- ^ Precision</span><span>
</span><span id="line-600"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381761"><span class="hs-identifier hs-type">poly</span></a></span><span>
</span><span id="line-601"></span><span>                        </span><span class="hs-comment">-- ^ Polynomial</span><span>
</span><span id="line-602"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.ShowS</span></span></span><span>
</span><span id="line-603"></span><span id="showsPolynomialWith%27"><span class="annot"><span class="annottext">showsPolynomialWith&#39; :: Bool
-&gt; (Int -&gt; Coefficient poly -&gt; ShowSCoeff)
-&gt; Sized (Arity poly) String
-&gt; Int
-&gt; poly
-&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsPolynomialWith%27"><span class="hs-identifier hs-var hs-var">showsPolynomialWith&#39;</span></a></span></span><span> </span><span id="local-6989586621679381282"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679381282"><span class="hs-identifier hs-var">showMult</span></a></span></span><span> </span><span id="local-6989586621679381281"><span class="annot"><span class="annottext">Int -&gt; Coefficient poly -&gt; ShowSCoeff
</span><a href="#local-6989586621679381281"><span class="hs-identifier hs-var">showsCoe</span></a></span></span><span> </span><span id="local-6989586621679381280"><span class="annot"><span class="annottext">Sized (Arity poly) String
</span><a href="#local-6989586621679381280"><span class="hs-identifier hs-var">vsVec</span></a></span></span><span> </span><span id="local-6989586621679381279"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381279"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679381278"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381278"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679381279"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">P.&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381277"><span class="annot"><span class="annottext">tms :: [(Maybe ShowS, ShowSCoeff)]
</span><a href="#local-6989586621679381277"><span class="hs-identifier hs-var hs-var">tms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((OrderedMonomial (MOrder poly) (Arity poly), Coefficient poly)
 -&gt; (Maybe ShowS, ShowSCoeff))
-&gt; [(OrderedMonomial (MOrder poly) (Arity poly), Coefficient poly)]
-&gt; [(Maybe ShowS, ShowSCoeff)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Maybe ShowS
</span><a href="#local-6989586621679381276"><span class="hs-identifier hs-var">showMonom</span></a></span><span> </span><span class="annot"><span class="annottext">(OrderedMonomial (MOrder poly) (Arity poly) -&gt; Maybe ShowS)
-&gt; (Coefficient poly -&gt; ShowSCoeff)
-&gt; (OrderedMonomial (MOrder poly) (Arity poly), Coefficient poly)
-&gt; (Maybe ShowS, ShowSCoeff)
forall (a :: * -&gt; * -&gt; *) b c b&#39; c&#39;.
Arrow a =&gt;
a b c -&gt; a b&#39; c&#39; -&gt; a (b, b&#39;) (c, c&#39;)
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Coefficient poly -&gt; ShowSCoeff
</span><a href="#local-6989586621679381281"><span class="hs-identifier hs-var">showsCoe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(OrderedMonomial (MOrder poly) (Arity poly), Coefficient poly)]
 -&gt; [(Maybe ShowS, ShowSCoeff)])
-&gt; [(OrderedMonomial (MOrder poly) (Arity poly), Coefficient poly)]
-&gt; [(Maybe ShowS, ShowSCoeff)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; [(OrderedMonomial (MOrder poly) (Arity poly), Coefficient poly)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toDescList</span></span><span> </span><span class="annot"><span class="annottext">(Map
   (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
 -&gt; [(OrderedMonomial (MOrder poly) (Arity poly),
      Coefficient poly)])
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; [(OrderedMonomial (MOrder poly) (Arity poly), Coefficient poly)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms"><span class="hs-identifier hs-var">terms</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381278"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Maybe ShowS, ShowSCoeff)]
</span><a href="#local-6989586621679381277"><span class="hs-identifier hs-var">tms</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-606"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span>
</span><span id="line-607"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679381273"><span class="annot"><span class="annottext">(Maybe ShowS, ShowSCoeff)
</span><a href="#local-6989586621679381273"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679381272"><span class="annot"><span class="annottext">[(Maybe ShowS, ShowSCoeff)]
</span><a href="#local-6989586621679381272"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS -&gt; ShowS) -&gt; [ShowS] -&gt; ShowS
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">P.foldr1</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">([ShowS] -&gt; ShowS) -&gt; [ShowS] -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ShowS, ShowSCoeff) -&gt; ShowS
</span><a href="#local-6989586621679381270"><span class="hs-identifier hs-var">showTermOnly</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ShowS, ShowSCoeff)
</span><a href="#local-6989586621679381273"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; [ShowS] -&gt; [ShowS]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((Maybe ShowS, ShowSCoeff) -&gt; ShowS)
-&gt; [(Maybe ShowS, ShowSCoeff)] -&gt; [ShowS]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ShowS, ShowSCoeff) -&gt; ShowS
</span><a href="#local-6989586621679381269"><span class="hs-identifier hs-var">showRestTerm</span></a></span><span> </span><span class="annot"><span class="annottext">[(Maybe ShowS, ShowSCoeff)]
</span><a href="#local-6989586621679381272"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-609"></span><span>    </span><span id="local-6989586621679381270"><span class="annot"><span class="annottext">showTermOnly :: (Maybe ShowS, ShowSCoeff) -&gt; ShowS
</span><a href="#local-6989586621679381270"><span class="hs-identifier hs-var hs-var">showTermOnly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ShowS
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">P.id</span></span><span>
</span><span id="line-610"></span><span>    </span><span class="annot"><a href="#local-6989586621679381270"><span class="hs-identifier hs-var">showTermOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ShowS
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381268"><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381268"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier hs-var">showsCoeffAsTerm</span></a></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381268"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span class="annot"><a href="#local-6989586621679381270"><span class="hs-identifier hs-var">showTermOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679381267"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381267"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#OneCoeff"><span class="hs-identifier hs-var">OneCoeff</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381267"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><a href="#local-6989586621679381270"><span class="hs-identifier hs-var">showTermOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679381266"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381266"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-type">Negative</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ShowS
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">&#39;-&#39;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381266"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><a href="#local-6989586621679381270"><span class="hs-identifier hs-var">showTermOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">P.id</span></span><span>
</span><span id="line-614"></span><span>    </span><span class="annot"><a href="#local-6989586621679381270"><span class="hs-identifier hs-var">showTermOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679381265"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381265"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381264"><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381264"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffAsTerm"><span class="hs-identifier hs-var">showsCoeffAsTerm</span></a></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381264"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679381263"><span class="hs-identifier hs-var">multSymb</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381265"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-615"></span><span>    </span><span id="local-6989586621679381269"><span class="annot"><span class="annottext">showRestTerm :: (Maybe ShowS, ShowSCoeff) -&gt; ShowS
</span><a href="#local-6989586621679381269"><span class="hs-identifier hs-var hs-var">showRestTerm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ShowS
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">P.id</span></span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><a href="#local-6989586621679381269"><span class="hs-identifier hs-var">showRestTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ShowS
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381262"><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381262"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier hs-var">showsCoeffWithOp</span></a></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381262"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><a href="#local-6989586621679381269"><span class="hs-identifier hs-var">showRestTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679381261"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381261"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#OneCoeff"><span class="hs-identifier hs-var">OneCoeff</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; + &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381261"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><a href="#local-6989586621679381269"><span class="hs-identifier hs-var">showRestTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679381260"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381260"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Negative"><span class="hs-identifier hs-type">Negative</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ShowS
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; - &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381260"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-619"></span><span>    </span><span class="annot"><a href="#local-6989586621679381269"><span class="hs-identifier hs-var">showRestTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">P.id</span></span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><a href="#local-6989586621679381269"><span class="hs-identifier hs-var">showRestTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679381259"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381259"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381258"><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381258"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff -&gt; ShowS
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeffWithOp"><span class="hs-identifier hs-var">showsCoeffWithOp</span></a></span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="#local-6989586621679381258"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679381263"><span class="hs-identifier hs-var">multSymb</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679381259"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-621"></span><span>    </span><span id="local-6989586621679381257"><span class="annot"><span class="annottext">vs :: [String]
</span><a href="#local-6989586621679381257"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) String -&gt; [String]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">Sized (Arity poly) String
</span><a href="#local-6989586621679381280"><span class="hs-identifier hs-var">vsVec</span></a></span><span>
</span><span id="line-622"></span><span>    </span><span id="local-6989586621679381263"><span class="annot"><span class="annottext">multSymb :: Char
</span><a href="#local-6989586621679381263"><span class="hs-identifier hs-var hs-var">multSymb</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679381282"><span class="hs-identifier hs-var">showMult</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">&#39;*&#39;</span></span><span>
</span><span id="line-623"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">&#39; &#39;</span></span><span>
</span><span id="line-624"></span><span>    </span><span id="local-6989586621679381276"><span class="annot"><span class="annottext">showMonom :: OrderedMonomial (MOrder poly) (Arity poly) -&gt; Maybe ShowS
</span><a href="#local-6989586621679381276"><span class="hs-identifier hs-var hs-var">showMonom</span></a></span></span><span> </span><span id="local-6989586621679381256"><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381256"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-625"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381255"><span class="annot"><span class="annottext">fs :: [String]
</span><a href="#local-6989586621679381255"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe String] -&gt; [String]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe String] -&gt; [String]) -&gt; [Maybe String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int -&gt; Maybe String)
-&gt; [String] -&gt; [Int] -&gt; [Maybe String]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">P.zipWith</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Maybe String
forall a. (Eq a, Num a, Show a) =&gt; String -&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679381252"><span class="hs-identifier hs-var">showFactor</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679381257"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Maybe String]) -&gt; [Int] -&gt; [Maybe String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Monomial (Arity poly) -&gt; [Element (Monomial (Arity poly))]
forall mono. MonoFoldable mono =&gt; mono -&gt; [Element mono]
</span><span class="hs-identifier hs-var">otoList</span></span><span> </span><span class="annot"><span class="annottext">(Monomial (Arity poly) -&gt; [Element (Monomial (Arity poly))])
-&gt; Monomial (Arity poly) -&gt; [Element (Monomial (Arity poly))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly) -&gt; Monomial (Arity poly)
forall k (ordering :: k) (n :: Nat).
OrderedMonomial ordering n -&gt; Monomial n
</span><a href="Algebra.Ring.Polynomial.Monomial.html#getMonomial"><span class="hs-identifier hs-var hs-var">getMonomial</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder poly) (Arity poly)
</span><a href="#local-6989586621679381256"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-626"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">P.null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679381255"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-627"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe ShowS
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-628"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Maybe ShowS
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; Maybe ShowS) -&gt; ShowS -&gt; Maybe ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS -&gt; ShowS) -&gt; ShowS -&gt; [ShowS] -&gt; ShowS
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">P.id</span></span><span> </span><span class="annot"><span class="annottext">([ShowS] -&gt; ShowS) -&gt; [ShowS] -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; [ShowS] -&gt; [ShowS]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.intersperse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679381263"><span class="hs-identifier hs-var">multSymb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; ShowS) -&gt; [String] -&gt; [ShowS]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">P.showString</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679381255"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621679381252"><span class="annot"><span class="annottext">showFactor :: String -&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679381252"><span class="hs-identifier hs-var hs-var">showFactor</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><a href="#local-6989586621679381252"><span class="hs-identifier hs-var">showFactor</span></a></span><span> </span><span id="local-6989586621679381249"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679381249"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679381249"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><a href="#local-6989586621679381252"><span class="hs-identifier hs-var">showFactor</span></a></span><span> </span><span id="local-6989586621679381248"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679381248"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679381247"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679381247"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; String -&gt; Maybe String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679381248"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">P.++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;^&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">P.++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">P.show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679381247"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-comment">-- | Calculate a polynomial quotient and remainder w.r.t. second argument.</span><span>
</span><span id="line-634"></span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-identifier hs-type">divModPolynomial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679381719"><span class="annot"><a href="#local-6989586621679381719"><span class="hs-identifier hs-type">poly</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381719"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381719"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381719"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679381719"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-636"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381719"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679381719"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679381719"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span id="divModPolynomial"><span class="annot"><span class="annottext">divModPolynomial :: poly -&gt; [poly] -&gt; ([(poly, poly)], poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-identifier hs-var hs-var">divModPolynomial</span></a></span></span><span> </span><span id="local-6989586621679381245"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381245"><span class="hs-identifier hs-var">f0</span></a></span></span><span> </span><span id="local-6989586621679381244"><span class="annot"><span class="annottext">[poly]
</span><a href="#local-6989586621679381244"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly
-&gt; poly
-&gt; [(((Coefficient poly,
       OrderedMonomial (MOrder poly) (Arity poly)),
      poly),
     poly)]
-&gt; ([(poly, poly)], poly)
forall r t.
(IsOrderedPolynomial r, IsOrderedPolynomial t,
 Euclidean (Coefficient r), Division (Coefficient r),
 Coefficient t ~ Coefficient r, MOrder r ~ MOrder t) =&gt;
r
-&gt; t
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
-&gt; ([(r, r)], t)
</span><a href="#local-6989586621679381243"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381245"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
  poly)]
-&gt; [poly]
-&gt; [(((Coefficient poly,
       OrderedMonomial (MOrder poly) (Arity poly)),
      poly),
     poly)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">P.zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(poly
 -&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
     poly))
-&gt; [poly]
-&gt; [((Coefficient poly,
      OrderedMonomial (MOrder poly) (Arity poly)),
     poly)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#splitLeadingTerm"><span class="hs-identifier hs-var">splitLeadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">([poly]
 -&gt; [((Coefficient poly,
       OrderedMonomial (MOrder poly) (Arity poly)),
      poly)])
-&gt; [poly]
-&gt; [((Coefficient poly,
      OrderedMonomial (MOrder poly) (Arity poly)),
     poly)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[poly] -&gt; [poly]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.nub</span></span><span> </span><span class="annot"><span class="annottext">[poly]
</span><a href="#local-6989586621679381244"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; [poly]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">P.repeat</span></span><span> </span><span class="annot"><span class="annottext">poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-639"></span><span>    </span><span id="local-6989586621679381243"><span class="annot"><span class="annottext">loop :: r
-&gt; t
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
-&gt; ([(r, r)], t)
</span><a href="#local-6989586621679381243"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679381240"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381240"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679381239"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679381239"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679381238"><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381238"><span class="hs-identifier hs-var">dic</span></a></span></span><span>
</span><span id="line-640"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381240"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
 -&gt; (r, r))
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
-&gt; [(r, r)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(((Coefficient r, OrderedMonomial (MOrder r) (Arity r)), r) -&gt; r)
-&gt; (((Coefficient r, OrderedMonomial (MOrder r) (Arity r)), r), r)
-&gt; (r, r)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((((Coefficient r, OrderedMonomial (MOrder r) (Arity r)), r) -&gt; r)
 -&gt; (((Coefficient r, OrderedMonomial (MOrder r) (Arity r)), r), r)
 -&gt; (r, r))
-&gt; (((Coefficient r, OrderedMonomial (MOrder r) (Arity r)), r)
    -&gt; r)
-&gt; (((Coefficient r, OrderedMonomial (MOrder r) (Arity r)), r), r)
-&gt; (r, r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679381237"><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder r) (Arity r))
</span><a href="#local-6989586621679381237"><span class="hs-identifier hs-var">lt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381236"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381236"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder r) (Arity r)) -&gt; r
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder r) (Arity r))
</span><a href="#local-6989586621679381237"><span class="hs-identifier hs-var">lt</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381236"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381238"><span class="hs-identifier hs-var">dic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679381239"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-642"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381235"><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
</span><a href="#local-6989586621679381235"><span class="hs-identifier hs-var">ltP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381234"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381234"><span class="hs-identifier hs-var">p&#39;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; ((Coefficient r, OrderedMonomial (MOrder r) (Arity r)), r)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#splitLeadingTerm"><span class="hs-identifier hs-var">splitLeadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381240"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-643"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
 -&gt; Bool)
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
-&gt; ([(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
      r)],
    [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">L.break</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrderedMonomial (MOrder t) (Arity r)
-&gt; OrderedMonomial (MOrder t) (Arity r) -&gt; Bool
forall k (n :: Nat) (ord :: k).
KnownNat n =&gt;
OrderedMonomial ord n -&gt; OrderedMonomial ord n -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Monomial.html#divs"><span class="hs-operator hs-var">`divs`</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
-&gt; OrderedMonomial (MOrder t) (Arity r)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
</span><a href="#local-6989586621679381235"><span class="hs-identifier hs-var">ltP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OrderedMonomial (MOrder t) (Arity r) -&gt; Bool)
-&gt; ((((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
    -&gt; OrderedMonomial (MOrder t) (Arity r))
-&gt; (((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
-&gt; OrderedMonomial (MOrder t) (Arity r)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Coefficient r, OrderedMonomial (MOrder t) (Arity r))
 -&gt; OrderedMonomial (MOrder t) (Arity r))
-&gt; ((((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
    -&gt; (Coefficient r, OrderedMonomial (MOrder t) (Arity r)))
-&gt; (((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
-&gt; OrderedMonomial (MOrder t) (Arity r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r)
-&gt; (Coefficient r, OrderedMonomial (MOrder t) (Arity r))
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r)
 -&gt; (Coefficient r, OrderedMonomial (MOrder t) (Arity r)))
-&gt; ((((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
    -&gt; ((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r))
-&gt; (((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
-&gt; (Coefficient r, OrderedMonomial (MOrder t) (Arity r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
-&gt; ((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381238"><span class="hs-identifier hs-var">dic</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-644"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
-&gt; t
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
-&gt; ([(r, r)], t)
</span><a href="#local-6989586621679381243"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381234"><span class="hs-identifier hs-var">p&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679381239"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient t, OrderedMonomial (MOrder t) (Arity t)) -&gt; t
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient t, OrderedMonomial (MOrder t) (Arity t))
(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
</span><a href="#local-6989586621679381235"><span class="hs-identifier hs-var">ltP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381238"><span class="hs-identifier hs-var">dic</span></a></span><span>
</span><span id="line-645"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621679381232"><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381232"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679381231"><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
</span><a href="#local-6989586621679381231"><span class="hs-identifier hs-var">ltG</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381230"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381230"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381229"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381229"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679381228"><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381228"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-646"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381227"><span class="annot"><span class="annottext">q :: r
</span><a href="#local-6989586621679381227"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder r) (Arity r)) -&gt; r
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="annot"><span class="annottext">((Coefficient r, OrderedMonomial (MOrder r) (Arity r)) -&gt; r)
-&gt; (Coefficient r, OrderedMonomial (MOrder r) (Arity r)) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
</span><a href="#local-6989586621679381235"><span class="hs-identifier hs-var">ltP</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
-&gt; (Coefficient r, OrderedMonomial (MOrder t) (Arity r))
-&gt; (Coefficient r, OrderedMonomial (MOrder t) (Arity r))
forall k (n :: Nat) r (ord :: k).
(KnownNat n, Field r) =&gt;
(r, OrderedMonomial ord n)
-&gt; (r, OrderedMonomial ord n) -&gt; (r, OrderedMonomial ord n)
</span><a href="Algebra.Ring.Polynomial.Monomial.html#tryDiv"><span class="hs-operator hs-var">`tryDiv`</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
</span><a href="#local-6989586621679381231"><span class="hs-identifier hs-var">ltG</span></a></span><span>
</span><span id="line-647"></span><span>                         </span><span id="local-6989586621679381226"><span class="annot"><span class="annottext">dic&#39; :: [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381226"><span class="hs-identifier hs-var hs-var">dic&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381232"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">P.++</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Coefficient r, OrderedMonomial (MOrder t) (Arity r))
</span><a href="#local-6989586621679381231"><span class="hs-identifier hs-var">ltG</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381230"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381229"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381227"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381228"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-648"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">r
-&gt; t
-&gt; [(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r),
     r)]
-&gt; ([(r, r)], t)
</span><a href="#local-6989586621679381243"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381234"><span class="hs-identifier hs-var">p&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381227"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381230"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679381239"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[(((Coefficient r, OrderedMonomial (MOrder t) (Arity r)), r), r)]
</span><a href="#local-6989586621679381226"><span class="hs-identifier hs-var">dic&#39;</span></a></span><span>
</span><span id="line-649"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-pragma hs-type">divModPolynomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="hs-comment">-- | Remainder of given polynomial w.r.t. the second argument.</span><span>
</span><span id="line-652"></span><span id="local-6989586621679381224"><span id="local-6989586621679381225"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#modPolynomial"><span class="hs-identifier hs-type">modPolynomial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381225"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381225"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679381224"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679381224"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381225"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381224"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381225"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381225"><span class="hs-identifier hs-type">poly</span></a></span></span></span><span>
</span><span id="line-654"></span><span id="modPolynomial"><span class="annot"><span class="annottext">modPolynomial :: poly -&gt; t poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#modPolynomial"><span class="hs-identifier hs-var hs-var">modPolynomial</span></a></span></span><span> </span><span id="local-6989586621679381223"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381223"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679381222"><span class="annot"><span class="annottext">t poly
</span><a href="#local-6989586621679381222"><span class="hs-identifier hs-var">rs0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
</span><a href="#local-6989586621679381221"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381223"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">poly
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">zero</span></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621679381220"><span class="annot"><span class="annottext">rs :: t ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
   poly)
</span><a href="#local-6989586621679381220"><span class="hs-identifier hs-var hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(poly
 -&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
     poly))
-&gt; t poly
-&gt; t ((Coefficient poly,
       OrderedMonomial (MOrder poly) (Arity poly)),
      poly)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#splitLeadingTerm"><span class="hs-identifier hs-var">splitLeadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">t poly
</span><a href="#local-6989586621679381222"><span class="hs-identifier hs-var">rs0</span></a></span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621679381219"><span class="annot"><span class="annottext">step :: b
-&gt; ((Coefficient b, OrderedMonomial (MOrder b) (Arity b)), b)
-&gt; m b
</span><a href="#local-6989586621679381219"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679381218"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679381218"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381217"><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381217"><span class="hs-identifier hs-var">ltQ</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381216"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679381216"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-658"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381215"><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381215"><span class="hs-identifier hs-var">ltR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381214"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679381214"><span class="hs-identifier hs-var">r&#39;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; ((Coefficient b, OrderedMonomial (MOrder b) (Arity b)), b)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#splitLeadingTerm"><span class="hs-identifier hs-var">splitLeadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679381218"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-659"></span><span>          </span><span id="local-6989586621679381213"><span class="annot"><span class="annottext">lt :: (Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381213"><span class="hs-identifier hs-var hs-var">lt</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381215"><span class="hs-identifier hs-var">ltR</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
-&gt; (Coefficient b, OrderedMonomial (MOrder b) (Arity b))
-&gt; (Coefficient b, OrderedMonomial (MOrder b) (Arity b))
forall k (n :: Nat) r (ord :: k).
(KnownNat n, Field r) =&gt;
(r, OrderedMonomial ord n)
-&gt; (r, OrderedMonomial ord n) -&gt; (r, OrderedMonomial ord n)
</span><a href="Algebra.Ring.Polynomial.Monomial.html#tryDiv"><span class="hs-operator hs-var">`tryDiv`</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381217"><span class="hs-identifier hs-var">ltQ</span></a></span><span>
</span><span id="line-660"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m ()) -&gt; Bool -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679381218"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Coefficient b -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
-&gt; Coefficient b
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381217"><span class="hs-identifier hs-var">ltQ</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
-&gt; OrderedMonomial (MOrder b) (Arity b)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381217"><span class="hs-identifier hs-var">ltQ</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial (MOrder b) (Arity b)
-&gt; OrderedMonomial (MOrder b) (Arity b) -&gt; Bool
forall k (n :: Nat) (ord :: k).
KnownNat n =&gt;
OrderedMonomial ord n -&gt; OrderedMonomial ord n -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Monomial.html#divs"><span class="hs-operator hs-var">`divs`</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
-&gt; OrderedMonomial (MOrder b) (Arity b)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381215"><span class="hs-identifier hs-var">ltR</span></a></span><span>
</span><span id="line-661"></span><span>      </span><span class="annot"><span class="annottext">b -&gt; m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; m b) -&gt; b -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679381214"><span class="hs-identifier hs-var">r&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b)) -&gt; b
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient b, OrderedMonomial (MOrder b) (Arity b))
</span><a href="#local-6989586621679381213"><span class="hs-identifier hs-var">lt</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679381216"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-662"></span><span>    </span><span id="local-6989586621679381221"><span class="annot"><span class="annottext">loop :: poly -&gt; poly -&gt; poly
</span><a href="#local-6989586621679381221"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679381211"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381211"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679381210"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381210"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-663"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381211"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381210"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-664"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-665"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">First poly -&gt; Maybe poly
forall a. First a -&gt; Maybe a
</span><span class="hs-identifier hs-var hs-var">getFirst</span></span><span> </span><span class="annot"><span class="annottext">(First poly -&gt; Maybe poly) -&gt; First poly -&gt; Maybe poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
  poly)
 -&gt; First poly)
-&gt; t ((Coefficient poly,
       OrderedMonomial (MOrder poly) (Arity poly)),
      poly)
-&gt; First poly
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe poly -&gt; First poly
forall a. Maybe a -&gt; First a
</span><span class="hs-identifier hs-var">First</span></span><span> </span><span class="annot"><span class="annottext">(Maybe poly -&gt; First poly)
-&gt; (((Coefficient poly,
      OrderedMonomial (MOrder poly) (Arity poly)),
     poly)
    -&gt; Maybe poly)
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
-&gt; First poly
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
-&gt; Maybe poly
forall b (m :: * -&gt; *).
(IsOrderedPolynomial b, Euclidean (Coefficient b),
 Division (Coefficient b), Monad m, Alternative m) =&gt;
b
-&gt; ((Coefficient b, OrderedMonomial (MOrder b) (Arity b)), b)
-&gt; m b
</span><a href="#local-6989586621679381219"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381211"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
   poly)
</span><a href="#local-6989586621679381220"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-666"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679381206"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381206"><span class="hs-identifier hs-var">q&#39;</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
</span><a href="#local-6989586621679381221"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381206"><span class="hs-identifier hs-var">q&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381210"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-667"></span><span>            </span><span class="annot"><span class="annottext">Maybe poly
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-668"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679381205"><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679381205"><span class="hs-identifier hs-var">lt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679381204"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381204"><span class="hs-identifier hs-var">q&#39;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; ((Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly)),
    poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#splitLeadingTerm"><span class="hs-identifier hs-var">splitLeadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381211"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-669"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
</span><a href="#local-6989586621679381221"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381204"><span class="hs-identifier hs-var">q&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381210"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; poly
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
forall poly.
IsOrderedPolynomial poly =&gt;
(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#toPolynomial"><span class="hs-identifier hs-var">toPolynomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="#local-6989586621679381205"><span class="hs-identifier hs-var">lt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span id="local-6989586621679381203"><span class="hs-pragma">{-# SPECIALISE</span><span>
</span><span id="line-671"></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#modPolynomial"><span class="hs-pragma hs-type">modPolynomial</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-pragma hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381203"><span class="hs-pragma hs-type">poly</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Field</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-pragma hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381203"><span class="hs-pragma hs-type">poly</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span>
</span><span id="line-672"></span><span>                </span><span class="hs-pragma">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381203"><span class="hs-pragma hs-type">poly</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="#local-6989586621679381203"><span class="hs-pragma hs-type">poly</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381203"><span class="hs-pragma hs-type">poly</span></a></span><span>
</span><span id="line-673"></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-676"></span><span class="annot"><span class="hs-pragma">&quot;snd . divModPolynomial&quot;</span></span><span>
</span><span id="line-677"></span><span>  </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">snd</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span class="hs-pragma">)</span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-pragma hs-type">divModPolynomial</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#modPolynomial"><span class="hs-pragma hs-type">modPolynomial</span></a></span><span>
</span><span id="line-678"></span><span class="annot"><span class="hs-pragma">&quot;snd . divModPolynomial p&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679381202"><span class="annot"><a href="#local-6989586621679381202"><span class="hs-pragma hs-var">p</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-679"></span><span>  </span><span class="annot"><span class="hs-pragma hs-type">snd</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-pragma hs-type">divModPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381202"><span class="hs-pragma hs-type">p</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#modPolynomial"><span class="hs-pragma hs-type">modPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381202"><span class="hs-pragma hs-type">p</span></a></span><span>
</span><span id="line-680"></span><span class="annot"><span class="hs-pragma">&quot;snd (divModPolynomial p qs)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679381201"><span class="annot"><a href="#local-6989586621679381201"><span class="hs-pragma hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679381200"><span class="annot"><a href="#local-6989586621679381200"><span class="hs-pragma hs-var">qs</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-681"></span><span>  </span><span class="annot"><span class="hs-pragma hs-type">snd</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-pragma hs-type">divModPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381201"><span class="hs-pragma hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381200"><span class="hs-pragma hs-type">qs</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#modPolynomial"><span class="hs-pragma hs-type">modPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381201"><span class="hs-pragma hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381200"><span class="hs-pragma hs-type">qs</span></a></span><span>
</span><span id="line-682"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span class="hs-comment">-- | A Quotient of given polynomial w.r.t. the second argument.</span><span>
</span><span id="line-685"></span><span id="local-6989586621679381199"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divPolynomial"><span class="hs-identifier hs-type">divPolynomial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381199"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381199"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381199"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679381199"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381199"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679381199"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-687"></span><span id="divPolynomial"><span class="annot"><span class="annottext">divPolynomial :: poly -&gt; [poly] -&gt; [(poly, poly)]
</span><a href="Algebra.Ring.Polynomial.Class.html#divPolynomial"><span class="hs-identifier hs-var hs-var">divPolynomial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(poly, poly)], poly) -&gt; [(poly, poly)]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(([(poly, poly)], poly) -&gt; [(poly, poly)])
-&gt; ([poly] -&gt; ([(poly, poly)], poly)) -&gt; [poly] -&gt; [(poly, poly)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([poly] -&gt; ([(poly, poly)], poly)) -&gt; [poly] -&gt; [(poly, poly)])
-&gt; (poly -&gt; [poly] -&gt; ([(poly, poly)], poly))
-&gt; poly
-&gt; [poly]
-&gt; [(poly, poly)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; [poly] -&gt; ([(poly, poly)], poly)
forall poly.
(IsOrderedPolynomial poly, Field (Coefficient poly)) =&gt;
poly -&gt; [poly] -&gt; ([(poly, poly)], poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-identifier hs-var">divModPolynomial</span></a></span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divPolynomial"><span class="hs-operator hs-type">`divPolynomial`</span></a></span><span>
</span><span id="line-690"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#modPolynomial"><span class="hs-operator hs-type">`modPolynomial`</span></a></span><span>
</span><span id="line-691"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#divModPolynomial"><span class="hs-operator hs-type">`divModPolynomial`</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span id="local-6989586621679381712"><span id="local-6989586621679381713"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#isUnitDefault"><span class="hs-identifier hs-type">isUnitDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecidableUnits</span></span><span> </span><span class="annot"><a href="#local-6989586621679381713"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381712"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679381713"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381712"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381712"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-695"></span><span id="isUnitDefault"><span class="annot"><span class="annottext">isUnitDefault :: poly -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Class.html#isUnitDefault"><span class="hs-identifier hs-var hs-var">isUnitDefault</span></a></span></span><span> </span><span id="local-6989586621679381198"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381198"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><a href="Algebra.Ring.Polynomial.Class.html#totalDegree%27"><span class="hs-identifier hs-var">totalDegree&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381198"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Bool
forall r. DecidableUnits r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isUnit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly. IsPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#constantTerm"><span class="hs-identifier hs-var">constantTerm</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381198"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span id="local-6989586621679381195"><span id="local-6989586621679381196"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#recipUnitDefault"><span class="hs-identifier hs-type">recipUnitDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecidableUnits</span></span><span> </span><span class="annot"><a href="#local-6989586621679381196"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381195"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679381196"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsPolynomial"><span class="hs-identifier hs-type">IsPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381195"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381195"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679381195"><span class="hs-identifier hs-type">poly</span></a></span></span></span><span>
</span><span id="line-699"></span><span id="recipUnitDefault"><span class="annot"><span class="annottext">recipUnitDefault :: poly -&gt; Maybe poly
</span><a href="Algebra.Ring.Polynomial.Class.html#recipUnitDefault"><span class="hs-identifier hs-var hs-var">recipUnitDefault</span></a></span></span><span> </span><span id="local-6989586621679381194"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381194"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-700"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">poly -&gt; Bool
forall r poly.
(DecidableUnits r, Coefficient poly ~ r, IsPolynomial poly) =&gt;
poly -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Class.html#isUnitDefault"><span class="hs-identifier hs-var">isUnitDefault</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381194"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; poly) -&gt; Maybe r -&gt; Maybe poly
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; poly
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff"><span class="hs-identifier hs-var">injectCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe r -&gt; Maybe poly) -&gt; Maybe r -&gt; Maybe poly
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Maybe r
forall r. DecidableUnits r =&gt; r -&gt; Maybe r
</span><span class="hs-identifier hs-var">recipUnit</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Maybe r) -&gt; r -&gt; Maybe r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly. IsPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#constantTerm"><span class="hs-identifier hs-var">constantTerm</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381194"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-701"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe poly
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span id="local-6989586621679381191"><span id="local-6989586621679381192"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#isAssociateDefault"><span class="hs-identifier hs-type">isAssociateDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnitNormalForm</span></span><span> </span><span class="annot"><a href="#local-6989586621679381192"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381191"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679381192"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381191"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381191"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381191"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-705"></span><span id="isAssociateDefault"><span class="annot"><span class="annottext">isAssociateDefault :: poly -&gt; poly -&gt; Bool
</span><a href="Algebra.Ring.Polynomial.Class.html#isAssociateDefault"><span class="hs-identifier hs-var hs-var">isAssociateDefault</span></a></span></span><span> </span><span id="local-6989586621679381190"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381190"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679381189"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381189"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381188"><span class="annot"><span class="annottext">up :: r
</span><a href="#local-6989586621679381188"><span class="hs-identifier hs-var hs-var">up</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe r -&gt; r
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe r -&gt; r) -&gt; Maybe r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Maybe r
forall r. DecidableUnits r =&gt; r -&gt; Maybe r
</span><span class="hs-identifier hs-var">recipUnit</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Maybe r) -&gt; r -&gt; Maybe r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. UnitNormalForm r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">leadingUnit</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(r, OrderedMonomial (MOrder poly) (Arity poly)) -&gt; r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((r, OrderedMonomial (MOrder poly) (Arity poly)) -&gt; r)
-&gt; (r, OrderedMonomial (MOrder poly) (Arity poly)) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-var">leadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381190"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-707"></span><span>      </span><span id="local-6989586621679381186"><span class="annot"><span class="annottext">uq :: r
</span><a href="#local-6989586621679381186"><span class="hs-identifier hs-var hs-var">uq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe r -&gt; r
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe r -&gt; r) -&gt; Maybe r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Maybe r
forall r. DecidableUnits r =&gt; r -&gt; Maybe r
</span><span class="hs-identifier hs-var">recipUnit</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Maybe r) -&gt; r -&gt; Maybe r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. UnitNormalForm r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">leadingUnit</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(r, OrderedMonomial (MOrder poly) (Arity poly)) -&gt; r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((r, OrderedMonomial (MOrder poly) (Arity poly)) -&gt; r)
-&gt; (r, OrderedMonomial (MOrder poly) (Arity poly)) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; (Coefficient poly, OrderedMonomial (MOrder poly) (Arity poly))
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingTerm"><span class="hs-identifier hs-var">leadingTerm</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381189"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-708"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
Coefficient poly
</span><a href="#local-6989586621679381188"><span class="hs-identifier hs-var">up</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; poly -&gt; poly
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#%21%2A"><span class="hs-operator hs-var">!*</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381189"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">poly -&gt; poly -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
Coefficient poly
</span><a href="#local-6989586621679381186"><span class="hs-identifier hs-var">uq</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; poly -&gt; poly
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#%21%2A"><span class="hs-operator hs-var">!*</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381190"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span id="local-6989586621679381184"><span id="local-6989586621679381185"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#splitUnitDefault"><span class="hs-identifier hs-type">splitUnitDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnitNormalForm</span></span><span> </span><span class="annot"><a href="#local-6989586621679381185"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381184"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679381185"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381184"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381184"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679381184"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679381184"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-712"></span><span id="splitUnitDefault"><span class="annot"><span class="annottext">splitUnitDefault :: poly -&gt; (poly, poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#splitUnitDefault"><span class="hs-identifier hs-var hs-var">splitUnitDefault</span></a></span></span><span> </span><span id="local-6989586621679381183"><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381183"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679381182"><span class="annot"><span class="annottext">u :: r
</span><a href="#local-6989586621679381182"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. UnitNormalForm r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">leadingUnit</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Coefficient poly
forall poly. IsOrderedPolynomial poly =&gt; poly -&gt; Coefficient poly
</span><a href="Algebra.Ring.Polynomial.Class.html#leadingCoeff"><span class="hs-identifier hs-var">leadingCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381183"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-714"></span><span>      </span><span id="local-6989586621679381181"><span class="annot"><span class="annottext">u&#39; :: r
</span><a href="#local-6989586621679381181"><span class="hs-identifier hs-var hs-var">u&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe r -&gt; r
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe r -&gt; r) -&gt; Maybe r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Maybe r
forall r. DecidableUnits r =&gt; r -&gt; Maybe r
</span><span class="hs-identifier hs-var">recipUnit</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679381182"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coefficient poly -&gt; poly
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#injectCoeff"><span class="hs-identifier hs-var">injectCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">r
Coefficient poly
</span><a href="#local-6989586621679381182"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
Coefficient poly
</span><a href="#local-6989586621679381181"><span class="hs-identifier hs-var">u&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; poly -&gt; poly
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#%21%2A"><span class="hs-operator hs-var">!*</span></a></span><span> </span><span class="annot"><span class="annottext">poly
</span><a href="#local-6989586621679381183"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span class="hs-comment">-- | Conversion between polynomials with the same monomial orderings,</span><span>
</span><span id="line-719"></span><span class="hs-comment">--   coefficents and variables.</span><span>
</span><span id="line-720"></span><span id="local-6989586621679381179"><span id="local-6989586621679381180"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial"><span class="hs-identifier hs-type">convertPolynomial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381180"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381179"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span>
</span><span id="line-721"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381180"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381179"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span>
</span><span id="line-722"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381180"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#MOrder"><span class="hs-identifier hs-type">MOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381179"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381180"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381179"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span>
</span><span id="line-723"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-724"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381180"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381179"><span class="hs-identifier hs-type">poly&#39;</span></a></span></span></span><span>
</span><span id="line-725"></span><span id="convertPolynomial"><span class="annot"><span class="annottext">convertPolynomial :: poly -&gt; poly&#39;
</span><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial"><span class="hs-identifier hs-var hs-var">convertPolynomial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (OrderedMonomial (MOrder poly&#39;) (Arity poly&#39;)) (Coefficient poly&#39;)
-&gt; poly&#39;
forall poly.
IsOrderedPolynomial poly =&gt;
Map (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
-&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#polynomial"><span class="hs-identifier hs-var">polynomial</span></a></span><span> </span><span class="annot"><span class="annottext">(Map
   (OrderedMonomial (MOrder poly&#39;) (Arity poly&#39;)) (Coefficient poly&#39;)
 -&gt; poly&#39;)
-&gt; (poly
    -&gt; Map
         (OrderedMonomial (MOrder poly&#39;) (Arity poly&#39;)) (Coefficient poly&#39;))
-&gt; poly
-&gt; poly&#39;
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly
-&gt; Map
     (OrderedMonomial (MOrder poly&#39;) (Arity poly&#39;)) (Coefficient poly&#39;)
forall poly.
IsOrderedPolynomial poly =&gt;
poly
-&gt; Map
     (OrderedMonomial (MOrder poly) (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms"><span class="hs-identifier hs-var">terms</span></a></span><span>
</span><span id="line-726"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">3</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial"><span class="hs-pragma hs-type">convertPolynomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-727"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-728"></span><span class="annot"><span class="hs-pragma">&quot;convertPolynomial id&quot;</span></span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">3</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial"><span class="hs-pragma hs-type">convertPolynomial</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">id</span></span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-730"></span><span>
</span><span id="line-731"></span><span class="hs-comment">-- | Conversion between polynomials with the same monomial coefficents and variables.</span><span>
</span><span id="line-732"></span><span id="local-6989586621679381177"><span id="local-6989586621679381178"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial%27"><span class="hs-identifier hs-type">convertPolynomial&#39;</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381178"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381177"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span>
</span><span id="line-733"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381178"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381177"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span>
</span><span id="line-734"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381178"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381177"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span>
</span><span id="line-735"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381178"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381177"><span class="hs-identifier hs-type">poly&#39;</span></a></span></span></span><span>
</span><span id="line-737"></span><span id="convertPolynomial%27"><span class="annot"><span class="annottext">convertPolynomial&#39; :: poly -&gt; poly&#39;
</span><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial%27"><span class="hs-identifier hs-var hs-var">convertPolynomial&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Sized Vector (Arity poly&#39;) Int) (Coefficient poly&#39;) -&gt; poly&#39;
forall poly.
IsPolynomial poly =&gt;
Map (Monomial (Arity poly)) (Coefficient poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#polynomial%27"><span class="hs-identifier hs-var">polynomial&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Sized Vector (Arity poly&#39;) Int) (Coefficient poly&#39;) -&gt; poly&#39;)
-&gt; (poly
    -&gt; Map (Sized Vector (Arity poly&#39;) Int) (Coefficient poly&#39;))
-&gt; poly
-&gt; poly&#39;
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">poly -&gt; Map (Sized Vector (Arity poly&#39;) Int) (Coefficient poly&#39;)
forall poly.
IsPolynomial poly =&gt;
poly -&gt; Map (Monomial (Arity poly)) (Coefficient poly)
</span><a href="Algebra.Ring.Polynomial.Class.html#terms%27"><span class="hs-identifier hs-var">terms&#39;</span></a></span><span>
</span><span id="line-738"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">3</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial%27"><span class="hs-pragma hs-type">convertPolynomial&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-739"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-740"></span><span class="annot"><span class="hs-pragma">&quot;convertPolynomial&#39; id&quot;</span></span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">3</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#convertPolynomial%27"><span class="hs-pragma hs-type">convertPolynomial&#39;</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">id</span></span><span>
</span><span id="line-741"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-742"></span><span>
</span><span id="line-743"></span><span id="local-6989586621679381175"><span id="local-6989586621679381176"><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapPolynomial"><span class="hs-identifier hs-type">mapPolynomial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381176"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#IsOrderedPolynomial"><span class="hs-identifier hs-type">IsOrderedPolynomial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381175"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381176"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Coefficient"><span class="hs-identifier hs-type">Coefficient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381175"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381176"><span class="hs-identifier hs-type">poly</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679381175"><span class="hs-identifier hs-type">poly&#39;</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381176"><span class="hs-identifier hs-type">poly</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679381175"><span class="hs-identifier hs-type">poly&#39;</span></a></span></span></span><span>
</span><span id="line-746"></span><span id="mapPolynomial"><span class="annot"><span class="annottext">mapPolynomial :: (Coefficient poly -&gt; Coefficient poly&#39;)
-&gt; (Ordinal (Arity poly) -&gt; Ordinal (Arity poly&#39;)) -&gt; poly -&gt; poly&#39;
</span><a href="Algebra.Ring.Polynomial.Class.html#mapPolynomial"><span class="hs-identifier hs-var hs-var">mapPolynomial</span></a></span></span><span> </span><span id="local-6989586621679381174"><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly&#39;
</span><a href="#local-6989586621679381174"><span class="hs-identifier hs-var">mapCoe</span></a></span></span><span> </span><span id="local-6989586621679381173"><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; Ordinal (Arity poly&#39;)
</span><a href="#local-6989586621679381173"><span class="hs-identifier hs-var">injVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-747"></span><span>  </span><span class="annot"><span class="annottext">(Coefficient poly -&gt; poly&#39; -&gt; poly&#39;)
-&gt; Sized (Arity poly) poly&#39; -&gt; poly -&gt; poly&#39;
forall poly m.
(IsPolynomial poly, Ring m) =&gt;
(Coefficient poly -&gt; m -&gt; m) -&gt; Sized (Arity poly) m -&gt; poly -&gt; m
</span><a href="Algebra.Ring.Polynomial.Class.html#substWith"><span class="hs-identifier hs-var">substWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679381172"><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381172"><span class="hs-identifier hs-var">coe</span></a></span></span><span> </span><span id="local-6989586621679381171"><span class="annot"><span class="annottext">poly&#39;
</span><a href="#local-6989586621679381171"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coefficient poly -&gt; Coefficient poly&#39;
</span><a href="#local-6989586621679381174"><span class="hs-identifier hs-var">mapCoe</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly
</span><a href="#local-6989586621679381172"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">Coefficient poly&#39; -&gt; poly&#39; -&gt; poly&#39;
forall poly. IsPolynomial poly =&gt; Coefficient poly -&gt; poly -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#%21%2A"><span class="hs-operator hs-var">!*</span></a></span><span> </span><span class="annot"><span class="annottext">poly&#39;
</span><a href="#local-6989586621679381171"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SNat (Arity poly)
-&gt; (Ordinal (Arity poly) -&gt; poly&#39;) -&gt; Sized (Arity poly) poly&#39;
forall (f :: * -&gt; *) (n :: Nat) a.
(CFreeMonoid f, Dom f a) =&gt;
SNat n -&gt; (Ordinal n -&gt; a) -&gt; Sized f n a
</span><span class="hs-identifier hs-var">generate</span></span><span> </span><span class="annot"><span class="annottext">SNat (Arity poly)
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><span class="hs-identifier hs-var">sNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordinal (Arity poly&#39;) -&gt; poly&#39;
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><a href="Algebra.Ring.Polynomial.Class.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">(Ordinal (Arity poly&#39;) -&gt; poly&#39;)
-&gt; (Ordinal (Arity poly) -&gt; Ordinal (Arity poly&#39;))
-&gt; Ordinal (Arity poly)
-&gt; poly&#39;
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ordinal (Arity poly) -&gt; Ordinal (Arity poly&#39;)
</span><a href="#local-6989586621679381173"><span class="hs-identifier hs-var">injVar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">3</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapPolynomial"><span class="hs-pragma hs-type">mapPolynomial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-749"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-750"></span><span class="annot"><span class="hs-pragma">&quot;mapPolynomial/id&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#mapPolynomial"><span class="hs-pragma hs-type">mapPolynomial</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">id</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">id</span></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">id</span></span><span>
</span><span id="line-751"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-752"></span></pre></body></html>