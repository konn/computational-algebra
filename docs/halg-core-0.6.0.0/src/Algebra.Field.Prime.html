<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DerivingStrategies, GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving                             #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Prime fields</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DataKinds, FlexibleContexts, FlexibleInstances          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, PolyKinds, RankNTypes            #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables, TypeFamilies, UndecidableInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Field.Prime</span><span>
</span><span id="line-8"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier">F</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#naturalRepr"><span class="hs-identifier">naturalRepr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#reifyPrimeField"><span class="hs-identifier">reifyPrimeField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#withPrimeField"><span class="hs-identifier">withPrimeField</span></a></span><span>
</span><span id="line-9"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier">modNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#modNat%27"><span class="hs-identifier">modNat&#39;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#modRat"><span class="hs-identifier">modRat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#modRat%27"><span class="hs-identifier">modRat&#39;</span></a></span><span>
</span><span id="line-10"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Finite.html#FiniteField"><span class="hs-identifier">FiniteField</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Field.Finite.html#order"><span class="hs-identifier">order</span></a></span><span>
</span><span id="line-11"></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algebra.Arithmetic.html"><span class="hs-identifier">Algebra.Arithmetic</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Arithmetic.html#modPow"><span class="hs-identifier">modPow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algebra.Field.Finite.html"><span class="hs-identifier">Algebra.Field.Finite</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algebra.Normed.html"><span class="hs-identifier">Algebra.Normed</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html"><span class="hs-identifier">Algebra.Ring.Polynomial.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier">PrettyCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#ShowSCoeff"><span class="hs-identifier">ShowSCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">AlgebraicPrelude</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Random</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getRandomR</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Random</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runRand</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Random</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Random</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asProxyTypeOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Reflection</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Reifies</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">reflect</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reifyNat</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Read</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Algebra</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">char</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Algebra</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Natural</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Algebra</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NA</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Semiring.ZeroProduct</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ZeroProductSemiring</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | Prime field of characteristic @p@.</span><span>
</span><span id="line-36"></span><span class="hs-comment">--   @p@ should be prime, and not statically checked.</span><span>
</span><span id="line-37"></span><span class="hs-keyword">newtype</span><span> </span><span id="F"><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-var">F</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679377267"><span class="annot"><a href="#local-6989586621679377267"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679377268"><span class="annot"><a href="#local-6989586621679377268"><span class="hs-identifier hs-type hs-type">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="F"><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-var">F</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runF"><span class="annot"><span class="annottext">F p -&gt; Integer
</span><a href="Algebra.Field.Prime.html#runF"><span class="hs-identifier hs-var hs-var">runF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679377013"><span class="annot"><span class="annottext">F p -&gt; ()
(F p -&gt; ()) -&gt; NFData (F p)
forall a. (a -&gt; ()) -&gt; NFData a
forall k (p :: k). F p -&gt; ()
rnf :: F p -&gt; ()
$crnf :: forall k (p :: k). F p -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679377008"><span id="local-6989586621679377010"><span class="annot"><span class="annottext">Int -&gt; F p -&gt; Int
F p -&gt; Int
(Int -&gt; F p -&gt; Int) -&gt; (F p -&gt; Int) -&gt; Hashable (F p)
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
forall k (p :: k). Int -&gt; F p -&gt; Int
forall k (p :: k). F p -&gt; Int
hash :: F p -&gt; Int
$chash :: forall k (p :: k). F p -&gt; Int
hashWithSalt :: Int -&gt; F p -&gt; Int
$chashWithSalt :: forall k (p :: k). Int -&gt; F p -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Caution: just for use with Map or Sets;</span><span>
</span><span id="line-41"></span><span class="hs-comment">--   no guarantee for the compatibility with</span><span>
</span><span id="line-42"></span><span class="hs-comment">--   field structure and normal forms!</span><span>
</span><span id="line-43"></span><span id="local-6989586621679376992"><span id="local-6989586621679376994"><span id="local-6989586621679376996"><span id="local-6989586621679376998"><span id="local-6989586621679377000"><span id="local-6989586621679377002"><span id="local-6989586621679377004"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679376990"><span class="annot"><a href="#local-6989586621679376990"><span class="hs-keyword hs-type">newtype</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376990"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span id="local-6989586621679376989"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376982"><span id="local-6989586621679376985"><span id="local-6989586621679376987"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376989"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376989"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679376980"><span class="annot"><span class="annottext">readPrec :: ReadPrec (F p)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readPrec</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall r. Num r =&gt; Integer -&gt; r
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; ReadPrec Integer -&gt; ReadPrec (F p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadPrec Integer
forall a. Read a =&gt; ReadPrec a
</span><span class="hs-identifier hs-var">readPrec</span></span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span id="local-6989586621679377233"><span id="local-6989586621679377234"><span class="annot"><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-type">modNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679377233"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377234"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377233"><span class="hs-identifier hs-type">p</span></a></span></span></span><span>
</span><span id="line-50"></span><span id="modNat"><span class="annot"><span class="annottext">modNat :: Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var hs-var">modNat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (F p) -&gt; Integer -&gt; F p
forall k (proxy :: * -&gt; *) (p :: k).
Reifies p Integer =&gt;
proxy (F p) -&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat%27"><span class="hs-identifier hs-var">modNat&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy (F p)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-51"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#modNat"><span class="hs-pragma hs-type">modNat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Algebra.Field.Prime.html#modNat%27"><span class="hs-identifier hs-type">modNat&#39;</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679377278"><span class="annot"><a href="#local-6989586621679377278"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679377279"><span class="annot"><a href="#local-6989586621679377279"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679377279"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377278"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377279"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377279"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-54"></span><span id="modNat%27"><span class="annot"><span class="annottext">modNat&#39; :: proxy (F p) -&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat%27"><span class="hs-identifier hs-var hs-var">modNat&#39;</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy (F p)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679376975"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376975"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679376974"><span class="annot"><span class="annottext">p :: Integer
</span><a href="#local-6989586621679376974"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy p -&gt; Integer
forall k (s :: k) a (proxy :: k -&gt; *). Reifies s a =&gt; proxy s -&gt; a
</span><span class="hs-identifier hs-var">reflect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy p
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679377279"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376975"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`rem`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376974"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#modNat%27"><span class="hs-pragma hs-type">modNat&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span id="local-6989586621679377253"><span class="annot"><a href="Algebra.Field.Prime.html#reifyPrimeField"><span class="hs-identifier hs-type">reifyPrimeField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679377264"><span class="annot"><a href="#local-6989586621679377264"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679377264"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377264"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377253"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-60"></span><span id="reifyPrimeField"><span class="annot"><span class="annottext">reifyPrimeField :: Integer -&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; a) -&gt; a
</span><a href="Algebra.Field.Prime.html#reifyPrimeField"><span class="hs-identifier hs-var hs-var">reifyPrimeField</span></a></span></span><span> </span><span id="local-6989586621679376972"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376972"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679376971"><span class="annot"><span class="annottext">forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; a
</span><a href="#local-6989586621679376971"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; (forall (n :: Nat). KnownNat n =&gt; Proxy n -&gt; a) -&gt; a
forall r.
Integer -&gt; (forall (n :: Nat). KnownNat n =&gt; Proxy n -&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">reifyNat</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376972"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (F n) -&gt; a
forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; a
</span><a href="#local-6989586621679376971"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Proxy (F n) -&gt; a) -&gt; (Proxy n -&gt; Proxy (F n)) -&gt; Proxy n -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Proxy (F n)
forall k (a :: k). Proxy a -&gt; Proxy (F a)
</span><a href="Algebra.Field.Prime.html#proxyF"><span class="hs-identifier hs-var">proxyF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Algebra.Field.Prime.html#withPrimeField"><span class="hs-identifier hs-type">withPrimeField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679377254"><span class="annot"><a href="#local-6989586621679377254"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679377254"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377254"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-63"></span><span id="withPrimeField"><span class="annot"><span class="annottext">withPrimeField :: Integer -&gt; (forall (p :: Nat). KnownNat p =&gt; F p) -&gt; Integer
</span><a href="Algebra.Field.Prime.html#withPrimeField"><span class="hs-identifier hs-var hs-var">withPrimeField</span></a></span></span><span> </span><span id="local-6989586621679376968"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376968"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679376967"><span class="annot"><span class="annottext">forall (p :: Nat). KnownNat p =&gt; F p
</span><a href="#local-6989586621679376967"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; Integer)
-&gt; Integer
forall a.
Integer -&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; a) -&gt; a
</span><a href="Algebra.Field.Prime.html#reifyPrimeField"><span class="hs-identifier hs-var">reifyPrimeField</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376968"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; Integer)
 -&gt; Integer)
-&gt; (forall (p :: Nat). KnownNat p =&gt; Proxy (F p) -&gt; Integer)
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (p :: k). F p -&gt; Integer
</span><a href="Algebra.Field.Prime.html#runF"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">(F p -&gt; Integer) -&gt; (Proxy (F p) -&gt; F p) -&gt; Proxy (F p) -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; Proxy (F p) -&gt; F p
forall a (proxy :: * -&gt; *). a -&gt; proxy a -&gt; a
</span><span class="hs-identifier hs-var">asProxyTypeOf</span></span><span> </span><span class="annot"><span class="annottext">F p
forall (p :: Nat). KnownNat p =&gt; F p
</span><a href="#local-6989586621679376967"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621679376966"><span class="annot"><a href="Algebra.Field.Prime.html#naturalRepr"><span class="hs-identifier hs-type">naturalRepr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376966"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span>
</span><span id="line-66"></span><span id="naturalRepr"><span class="annot"><span class="annottext">naturalRepr :: F p -&gt; Integer
</span><a href="Algebra.Field.Prime.html#naturalRepr"><span class="hs-identifier hs-var hs-var">naturalRepr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (p :: k). F p -&gt; Integer
</span><a href="Algebra.Field.Prime.html#runF"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span id="local-6989586621679377255"><span id="local-6989586621679377256"><span class="annot"><a href="Algebra.Field.Prime.html#proxyF"><span class="hs-identifier hs-type">proxyF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679377255"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377256"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377255"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-69"></span><span id="proxyF"><span class="annot"><span class="annottext">proxyF :: Proxy a -&gt; Proxy (F a)
</span><a href="Algebra.Field.Prime.html#proxyF"><span class="hs-identifier hs-var hs-var">proxyF</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (F a)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="local-6989586621679376965"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376962"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376965"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376960"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376960"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679376959"><span class="annot"><span class="annottext">== :: F p -&gt; F p -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376958"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376958"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376960"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376958"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621679376957"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376957"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Normed.html#Normed"><span class="hs-identifier hs-type">Normed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376957"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Norm"><span class="annot"><a href="Algebra.Normed.html#Norm"><span class="hs-identifier hs-var">Norm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376957"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679376952"><span class="annot"><span class="annottext">norm :: F p -&gt; Norm (F p)
</span><a href="Algebra.Normed.html#norm"><span class="hs-identifier hs-var hs-var hs-var hs-var">norm</span></a></span></span><span> </span><span id="local-6989586621679376950"><span class="annot"><span class="annottext">fp :: F p
</span><a href="#local-6989586621679376950"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376949"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376949"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
Norm (F p)
</span><a href="#local-6989586621679376949"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (s :: k) a (proxy :: k -&gt; *). Reifies s a =&gt; proxy s -&gt; a
</span><span class="hs-identifier hs-var">reflect</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376950"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621679376948"><span class="annot"><span class="annottext">liftNorm :: Norm (F p) -&gt; F p
</span><a href="Algebra.Normed.html#liftNorm"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Norm (F p) -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621679376946"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679376937"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fromInteger</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679376936"><span class="annot"><span class="annottext">+ :: F p -&gt; F p -&gt; F p
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(+)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapAlgebra (F p) -&gt; WrapAlgebra (F p) -&gt; WrapAlgebra (F p))
-&gt; F p -&gt; F p -&gt; F p
</span><span class="hs-identifier hs-var">C.coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapAlgebra (F p) -&gt; WrapAlgebra (F p) -&gt; WrapAlgebra (F p)
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(P.+)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">+</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679376934"><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapAlgebra (F p) -&gt; WrapAlgebra (F p) -&gt; WrapAlgebra (F p))
-&gt; F p -&gt; F p -&gt; F p
</span><span class="hs-identifier hs-var">C.coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapAlgebra (F p) -&gt; WrapAlgebra (F p) -&gt; WrapAlgebra (F p)
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(P.-)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">-</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679376933"><span class="annot"><span class="annottext">negate :: F p -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapAlgebra (F p) -&gt; WrapAlgebra (F p)) -&gt; F p -&gt; F p
</span><span class="hs-identifier hs-var">C.coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapAlgebra (F p) -&gt; WrapAlgebra (F p)
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">P.negate</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">negate</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679376932"><span class="annot"><span class="annottext">* :: F p -&gt; F p -&gt; F p
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(*)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapAlgebra (F p) -&gt; WrapAlgebra (F p) -&gt; WrapAlgebra (F p))
-&gt; F p -&gt; F p -&gt; F p
</span><span class="hs-identifier hs-var">C.coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapAlgebra (F p) -&gt; WrapAlgebra (F p) -&gt; WrapAlgebra (F p)
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(P.*)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376946"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679376930"><span class="annot"><span class="annottext">abs :: F p -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F p -&gt; F p
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679376927"><span class="annot"><span class="annottext">signum :: F p -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621679377197"><span id="local-6989586621679377198"><span class="annot"><a href="Algebra.Field.Prime.html#pows"><span class="hs-identifier hs-type">pows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">P.Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679377198"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679377197"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377197"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377198"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377197"><span class="hs-identifier hs-type">p</span></a></span></span></span><span>
</span><span id="line-100"></span><span id="pows"><span class="annot"><span class="annottext">pows :: F p -&gt; a1 -&gt; F p
</span><a href="Algebra.Field.Prime.html#pows"><span class="hs-identifier hs-var hs-var">pows</span></a></span></span><span> </span><span id="local-6989586621679376924"><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376924"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679376923"><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621679376923"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer
forall a r. (Integral a, Euclidean r) =&gt; r -&gt; r -&gt; a -&gt; r
</span><a href="Algebra.Arithmetic.html#modPow"><span class="hs-identifier hs-var">modPow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (p :: k). F p -&gt; Integer
</span><a href="Algebra.Field.Prime.html#runF"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376924"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (s :: k) a (proxy :: k -&gt; *). Reifies s a =&gt; proxy s -&gt; a
</span><span class="hs-identifier hs-var">reflect</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376924"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a1 -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621679376923"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621679376922"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376918"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376922"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Additive</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376922"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376916"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376916"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679376915"><span class="annot"><span class="annottext">+ :: F p -&gt; F p -&gt; F p
</span><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></span></span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376913"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376913"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376916"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376913"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">+</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679376912"><span class="annot"><span class="annottext">sinnum1p :: Natural -&gt; F p -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sinnum1p</span></span></span><span> </span><span id="local-6989586621679376910"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376910"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376909"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376909"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.+</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">P.fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376910"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376909"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">sinnum1p</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621679376907"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376903"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376907"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Multiplicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376907"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376901"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376901"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679376900"><span class="annot"><span class="annottext">* :: F p -&gt; F p -&gt; F p
</span><a href="#local-6989586621679376900"><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></a></span></span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376899"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376899"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376901"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376899"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679376898"><span class="annot"><span class="annottext">pow1p :: F p -&gt; Natural -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pow1p</span></span></span><span> </span><span id="local-6989586621679376896"><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376896"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679376895"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376895"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F p -&gt; Natural -&gt; F p
forall k a1 (p :: k).
(Integral a1, Reifies p Integer) =&gt;
F p -&gt; a1 -&gt; F p
</span><a href="Algebra.Field.Prime.html#pows"><span class="hs-identifier hs-var">pows</span></a></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376896"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376895"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.+</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">pow1p</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span id="local-6989586621679376894"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376888"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376894"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Monoidal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376894"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621679376886"><span class="annot"><span class="annottext">zero :: F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">zero</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">zero</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679376884"><span class="annot"><span class="annottext">sinnum :: Natural -&gt; F p -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sinnum</span></span></span><span> </span><span id="local-6989586621679376882"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376882"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376881"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376881"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">P.fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376882"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376881"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">sinnum</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621679376880"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376880"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.LeftModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376880"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679376875"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376875"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679376874"><span class="annot"><span class="annottext">.* :: Natural -&gt; F p -&gt; F p
</span><span class="hs-operator hs-var hs-var hs-var hs-var">.*</span></span></span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376872"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376872"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376875"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer -&gt; Integer
forall r m. LeftModule r m =&gt; r -&gt; m -&gt; m
</span><span class="hs-operator hs-var">.*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376872"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">.*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679376871"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376871"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.RightModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376871"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376866"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376866"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679376865"><span class="annot"><span class="annottext">*. :: F p -&gt; Natural -&gt; F p
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*.</span></span></span><span> </span><span id="local-6989586621679376863"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376863"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376866"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural -&gt; Integer
forall r m. RightModule r m =&gt; m -&gt; r -&gt; m
</span><span class="hs-operator hs-var">*.</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679376863"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">*.</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span id="local-6989586621679376862"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376862"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.LeftModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376862"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679376858"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376858"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679376857"><span class="annot"><span class="annottext">.* :: Integer -&gt; F p -&gt; F p
</span><a href="#local-6989586621679376857"><span class="hs-operator hs-var hs-var hs-var hs-var">.*</span></a></span></span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376856"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376856"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376858"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376856"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">.*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621679376855"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376855"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.RightModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376855"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376851"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376851"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679376850"><span class="annot"><span class="annottext">*. :: F p -&gt; Integer -&gt; F p
</span><a href="#local-6989586621679376850"><span class="hs-operator hs-var hs-var hs-var hs-var">*.</span></a></span></span><span> </span><span id="local-6989586621679376849"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376849"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376851"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376849"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">*.</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679376848"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376839"><span id="local-6989586621679376841"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376848"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376848"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376837"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376837"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679376836"><span class="annot"><span class="annottext">- :: F p -&gt; F p -&gt; F p
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></span></span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376834"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376834"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376837"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376834"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">-</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679376833"><span class="annot"><span class="annottext">negate :: F p -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376831"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376831"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall r. Group r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376831"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">negate</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621679376830"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376830"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Abelian</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376830"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span id="local-6989586621679376827"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376827"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Semiring</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376827"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679376822"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376822"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Rig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376822"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679376816"><span class="annot"><span class="annottext">fromNatural :: Natural -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromNatural</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; (Natural -&gt; Integer) -&gt; Natural -&gt; F p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">P.fromIntegral</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fromNatural</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621679376814"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376814"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Ring</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376814"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679376809"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fromInteger</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621679376807"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376807"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.DecidableZero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376807"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679376803"><span class="annot"><span class="annottext">isZero :: F p -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">isZero</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376801"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376801"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376801"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span id="local-6989586621679376800"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376795"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376800"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Unital</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376800"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679376793"><span class="annot"><span class="annottext">one :: F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">one</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">one</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679376791"><span class="annot"><span class="annottext">pow :: F p -&gt; Natural -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pow</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F p -&gt; Natural -&gt; F p
forall k a1 (p :: k).
(Integral a1, Reifies p Integer) =&gt;
F p -&gt; a1 -&gt; F p
</span><a href="Algebra.Field.Prime.html#pows"><span class="hs-identifier hs-var">pows</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">pow</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621679376789"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376784"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376789"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecidableUnits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376789"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679376782"><span class="annot"><span class="annottext">isUnit :: F p -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">isUnit</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376780"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376780"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376780"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">isUnit</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679376778"><span class="annot"><span class="annottext">recipUnit :: F p -&gt; Maybe (F p)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">recipUnit</span></span></span><span> </span><span id="local-6989586621679376776"><span class="annot"><span class="annottext">n :: F p
</span><a href="#local-6989586621679376776"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376775"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376775"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679376774"><span class="annot"><span class="annottext">p :: Integer
</span><a href="#local-6989586621679376774"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Integer -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (s :: k) a (proxy :: k -&gt; *). Reifies s a =&gt; proxy s -&gt; a
</span><span class="hs-identifier hs-var">reflect</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376776"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679376773"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376773"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679376772"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376772"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Integer, Integer, Integer)] -&gt; (Integer, Integer, Integer)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([(Integer, Integer, Integer)] -&gt; (Integer, Integer, Integer))
-&gt; [(Integer, Integer, Integer)] -&gt; (Integer, Integer, Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; [(Integer, Integer, Integer)]
forall d. Euclidean d =&gt; d -&gt; d -&gt; [(d, d, d)]
</span><span class="hs-identifier hs-var">euclid</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376774"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376775"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376773"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">F p -&gt; Maybe (F p)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(F p -&gt; Maybe (F p)) -&gt; F p -&gt; Maybe (F p)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall r. Num r =&gt; Integer -&gt; r
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Integer -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376772"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`rem`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376774"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (F p)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">recipUnit</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679376769"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376769"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecidableAssociates</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376769"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679376765"><span class="annot"><span class="annottext">isAssociate :: F p -&gt; F p -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">isAssociate</span></span></span><span> </span><span id="local-6989586621679376763"><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376763"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679376762"><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376762"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F p -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376763"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376762"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F p -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376763"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F p -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376762"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">isAssociate</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span id="local-6989586621679376758"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376754"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376758"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnitNormalForm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376758"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-181"></span><span id="local-6989586621679376752"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376746"><span id="local-6989586621679376748"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376752"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntegralDomain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376752"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-182"></span><span id="local-6989586621679376744"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376735"><span id="local-6989586621679376737"><span id="local-6989586621679376739"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376744"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCDDomain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376744"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-183"></span><span id="local-6989586621679376733"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376733"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376733"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-184"></span><span id="local-6989586621679376730"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376727"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376730"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PID</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376730"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-185"></span><span id="local-6989586621679376725"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376725"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ZeroProductSemiring</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376725"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-186"></span><span id="local-6989586621679376721"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376712"><span id="local-6989586621679376714"><span id="local-6989586621679376716"><span id="local-6989586621679376718"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376721"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Euclidean</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376721"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="local-6989586621679376710"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376705"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376710"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Division</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376710"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679376702"><span class="annot"><span class="annottext">recip :: F p -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">recip</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F p -&gt; Maybe (F p) -&gt; F p
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; F p
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;recip: not unit&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (F p) -&gt; F p) -&gt; (F p -&gt; Maybe (F p)) -&gt; F p -&gt; F p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; Maybe (F p)
forall r. DecidableUnits r =&gt; r -&gt; Maybe r
</span><span class="hs-identifier hs-var">recipUnit</span></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">recip</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679376699"><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376699"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679376698"><span class="annot"><span class="annottext">/ :: F p -&gt; F p -&gt; F p
</span><span class="hs-operator hs-var hs-var hs-var hs-var">/</span></span></span><span> </span><span id="local-6989586621679376696"><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376696"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376699"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">F p -&gt; F p -&gt; F p
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; F p
forall r. Division r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376696"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">/</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679376695"><span class="annot"><span class="annottext">^ :: F p -&gt; n -&gt; F p
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(^)</span></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F p -&gt; n -&gt; F p
forall k a1 (p :: k).
(Integral a1, Reifies p Integer) =&gt;
F p -&gt; a1 -&gt; F p
</span><a href="Algebra.Field.Prime.html#pows"><span class="hs-identifier hs-var">pows</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">^</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621679376693"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376693"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376693"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621679376687"><span class="annot"><span class="annottext">/ :: F p -&gt; F p -&gt; F p
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(/)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapAlgebra (F p) -&gt; WrapAlgebra (F p) -&gt; WrapAlgebra (F p))
-&gt; F p -&gt; F p -&gt; F p
</span><span class="hs-identifier hs-var">C.coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapAlgebra (F p) -&gt; WrapAlgebra (F p) -&gt; WrapAlgebra (F p)
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(P./)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376693"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376693"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376693"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">/</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621679376685"><span class="annot"><span class="annottext">fromRational :: Rational -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational</span></span></span><span> </span><span id="local-6989586621679376684"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679376684"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">R.numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679376684"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">F p -&gt; F p -&gt; F p
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; F p
forall r. Division r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; Integer -&gt; F p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">R.denominator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679376684"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fromRational</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679376681"><span class="annot"><span class="annottext">recip :: F p -&gt; F p
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">recip</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WrapAlgebra (F p) -&gt; WrapAlgebra (F p)) -&gt; F p -&gt; F p
</span><span class="hs-identifier hs-var">C.coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapAlgebra (F p) -&gt; WrapAlgebra (F p)
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">P.recip</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376693"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WrapAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376693"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">recip</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span id="local-6989586621679376679"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376679"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Commutative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376679"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621679376676"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376676"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Characteristic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376676"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679376672"><span class="annot"><span class="annottext">char :: proxy (F p) -&gt; Natural
</span><a href="#local-6989586621679376672"><span class="hs-identifier hs-var hs-var hs-var hs-var">char</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy (F p)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Natural) -&gt; Integer -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy p -&gt; Integer
forall k (s :: k) a (proxy :: k -&gt; *). Reifies s a =&gt; proxy s -&gt; a
</span><span class="hs-identifier hs-var">reflect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy p
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679376676"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">char</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span id="local-6989586621679376670"><span id="local-6989586621679376671"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376665"><span id="local-6989586621679376667"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679376671"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679376670"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376671"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621679376663"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; F p -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679376661"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679376661"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679376660"><span class="annot"><span class="annottext">n :: F p
</span><a href="#local-6989586621679376660"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376659"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376659"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679376661"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376659"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall d. Euclidean d =&gt; d -&gt; d -&gt; d
</span><span class="hs-operator hs-var">`rem`</span></span><span> </span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (s :: k) a (proxy :: k -&gt; *). Reifies s a =&gt; proxy s -&gt; a
</span><span class="hs-identifier hs-var">reflect</span></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376660"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621679376657"><span id="local-6989586621679376658"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679376658"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679376657"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Ring.Polynomial.Class.html#PrettyCoeff"><span class="hs-identifier hs-type">PrettyCoeff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376658"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679376653"><span class="annot"><span class="annottext">showsCoeff :: Int -&gt; F p -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#showsCoeff"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsCoeff</span></a></span></span><span> </span><span id="local-6989586621679376651"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679376651"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span id="local-6989586621679376650"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376650"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376650"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Vanished"><span class="hs-identifier hs-var">Vanished</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376650"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#OneCoeff"><span class="hs-identifier hs-var">OneCoeff</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowSCoeff
</span><a href="Algebra.Ring.Polynomial.Class.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowSCoeff) -&gt; ShowS -&gt; ShowSCoeff
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679376651"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679376650"><span class="hs-identifier hs-var">p</span></a></span></span></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span id="local-6989586621679376646"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376646"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Field.Finite.html#FiniteField"><span class="hs-identifier hs-type">FiniteField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376646"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679376640"><span class="annot"><span class="annottext">power :: proxy (F p) -&gt; Natural
</span><a href="Algebra.Field.Finite.html#power"><span class="hs-identifier hs-var hs-var hs-var hs-var">power</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy (F p)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Field.Finite.html#power"><span class="hs-pragma hs-type">power</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679376638"><span class="annot"><span class="annottext">elements :: proxy (F p) -&gt; [F p]
</span><a href="Algebra.Field.Finite.html#elements"><span class="hs-identifier hs-var hs-var hs-var hs-var">elements</span></a></span></span><span> </span><span id="local-6989586621679376636"><span class="annot"><span class="annottext">proxy (F p)
</span><a href="#local-6989586621679376636"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; [Integer] -&gt; [F p]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy (F p) -&gt; Natural
forall r (proxy :: * -&gt; *). Characteristic r =&gt; proxy r -&gt; Natural
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">proxy (F p)
</span><a href="#local-6989586621679376636"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Field.Finite.html#elements"><span class="hs-pragma hs-type">elements</span></a></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span id="local-6989586621679376634"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679376628"><span id="local-6989586621679376630"><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679376634"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Random</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Field.Prime.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376634"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679376626"><span class="annot"><span class="annottext">random :: g -&gt; (F p, g)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">random</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand g (F p) -&gt; g -&gt; (F p, g)
forall g a. Rand g a -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">runRand</span></span><span> </span><span class="annot"><span class="annottext">(Rand g (F p) -&gt; g -&gt; (F p, g)) -&gt; Rand g (F p) -&gt; g -&gt; (F p, g)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; RandT g Identity Integer -&gt; Rand g (F p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; RandT g Identity Integer
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><span class="hs-identifier hs-var">getRandomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy p -&gt; Integer
forall k (s :: k) a (proxy :: k -&gt; *). Reifies s a =&gt; proxy s -&gt; a
</span><span class="hs-identifier hs-var">reflect</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy p
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679376634"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">random</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679376624"><span class="annot"><span class="annottext">randomR :: (F p, F p) -&gt; g -&gt; (F p, g)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">randomR</span></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679376622"><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376622"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679376621"><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376621"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand g (F p) -&gt; g -&gt; (F p, g)
forall g a. Rand g a -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">runRand</span></span><span> </span><span class="annot"><span class="annottext">(Rand g (F p) -&gt; g -&gt; (F p, g)) -&gt; Rand g (F p) -&gt; g -&gt; (F p, g)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; F p
forall k (p :: k). Reifies p Integer =&gt; Integer -&gt; F p
</span><a href="Algebra.Field.Prime.html#modNat"><span class="hs-identifier hs-var">modNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; F p) -&gt; RandT g Identity Integer -&gt; Rand g (F p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; RandT g Identity Integer
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><span class="hs-identifier hs-var">getRandomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (p :: k). F p -&gt; Integer
</span><a href="Algebra.Field.Prime.html#naturalRepr"><span class="hs-identifier hs-var">naturalRepr</span></a></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376622"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">F p -&gt; Integer
forall k (p :: k). F p -&gt; Integer
</span><a href="Algebra.Field.Prime.html#naturalRepr"><span class="hs-identifier hs-var">naturalRepr</span></a></span><span> </span><span class="annot"><span class="annottext">F p
</span><a href="#local-6989586621679376621"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">randomR</span></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span id="local-6989586621679377033"><span class="annot"><a href="Algebra.Field.Prime.html#modRat"><span class="hs-identifier hs-type">modRat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Field.Finite.html#FiniteField"><span class="hs-identifier hs-type">FiniteField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377033"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679377033"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fraction</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377033"><span class="hs-identifier hs-type">k</span></a></span></span><span>
</span><span id="line-239"></span><span id="modRat"><span class="annot"><span class="annottext">modRat :: Proxy k -&gt; Fraction Integer -&gt; k
</span><a href="Algebra.Field.Prime.html#modRat"><span class="hs-identifier hs-var hs-var">modRat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy k
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679376620"><span class="annot"><span class="annottext">Fraction Integer
</span><a href="#local-6989586621679376620"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; k
forall r. Ring r =&gt; Integer -&gt; r
</span><span class="hs-identifier hs-var">NA.fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fraction Integer -&gt; Integer
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Fraction Integer
</span><a href="#local-6989586621679376620"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; k
forall r. Division r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">NA./</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; k
forall r. Ring r =&gt; Integer -&gt; r
</span><span class="hs-identifier hs-var">NA.fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fraction Integer -&gt; Integer
forall t. Fraction t -&gt; t
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Fraction Integer
</span><a href="#local-6989586621679376620"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#modRat"><span class="hs-pragma hs-type">modRat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span id="local-6989586621679376617"><span class="annot"><a href="Algebra.Field.Prime.html#modRat%27"><span class="hs-identifier hs-type">modRat&#39;</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Field.Finite.html#FiniteField"><span class="hs-identifier hs-type">FiniteField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376617"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fraction</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679376617"><span class="hs-identifier hs-type">k</span></a></span></span><span>
</span><span id="line-243"></span><span id="modRat%27"><span class="annot"><span class="annottext">modRat&#39; :: Fraction Integer -&gt; k
</span><a href="Algebra.Field.Prime.html#modRat%27"><span class="hs-identifier hs-var hs-var">modRat&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy k -&gt; Fraction Integer -&gt; k
forall k. FiniteField k =&gt; Proxy k -&gt; Fraction Integer -&gt; k
</span><a href="Algebra.Field.Prime.html#modRat"><span class="hs-identifier hs-var">modRat</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy k
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-244"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Field.Prime.html#modRat%27"><span class="hs-pragma hs-type">modRat&#39;</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-245"></span></pre></body></html>