<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds, FlexibleContexts, FlexibleInstances, GADTs   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures, MultiParamTypeClasses                         #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NoMonomorphismRestriction, TypeFamilies, TypeSynonymInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Matrix</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier">Matrix</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#delta"><span class="hs-identifier">delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#companion"><span class="hs-identifier">companion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>                       </span><span class="annot"><a href="Algebra.Matrix.html#gaussReduction"><span class="hs-identifier">gaussReduction</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#maxNorm"><span class="hs-identifier">maxNorm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#rankWith"><span class="hs-identifier">rankWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#det"><span class="hs-identifier">det</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>                       </span><span class="annot"><a href="Algebra.Matrix.html#inverse"><span class="hs-identifier">inverse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#inverseWith"><span class="hs-identifier">inverseWith</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algebra.Internal</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.LinkedMatrix.html"><span class="hs-identifier">Algebra.LinkedMatrix</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LM</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algebra.Prelude.Core</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">maxNorm</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">zero</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">both</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(%~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_3</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Matrix</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DM</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constraint</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Algebra</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Additive</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DecidableZero</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Algebra</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Monoidal</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Multiplicative</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Algebra</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Unital</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Algebra</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NA</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Decidable.Zero</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NA</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.LinearAlgebra</span></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LA</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.LinearAlgebra.Devel</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LA</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-pragma">{-# ANN</span><span> </span><span class="hs-pragma">module</span><span> </span><span class="annot"><span class="hs-pragma">&quot;HLint: ignore Redundant bang pattern&quot;</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">class</span><span> </span><span id="Matrix"><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span></span><span> </span><span id="local-6989586621679357000"><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Elem"><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span></span><span> </span><span id="local-6989586621679357000"><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span></span><span> </span><span id="local-6989586621679356646"><span class="annot"><a href="#local-6989586621679356646"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span>
</span><span id="line-30"></span><span>  </span><span id="local-6989586621679356959"><span id="local-6989586621679356960"><span id="cmap"><span class="annot"><a href="Algebra.Matrix.html#cmap"><span class="hs-identifier hs-type">cmap</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356960"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356959"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679356960"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356959"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356960"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356959"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-31"></span><span>  </span><span id="local-6989586621679356958"><span id="empty"><span class="annot"><a href="Algebra.Matrix.html#empty"><span class="hs-identifier hs-type">empty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356958"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356958"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-32"></span><span>  </span><span id="local-6989586621679356957"><span id="fromLists"><span class="annot"><a href="Algebra.Matrix.html#fromLists"><span class="hs-identifier hs-type">fromLists</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356957"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679356957"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356957"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-33"></span><span>  </span><span id="local-6989586621679356956"><span id="fromCols"><span class="annot"><a href="Algebra.Matrix.html#fromCols"><span class="hs-identifier hs-type">fromCols</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356956"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-34"></span><span>  </span><span id="local-6989586621679356641"><span class="annot"><a href="Algebra.Matrix.html#fromCols"><span class="hs-identifier hs-var hs-var">fromCols</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; Int -&gt; mat a
</span><a href="Algebra.Matrix.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Algebra.Matrix.html#fromCols"><span class="hs-identifier hs-var">fromCols</span></a></span><span> </span><span id="local-6989586621679356639"><span class="annot"><span class="annottext">[Vector a]
</span><a href="#local-6989586621679356639"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(mat a -&gt; mat a -&gt; mat a) -&gt; [mat a] -&gt; mat a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldr1</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; mat a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">(&lt;||&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">([mat a] -&gt; mat a) -&gt; [mat a] -&gt; mat a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; mat a) -&gt; [Vector a] -&gt; [mat a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Vector a -&gt; mat a
</span><a href="Algebra.Matrix.html#colVector"><span class="hs-identifier hs-var">colVector</span></a></span><span> </span><span class="annot"><span class="annottext">[Vector a]
</span><a href="#local-6989586621679356639"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span id="local-6989586621679356634"><span id="fromRows"><span class="annot"><a href="Algebra.Matrix.html#fromRows"><span class="hs-identifier hs-type">fromRows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356634"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356634"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356634"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-37"></span><span>  </span><span id="local-6989586621679356632"><span class="annot"><a href="Algebra.Matrix.html#fromRows"><span class="hs-identifier hs-var hs-var">fromRows</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; Int -&gt; mat a
</span><a href="Algebra.Matrix.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Algebra.Matrix.html#fromRows"><span class="hs-identifier hs-var">fromRows</span></a></span><span> </span><span id="local-6989586621679356631"><span class="annot"><span class="annottext">[Vector a]
</span><a href="#local-6989586621679356631"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(mat a -&gt; mat a -&gt; mat a) -&gt; [mat a] -&gt; mat a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldr1</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; mat a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#%3C--%3E"><span class="hs-operator hs-var">(&lt;--&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">([mat a] -&gt; mat a) -&gt; [mat a] -&gt; mat a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; mat a) -&gt; [Vector a] -&gt; [mat a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Vector a -&gt; mat a
</span><a href="Algebra.Matrix.html#rowVector"><span class="hs-identifier hs-var">rowVector</span></a></span><span> </span><span class="annot"><span class="annottext">[Vector a]
</span><a href="#local-6989586621679356631"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-39"></span><span>  </span><span id="local-6989586621679356955"><span id="toCols"><span class="annot"><a href="Algebra.Matrix.html#toCols"><span class="hs-identifier hs-type">toCols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679356627"><span class="annot"><a href="Algebra.Matrix.html#toCols"><span class="hs-identifier hs-var hs-var">toCols</span></a></span><span> </span><span id="local-6989586621679356626"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356626"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Vector a) -&gt; [Int] -&gt; [Vector a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; mat a -&gt; Vector a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; mat a -&gt; Vector a
</span><a href="Algebra.Matrix.html#getCol"><span class="hs-operator hs-var">`getCol`</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356626"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356626"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-41"></span><span>  </span><span id="local-6989586621679356963"><span id="toRows"><span class="annot"><a href="Algebra.Matrix.html#toRows"><span class="hs-identifier hs-type">toRows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356963"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356963"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356963"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-42"></span><span>  </span><span id="local-6989586621679356622"><span class="annot"><a href="Algebra.Matrix.html#toRows"><span class="hs-identifier hs-var hs-var">toRows</span></a></span><span> </span><span id="local-6989586621679356621"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356621"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Vector a) -&gt; [Int] -&gt; [Vector a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; mat a -&gt; Vector a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; mat a -&gt; Vector a
</span><a href="Algebra.Matrix.html#getRow"><span class="hs-operator hs-var">`getRow`</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356621"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356621"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679356983"><span id="ncols"><span class="annot"><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier hs-type">ncols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356983"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621679356618"><span id="nrows"><span class="annot"><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-type">nrows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356618"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621679356954"><span id="identity"><span class="annot"><a href="Algebra.Matrix.html#identity"><span class="hs-identifier hs-type">identity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356954"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356954"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679356953"><span id="diag"><span class="annot"><a href="Algebra.Matrix.html#diag"><span class="hs-identifier hs-type">diag</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356953"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356953"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356953"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679356952"><span id="getDiag"><span class="annot"><a href="Algebra.Matrix.html#getDiag"><span class="hs-identifier hs-type">getDiag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356952"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356952"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356952"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621679356951"><span id="trace"><span class="annot"><a href="Algebra.Matrix.html#trace"><span class="hs-identifier hs-type">trace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356951"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356951"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356951"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679356613"><span id="diagProd"><span class="annot"><a href="Algebra.Matrix.html#diagProd"><span class="hs-identifier hs-type">diagProd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356613"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356613"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356613"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-50"></span><span>  </span><span id="local-6989586621679356998"><span id="zero"><span class="annot"><a href="Algebra.Matrix.html#zero"><span class="hs-identifier hs-type">zero</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356998"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356998"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621679356987"><span id="colVector"><span class="annot"><a href="Algebra.Matrix.html#colVector"><span class="hs-identifier hs-type">colVector</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356987"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356987"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356987"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621679356611"><span id="rowVector"><span class="annot"><a href="Algebra.Matrix.html#rowVector"><span class="hs-identifier hs-type">rowVector</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356611"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356611"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356611"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-53"></span><span>  </span><span id="local-6989586621679356984"><span id="getCol"><span class="annot"><a href="Algebra.Matrix.html#getCol"><span class="hs-identifier hs-type">getCol</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356984"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356984"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356984"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621679356610"><span id="getRow"><span class="annot"><a href="Algebra.Matrix.html#getRow"><span class="hs-identifier hs-type">getRow</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356610"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679356950"><span id="switchRows"><span class="annot"><a href="Algebra.Matrix.html#switchRows"><span class="hs-identifier hs-type">switchRows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356950"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356950"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356950"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621679356949"><span id="scaleRow"><span class="annot"><a href="Algebra.Matrix.html#scaleRow"><span class="hs-identifier hs-type">scaleRow</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356949"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356949"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356949"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356949"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679356948"><span id="combineRows"><span class="annot"><a href="Algebra.Matrix.html#combineRows"><span class="hs-identifier hs-type">combineRows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356948"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679356947"><span id="trans"><span class="annot"><a href="Algebra.Matrix.html#trans"><span class="hs-identifier hs-type">trans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356947"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356947"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356947"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679356946"><span id="buildMatrix"><span class="annot"><a href="Algebra.Matrix.html#buildMatrix"><span class="hs-identifier hs-type">buildMatrix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356946"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356946"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356946"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span id="local-6989586621679356945"><span id="index"><span class="annot"><a href="Algebra.Matrix.html#index"><span class="hs-identifier hs-type">index</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356945"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356945"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679356945"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679356603"><span class="annot"><a href="Algebra.Matrix.html#index"><span class="hs-identifier hs-var hs-var">index</span></a></span><span> </span><span id="local-6989586621679356602"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356602"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356601"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356601"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679356600"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356600"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356602"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356602"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356600"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356601"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356601"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356600"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-62"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; a -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356600"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; (Int, Int) -&gt; a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; (Int, Int) -&gt; a
</span><a href="Algebra.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356602"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356601"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span><span>
</span><span id="line-64"></span><span>  </span><span id="local-6989586621679356978"><span id="%21"><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356978"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356978"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356978"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679356994"><span id="%3C%7C%7C%3E"><span class="annot"><a href="Algebra.Matrix.html#%3C%7C%7C%3E"><span class="hs-operator hs-type">(&lt;||&gt;)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356994"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356994"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356994"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356994"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679356596"><span id="%3C--%3E"><span class="annot"><a href="Algebra.Matrix.html#%3C--%3E"><span class="hs-operator hs-type">(&lt;--&gt;)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356596"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679356944"><span id="nonZeroRows"><span class="annot"><a href="Algebra.Matrix.html#nonZeroRows"><span class="hs-identifier hs-type">nonZeroRows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecidableZero</span></span><span> </span><span class="annot"><a href="#local-6989586621679356944"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356944"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356944"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621679356594"><span class="annot"><a href="Algebra.Matrix.html#nonZeroRows"><span class="hs-identifier hs-var hs-var">nonZeroRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Vector a) -&gt; Int) -&gt; [(Int, Vector a)] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Vector a) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(Int, Vector a)] -&gt; [Int])
-&gt; (mat a -&gt; [(Int, Vector a)]) -&gt; mat a -&gt; [Int]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Int, Vector a) -&gt; Bool) -&gt; [(Int, Vector a)] -&gt; [(Int, Vector a)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Vector a -&gt; Bool
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Bool
</span><span class="hs-identifier hs-var">V.any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">NA.isZero</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Bool)
-&gt; ((Int, Vector a) -&gt; Vector a) -&gt; (Int, Vector a) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, Vector a) -&gt; Vector a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, Vector a)] -&gt; [(Int, Vector a)])
-&gt; (mat a -&gt; [(Int, Vector a)]) -&gt; mat a -&gt; [(Int, Vector a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Vector a] -&gt; [(Int, Vector a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; [(Int, Vector a)])
-&gt; (mat a -&gt; [Vector a]) -&gt; mat a -&gt; [(Int, Vector a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; [Vector a]
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; [Vector a]
</span><a href="Algebra.Matrix.html#toRows"><span class="hs-identifier hs-var">toRows</span></a></span></span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679356589"><span id="nonZeroCols"><span class="annot"><a href="Algebra.Matrix.html#nonZeroCols"><span class="hs-identifier hs-type">nonZeroCols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecidableZero</span></span><span> </span><span class="annot"><a href="#local-6989586621679356589"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356589"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679357000"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356589"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679356587"><span class="annot"><a href="Algebra.Matrix.html#nonZeroCols"><span class="hs-identifier hs-var hs-var">nonZeroCols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Vector a) -&gt; Int) -&gt; [(Int, Vector a)] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Vector a) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(Int, Vector a)] -&gt; [Int])
-&gt; (mat a -&gt; [(Int, Vector a)]) -&gt; mat a -&gt; [Int]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Int, Vector a) -&gt; Bool) -&gt; [(Int, Vector a)] -&gt; [(Int, Vector a)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Vector a -&gt; Bool
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Bool
</span><span class="hs-identifier hs-var">V.any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall r. DecidableZero r =&gt; r -&gt; Bool
</span><span class="hs-identifier hs-var">NA.isZero</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Bool)
-&gt; ((Int, Vector a) -&gt; Vector a) -&gt; (Int, Vector a) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, Vector a) -&gt; Vector a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, Vector a)] -&gt; [(Int, Vector a)])
-&gt; (mat a -&gt; [(Int, Vector a)]) -&gt; mat a -&gt; [(Int, Vector a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Vector a] -&gt; [(Int, Vector a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; [(Int, Vector a)])
-&gt; (mat a -&gt; [Vector a]) -&gt; mat a -&gt; [(Int, Vector a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; [Vector a]
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; [Vector a]
</span><a href="Algebra.Matrix.html#toCols"><span class="hs-identifier hs-var">toCols</span></a></span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679356550"><span id="local-6989586621679356552"><span id="local-6989586621679356557"><span id="local-6989586621679356576"><span id="local-6989586621679356578"><span id="local-6989586621679356580"><span id="local-6989586621679356582"><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DM.Matrix</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Elem"><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DM.Matrix</span></span><span> </span><span id="local-6989586621679356548"><span class="annot"><a href="#local-6989586621679356548"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679356548"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679356547"><span class="annot"><span class="annottext">empty :: Matrix b
</span><a href="#local-6989586621679356547"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix b
forall a. Num a =&gt; Int -&gt; Int -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.zero</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679356545"><span class="annot"><span class="annottext">cmap :: (a -&gt; b) -&gt; Matrix a -&gt; Matrix b
</span><a href="#local-6989586621679356545"><span class="hs-identifier hs-var hs-var hs-var hs-var">cmap</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Matrix a -&gt; Matrix b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679356544"><span class="annot"><span class="annottext">fromLists :: [[a]] -&gt; Matrix a
</span><a href="#local-6989586621679356544"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromLists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; Matrix a
forall a. [[a]] -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.fromLists</span></span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621679356542"><span class="annot"><span class="annottext">ncols :: Matrix a -&gt; Int
</span><a href="#local-6989586621679356542"><span class="hs-identifier hs-var hs-var hs-var hs-var">ncols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">DM.ncols</span></span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679356540"><span class="annot"><span class="annottext">nrows :: Matrix a -&gt; Int
</span><a href="#local-6989586621679356540"><span class="hs-identifier hs-var hs-var hs-var hs-var">nrows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">DM.nrows</span></span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621679356538"><span class="annot"><span class="annottext">trans :: Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356538"><span class="hs-identifier hs-var hs-var hs-var hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.transpose</span></span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679356536"><span class="annot"><span class="annottext">identity :: Int -&gt; Matrix a
</span><a href="#local-6989586621679356536"><span class="hs-identifier hs-var hs-var hs-var hs-var">identity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.identity</span></span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679356534"><span class="annot"><span class="annottext">diag :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356534"><span class="hs-identifier hs-var hs-var hs-var hs-var">diag</span></a></span></span><span> </span><span id="local-6989586621679356533"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679356533"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.matrix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679356533"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679356533"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679356530"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356530"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356529"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356529"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356530"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356529"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679356533"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356530"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679356526"><span class="annot"><span class="annottext">getDiag :: Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356526"><span class="hs-identifier hs-var hs-var hs-var hs-var">getDiag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall a. Matrix a -&gt; Vector a
</span><span class="hs-identifier hs-var">DM.getDiag</span></span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679356524"><span class="annot"><span class="annottext">trace :: Matrix a -&gt; a
</span><a href="#local-6989586621679356524"><span class="hs-identifier hs-var hs-var hs-var hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; a
forall a. Num a =&gt; Matrix a -&gt; a
</span><span class="hs-identifier hs-var">DM.trace</span></span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679356522"><span class="annot"><span class="annottext">diagProd :: Matrix a -&gt; a
</span><a href="#local-6989586621679356522"><span class="hs-identifier hs-var hs-var hs-var hs-var">diagProd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; a
forall a. Num a =&gt; Matrix a -&gt; a
</span><span class="hs-identifier hs-var">DM.diagProd</span></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679356520"><span class="annot"><span class="annottext">zero :: Int -&gt; Int -&gt; Matrix a
</span><a href="#local-6989586621679356520"><span class="hs-identifier hs-var hs-var hs-var hs-var">zero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; Int -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.zero</span></span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679356519"><span class="annot"><span class="annottext">colVector :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356519"><span class="hs-identifier hs-var hs-var hs-var hs-var">colVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Matrix a
forall a. Vector a -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.colVector</span></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679356517"><span class="annot"><span class="annottext">rowVector :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356517"><span class="hs-identifier hs-var hs-var hs-var hs-var">rowVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Matrix a
forall a. Vector a -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.rowVector</span></span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679356515"><span class="annot"><span class="annottext">getCol :: Int -&gt; Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356515"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Vector a
forall a. Int -&gt; Matrix a -&gt; Vector a
</span><span class="hs-identifier hs-var">DM.getCol</span></span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621679356513"><span class="annot"><span class="annottext">getRow :: Int -&gt; Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356513"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Vector a
forall a. Int -&gt; Matrix a -&gt; Vector a
</span><span class="hs-identifier hs-var">DM.getRow</span></span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679356511"><span class="annot"><span class="annottext">switchRows :: Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356511"><span class="hs-identifier hs-var hs-var hs-var hs-var">switchRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.switchRows</span></span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679356509"><span class="annot"><span class="annottext">combineRows :: Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356509"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.combineRows</span></span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679356507"><span class="annot"><span class="annottext">scaleRow :: a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356507"><span class="hs-identifier hs-var hs-var hs-var hs-var">scaleRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.scaleRow</span></span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621679356505"><span class="annot"><span class="annottext">buildMatrix :: Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="#local-6989586621679356505"><span class="hs-identifier hs-var hs-var hs-var hs-var">buildMatrix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><span class="hs-identifier hs-var">DM.matrix</span></span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679356504"><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><span class="hs-operator hs-var">(DM.!)</span></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679356502"><span class="annot"><span class="annottext">&lt;||&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356502"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;||&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><span class="hs-operator hs-var">(DM.&lt;|&gt;)</span></span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679356500"><span class="annot"><span class="annottext">&lt;--&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356500"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;--&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><span class="hs-operator hs-var">(DM.&lt;-&gt;)</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621679356834"><span class="annot"><a href="Algebra.Matrix.html#swapIJ"><span class="hs-identifier hs-type">swapIJ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679356834"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356834"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356834"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356834"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356834"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-100"></span><span id="swapIJ"><span class="annot"><span class="annottext">swapIJ :: a -&gt; a -&gt; a -&gt; a
</span><a href="Algebra.Matrix.html#swapIJ"><span class="hs-identifier hs-var hs-var">swapIJ</span></a></span></span><span> </span><span id="local-6989586621679356497"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356497"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356496"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356496"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679356495"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356495"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356495"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356497"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356496"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356495"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356496"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356497"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356495"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679356461"><span id="local-6989586621679356463"><span id="local-6989586621679356468"><span id="local-6989586621679356489"><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LA.Matrix</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Elem"><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LA.Matrix</span></span><span> </span><span id="local-6989586621679356460"><span class="annot"><a href="#local-6989586621679356460"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">P.Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679356460"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LA.Numeric</span></span><span>  </span><span class="annot"><a href="#local-6989586621679356460"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LA.Element</span></span><span> </span><span class="annot"><a href="#local-6989586621679356460"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LA.Container</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LA.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679356460"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679356458"><span class="annot"><span class="annottext">empty :: Matrix b
</span><a href="#local-6989586621679356458"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[b]] -&gt; Matrix b
forall t. Element t =&gt; [[t]] -&gt; Matrix t
</span><span class="hs-identifier hs-var">LA.fromLists</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679356456"><span class="annot"><span class="annottext">fromLists :: [[a]] -&gt; Matrix a
</span><a href="#local-6989586621679356456"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromLists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; Matrix a
forall t. Element t =&gt; [[t]] -&gt; Matrix t
</span><span class="hs-identifier hs-var">LA.fromLists</span></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679356455"><span class="annot"><span class="annottext">cmap :: (a -&gt; b) -&gt; Matrix a -&gt; Matrix b
</span><a href="#local-6989586621679356455"><span class="hs-identifier hs-var hs-var hs-var hs-var">cmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Matrix a -&gt; Matrix b
forall b (c :: * -&gt; *) e.
(Element b, Container c e) =&gt;
(e -&gt; b) -&gt; c e -&gt; c b
</span><span class="hs-identifier hs-var">LA.cmap</span></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679356453"><span class="annot"><span class="annottext">ncols :: Matrix a -&gt; Int
</span><a href="#local-6989586621679356453"><span class="hs-identifier hs-var hs-var hs-var hs-var">ncols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><span class="hs-identifier hs-var">LA.cols</span></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679356451"><span class="annot"><span class="annottext">nrows :: Matrix a -&gt; Int
</span><a href="#local-6989586621679356451"><span class="hs-identifier hs-var hs-var hs-var hs-var">nrows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><span class="hs-identifier hs-var">LA.rows</span></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679356449"><span class="annot"><span class="annottext">trans :: Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356449"><span class="hs-identifier hs-var hs-var hs-var hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall m mt. Transposable m mt =&gt; m -&gt; mt
</span><span class="hs-identifier hs-var">LA.tr</span></span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621679356447"><span class="annot"><span class="annottext">identity :: Int -&gt; Matrix a
</span><a href="#local-6989586621679356447"><span class="hs-identifier hs-var hs-var hs-var hs-var">identity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a
forall a. (Num a, Element a) =&gt; Int -&gt; Matrix a
</span><span class="hs-identifier hs-var">LA.ident</span></span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679356445"><span class="annot"><span class="annottext">fromCols :: [Vector a] -&gt; Matrix a
</span><a href="#local-6989586621679356445"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vector a] -&gt; Matrix a
forall t. Element t =&gt; [Vector t] -&gt; Matrix t
</span><span class="hs-identifier hs-var">LA.fromColumns</span></span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; Matrix a)
-&gt; ([Vector a] -&gt; [Vector a]) -&gt; [Vector a] -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Vector a) -&gt; [Vector a] -&gt; [Vector a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. Storable a =&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">LA.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679356441"><span class="annot"><span class="annottext">diag :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356441"><span class="hs-identifier hs-var hs-var hs-var hs-var">diag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Matrix a
forall a. (Num a, Element a) =&gt; Vector a -&gt; Matrix a
</span><span class="hs-identifier hs-var">LA.diag</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a)
-&gt; (Vector a -&gt; Vector a) -&gt; Vector a -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. Storable a =&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">LA.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621679356439"><span class="annot"><span class="annottext">getDiag :: Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356439"><span class="hs-identifier hs-var hs-var hs-var hs-var">getDiag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Matrix a -&gt; [a]) -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Storable a =&gt; Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">LA.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; [a]) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall t. Element t =&gt; Matrix t -&gt; Vector t
</span><span class="hs-identifier hs-var">LA.takeDiag</span></span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679356435"><span class="annot"><span class="annottext">trace :: Matrix a -&gt; a
</span><a href="#local-6989586621679356435"><span class="hs-identifier hs-var hs-var hs-var hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall (c :: * -&gt; *) e. Container c e =&gt; c e -&gt; e
</span><span class="hs-identifier hs-var">LA.sumElements</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall t. Element t =&gt; Matrix t -&gt; Vector t
</span><span class="hs-identifier hs-var">LA.takeDiag</span></span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679356433"><span class="annot"><span class="annottext">diagProd :: Matrix a -&gt; a
</span><a href="#local-6989586621679356433"><span class="hs-identifier hs-var hs-var hs-var hs-var">diagProd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall (c :: * -&gt; *) e. Container c e =&gt; c e -&gt; e
</span><span class="hs-identifier hs-var">LA.prodElements</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall t. Element t =&gt; Matrix t -&gt; Vector t
</span><span class="hs-identifier hs-var">LA.takeDiag</span></span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679356431"><span class="annot"><span class="annottext">zero :: Int -&gt; Int -&gt; Matrix a
</span><a href="#local-6989586621679356431"><span class="hs-identifier hs-var hs-var hs-var hs-var">zero</span></a></span></span><span> </span><span id="local-6989586621679356430"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356430"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356429"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356429"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Int, Int) -&gt; Matrix a
forall e d (c :: * -&gt; *). Konst e d c =&gt; e -&gt; d -&gt; c e
</span><span class="hs-identifier hs-var">LA.konst</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356430"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356429"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679356427"><span class="annot"><span class="annottext">colVector :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356427"><span class="hs-identifier hs-var hs-var hs-var hs-var">colVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Matrix a
forall a. Storable a =&gt; Vector a -&gt; Matrix a
</span><span class="hs-identifier hs-var">LA.asColumn</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a)
-&gt; (Vector a -&gt; Vector a) -&gt; Vector a -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. Storable a =&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">LA.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679356425"><span class="annot"><span class="annottext">rowVector :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356425"><span class="hs-identifier hs-var hs-var hs-var hs-var">rowVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Matrix a
forall a. Storable a =&gt; Vector a -&gt; Matrix a
</span><span class="hs-identifier hs-var">LA.asRow</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a)
-&gt; (Vector a -&gt; Vector a) -&gt; Vector a -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. Storable a =&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">LA.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679356423"><span class="annot"><span class="annottext">toCols :: Matrix a -&gt; [Vector a]
</span><a href="#local-6989586621679356423"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Vector a) -&gt; [Vector a] -&gt; [Vector a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Storable a =&gt; Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">LA.toList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; [Vector a])
-&gt; (Matrix a -&gt; [Vector a]) -&gt; Matrix a -&gt; [Vector a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Vector a]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toColumns</span></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679356421"><span class="annot"><span class="annottext">toRows :: Matrix a -&gt; [Vector a]
</span><a href="#local-6989586621679356421"><span class="hs-identifier hs-var hs-var hs-var hs-var">toRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Vector a) -&gt; [Vector a] -&gt; [Vector a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Storable a =&gt; Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">LA.toList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; [Vector a])
-&gt; (Matrix a -&gt; [Vector a]) -&gt; Matrix a -&gt; [Vector a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Vector a]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toRows</span></span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679356419"><span class="annot"><span class="annottext">getCol :: Int -&gt; Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356419"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCol</span></a></span></span><span> </span><span id="local-6989586621679356418"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356418"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Matrix a -&gt; [a]) -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Storable a =&gt; Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">LA.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; [a]) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Vector a] -&gt; Int -&gt; Vector a
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356418"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; Vector a)
-&gt; (Matrix a -&gt; [Vector a]) -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Vector a]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toColumns</span></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679356416"><span class="annot"><span class="annottext">getRow :: Int -&gt; Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356416"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRow</span></a></span></span><span> </span><span id="local-6989586621679356415"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356415"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Matrix a -&gt; [a]) -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Storable a =&gt; Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">LA.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; [a]) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Vector a] -&gt; Int -&gt; Vector a
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356415"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; Vector a)
-&gt; (Matrix a -&gt; [Vector a]) -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Vector a]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toRows</span></span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679356414"><span class="annot"><span class="annottext">switchRows :: Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356414"><span class="hs-identifier hs-var hs-var hs-var hs-var">switchRows</span></a></span></span><span> </span><span id="local-6989586621679356413"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356413"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356412"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356412"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679356411"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356411"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356411"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Int] -&gt; Matrix a
forall t. Element t =&gt; Matrix t -&gt; [Int] -&gt; Matrix t
</span><span class="hs-operator hs-var">LA.?</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; [Int] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int
forall a. Eq a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="Algebra.Matrix.html#swapIJ"><span class="hs-identifier hs-var">swapIJ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356413"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356412"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356411"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679356409"><span class="annot"><span class="annottext">combineRows :: Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356409"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineRows</span></a></span></span><span> </span><span id="local-6989586621679356408"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356408"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679356407"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356407"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679356406"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356406"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356405"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356405"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; a -&gt; a) -&gt; Matrix a -&gt; Matrix a
forall a b.
(Element a, Storable b) =&gt;
((Int, Int) -&gt; a -&gt; b) -&gt; Matrix a -&gt; Matrix b
</span><span class="hs-identifier hs-var">LA.mapMatrixWithIndex</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679356403"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356403"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679356402"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356402"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679356401"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356401"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356403"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356408"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356407"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356405"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; (Int, Int) -&gt; a
</span><a href="Algebra.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356406"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356402"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356401"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356401"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356405"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621679356397"><span class="annot"><span class="annottext">buildMatrix :: Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="#local-6989586621679356397"><span class="hs-identifier hs-var hs-var hs-var hs-var">buildMatrix</span></a></span></span><span> </span><span id="local-6989586621679356396"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356396"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679356395"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356395"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679356394"><span class="annot"><span class="annottext">(Int, Int) -&gt; a
</span><a href="#local-6989586621679356394"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (a -&gt; a -&gt; a) -&gt; Matrix a
forall d f (c :: * -&gt; *) e. Build d f c e =&gt; d -&gt; f -&gt; c e
</span><span class="hs-identifier hs-var">LA.build</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356396"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356395"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679356392"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356392"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356391"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356391"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; a
</span><a href="#local-6989586621679356394"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int
forall e. Container Matrix e =&gt; e -&gt; Int
</span><a href="Algebra.Matrix.html#toIntLA"><span class="hs-identifier hs-var">toIntLA</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356392"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall e. Container Matrix e =&gt; e -&gt; Int
</span><a href="Algebra.Matrix.html#toIntLA"><span class="hs-identifier hs-var">toIntLA</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356391"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679356389"><span class="annot"><span class="annottext">scaleRow :: a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356389"><span class="hs-identifier hs-var hs-var hs-var hs-var">scaleRow</span></a></span></span><span> </span><span id="local-6989586621679356388"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356388"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679356387"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356387"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Matrix a, ()) -&gt; Matrix a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Matrix a, ()) -&gt; Matrix a)
-&gt; (Matrix a -&gt; (Matrix a, ())) -&gt; Matrix a -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Matrix a -&gt; (Matrix a, ())) -&gt; Matrix a -&gt; Matrix a)
-&gt; (Matrix a -&gt; (Matrix a, ())) -&gt; Matrix a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. (Int, Int) -&gt; STMatrix s a -&gt; ST s ())
-&gt; Matrix a -&gt; (Matrix a, ())
forall t u.
Element t =&gt;
(forall s. (Int, Int) -&gt; STMatrix s t -&gt; ST s u)
-&gt; Matrix t -&gt; (Matrix t, u)
</span><span class="hs-identifier hs-var">LA.mutable</span></span><span> </span><span class="annot"><span class="annottext">((forall s. (Int, Int) -&gt; STMatrix s a -&gt; ST s ())
 -&gt; Matrix a -&gt; (Matrix a, ()))
-&gt; (forall s. (Int, Int) -&gt; STMatrix s a -&gt; ST s ())
-&gt; Matrix a
-&gt; (Matrix a, ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679356385"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356385"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356384"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356384"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679356383"><span class="annot"><span class="annottext">STMatrix s a
</span><a href="#local-6989586621679356383"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679356382"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356382"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STMatrix s a -&gt; Int -&gt; Int -&gt; ST s a
forall t s. Storable t =&gt; STMatrix s t -&gt; Int -&gt; Int -&gt; ST s t
</span><span class="hs-identifier hs-var">LA.readMatrix</span></span><span> </span><span class="annot"><span class="annottext">STMatrix s a
</span><a href="#local-6989586621679356383"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356385"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356384"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356385"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356387"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">STMatrix s a -&gt; Int -&gt; Int -&gt; a -&gt; ST s ()
forall t s.
Storable t =&gt;
STMatrix s t -&gt; Int -&gt; Int -&gt; t -&gt; ST s ()
</span><span class="hs-identifier hs-var">LA.writeMatrix</span></span><span> </span><span class="annot"><span class="annottext">STMatrix s a
</span><a href="#local-6989586621679356383"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356385"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356384"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356388"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356382"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679356379"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356379"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679356378"><span class="annot"><span class="annottext">! :: Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="#local-6989586621679356378"><span class="hs-glyph hs-var hs-var hs-var hs-var">!</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679356377"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356377"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356376"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356376"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356379"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; IndexOf Matrix -&gt; a
forall (c :: * -&gt; *) e. Container c e =&gt; c e -&gt; IndexOf c -&gt; e
</span><span class="hs-operator hs-var">`LA.atIndex`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356377"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356376"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679356374"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356374"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679356373"><span class="annot"><span class="annottext">&lt;||&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356373"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;||&gt;</span></a></span></span><span> </span><span id="local-6989586621679356372"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356372"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vector a] -&gt; Matrix a
forall t. Element t =&gt; [Vector t] -&gt; Matrix t
</span><span class="hs-identifier hs-var">LA.fromColumns</span></span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; Matrix a) -&gt; [Vector a] -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Vector a]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toColumns</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356374"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[Vector a] -&gt; [Vector a] -&gt; [Vector a]
forall w. Monoid w =&gt; w -&gt; w -&gt; w
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Vector a]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toColumns</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356372"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679356370"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356370"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679356369"><span class="annot"><span class="annottext">&lt;--&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356369"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;--&gt;</span></a></span></span><span> </span><span id="local-6989586621679356368"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356368"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vector a] -&gt; Matrix a
forall t. Element t =&gt; [Vector t] -&gt; Matrix t
</span><span class="hs-identifier hs-var">LA.fromRows</span></span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; Matrix a) -&gt; [Vector a] -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Vector a]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toRows</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356370"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[Vector a] -&gt; [Vector a] -&gt; [Vector a]
forall w. Monoid w =&gt; w -&gt; w -&gt; w
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Vector a]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toRows</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356368"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679356821"><span class="annot"><a href="Algebra.Matrix.html#toIntLA"><span class="hs-identifier hs-type">toIntLA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LA.Container</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LA.Matrix</span></span><span> </span><span class="annot"><a href="#local-6989586621679356821"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356821"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-138"></span><span id="toIntLA"><span class="annot"><span class="annottext">toIntLA :: e -&gt; Int
</span><a href="Algebra.Matrix.html#toIntLA"><span class="hs-identifier hs-var hs-var">toIntLA</span></a></span></span><span> </span><span id="local-6989586621679356366"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679356366"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Z -&gt; Int) -&gt; Z -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix e -&gt; Matrix Z
forall (c :: * -&gt; *) e. Container c e =&gt; c e -&gt; c Z
</span><span class="hs-identifier hs-var">LA.toZ</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [e] -&gt; Matrix e
forall a. Storable a =&gt; Int -&gt; Int -&gt; [a] -&gt; Matrix a
</span><span class="hs-operator hs-var">LA.&gt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679356366"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix Z -&gt; IndexOf Matrix -&gt; Z
forall (c :: * -&gt; *) e. Container c e =&gt; c e -&gt; IndexOf c -&gt; e
</span><span class="hs-operator hs-var">`LA.atIndex`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679356353"><span id="local-6989586621679356355"><span id="local-6989586621679356357"><span id="local-6989586621679356359"><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="Algebra.LinkedMatrix.html#Matrix"><span class="hs-identifier hs-type">LM.Matrix</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Elem"><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span></span><span> </span><span class="annot"><a href="Algebra.LinkedMatrix.html#Matrix"><span class="hs-identifier hs-type">LM.Matrix</span></a></span><span> </span><span id="local-6989586621679356329"><span class="annot"><a href="#local-6989586621679356329"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CoeffRing</span></span><span> </span><span class="annot"><a href="#local-6989586621679356329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unital</span></span><span> </span><span class="annot"><a href="#local-6989586621679356329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoidal</span></span><span> </span><span class="annot"><a href="#local-6989586621679356329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Multiplicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679356329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Additive</span></span><span> </span><span class="annot"><a href="#local-6989586621679356329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679356327"><span class="annot"><span class="annottext">cmap :: (a -&gt; b) -&gt; Matrix a -&gt; Matrix b
</span><a href="#local-6989586621679356327"><span class="hs-identifier hs-var hs-var hs-var hs-var">cmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Matrix a -&gt; Matrix b
forall a a1. DecidableZero a =&gt; (a1 -&gt; a) -&gt; Matrix a1 -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#cmap"><span class="hs-identifier hs-var">LM.cmap</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679356325"><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span></span><span> </span><span id="local-6989586621679356324"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356324"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679356323"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679356323"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679356324"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Monoidal a =&gt; Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Algebra.LinkedMatrix.html#%21"><span class="hs-operator hs-var">LM.!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679356323"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; ((Int, Int) -&gt; (Int, Int)) -&gt; (Int, Int)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Identity Int) -&gt; (Int, Int) -&gt; Identity (Int, Int)
forall (r :: * -&gt; * -&gt; *) a b.
Bitraversable r =&gt;
Traversal (r a a) (r b b) a b
</span><span class="hs-identifier hs-var">both</span></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Identity Int) -&gt; (Int, Int) -&gt; Identity (Int, Int))
-&gt; (Int -&gt; Int) -&gt; (Int, Int) -&gt; (Int, Int)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679356320"><span class="annot"><span class="annottext">index :: Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
</span><a href="#local-6989586621679356320"><span class="hs-identifier hs-var hs-var hs-var hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679356319"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356319"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356318"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356318"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
forall a. Monoidal a =&gt; Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
</span><a href="Algebra.LinkedMatrix.html#index"><span class="hs-identifier hs-var">LM.index</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356319"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356318"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679356316"><span class="annot"><span class="annottext">empty :: Matrix b
</span><a href="#local-6989586621679356316"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix b
forall a. Matrix a
</span><a href="Algebra.LinkedMatrix.html#empty"><span class="hs-identifier hs-var">LM.empty</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679356314"><span class="annot"><span class="annottext">buildMatrix :: Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="#local-6989586621679356314"><span class="hs-identifier hs-var hs-var hs-var hs-var">buildMatrix</span></a></span></span><span> </span><span id="local-6989586621679356313"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356313"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679356312"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356312"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679356311"><span class="annot"><span class="annottext">(Int, Int) -&gt; a
</span><a href="#local-6989586621679356311"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((Int, Int), a)] -&gt; Matrix a
forall a. DecidableZero a =&gt; [((Int, Int), a)] -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#fromList"><span class="hs-identifier hs-var">LM.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356309"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356308"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; a
</span><a href="#local-6989586621679356311"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356309"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356308"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679356308"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356308"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356312"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356309"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356309"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356313"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679356307"><span class="annot"><span class="annottext">trans :: Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356307"><span class="hs-identifier hs-var hs-var hs-var hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#transpose"><span class="hs-identifier hs-var">LM.transpose</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679356305"><span class="annot"><span class="annottext">combineRows :: Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356305"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineRows</span></a></span></span><span> </span><span id="local-6989586621679356304"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356304"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679356303"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356303"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679356302"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356302"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a.
(DecidableZero a, Multiplicative a) =&gt;
a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#combineRows"><span class="hs-identifier hs-var">LM.combineRows</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356303"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356302"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356304"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679356300"><span class="annot"><span class="annottext">switchRows :: Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356300"><span class="hs-identifier hs-var hs-var hs-var hs-var">switchRows</span></a></span></span><span> </span><span id="local-6989586621679356299"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356299"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356298"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356298"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#switchRows"><span class="hs-identifier hs-var">LM.switchRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356299"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356298"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621679356296"><span class="annot"><span class="annottext">scaleRow :: a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356296"><span class="hs-identifier hs-var hs-var hs-var hs-var">scaleRow</span></a></span></span><span> </span><span id="local-6989586621679356295"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356295"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679356294"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356294"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a.
(DecidableZero a, Multiplicative a) =&gt;
a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#scaleRow"><span class="hs-identifier hs-var">LM.scaleRow</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356295"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356294"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679356292"><span class="annot"><span class="annottext">zero :: Int -&gt; Int -&gt; Matrix a
</span><a href="#local-6989586621679356292"><span class="hs-identifier hs-var hs-var hs-var hs-var">zero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#zeroMat"><span class="hs-identifier hs-var">LM.zeroMat</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621679356290"><span class="annot"><span class="annottext">identity :: Int -&gt; Matrix a
</span><a href="#local-6989586621679356290"><span class="hs-identifier hs-var hs-var hs-var hs-var">identity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a
forall a. Unital a =&gt; Int -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#identity"><span class="hs-identifier hs-var">LM.identity</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679356288"><span class="annot"><span class="annottext">diag :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356288"><span class="hs-identifier hs-var hs-var hs-var hs-var">diag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Matrix a
forall a. DecidableZero a =&gt; Vector a -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#diag"><span class="hs-identifier hs-var">LM.diag</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679356286"><span class="annot"><span class="annottext">getDiag :: Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356286"><span class="hs-identifier hs-var hs-var hs-var hs-var">getDiag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall a. Monoidal a =&gt; Matrix a -&gt; Vector a
</span><a href="Algebra.LinkedMatrix.html#getDiag"><span class="hs-identifier hs-var">LM.getDiag</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679356284"><span class="annot"><span class="annottext">diagProd :: Matrix a -&gt; a
</span><a href="#local-6989586621679356284"><span class="hs-identifier hs-var hs-var hs-var hs-var">diagProd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; a
forall c. (Unital c, Monoidal c) =&gt; Matrix c -&gt; c
</span><a href="Algebra.LinkedMatrix.html#diagProd"><span class="hs-identifier hs-var">LM.diagProd</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679356282"><span class="annot"><span class="annottext">trace :: Matrix a -&gt; a
</span><a href="#local-6989586621679356282"><span class="hs-identifier hs-var hs-var hs-var hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; a
forall c. Monoidal c =&gt; Matrix c -&gt; c
</span><a href="Algebra.LinkedMatrix.html#trace"><span class="hs-identifier hs-var">LM.trace</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679356280"><span class="annot"><span class="annottext">getRow :: Int -&gt; Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356280"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Vector a
forall a. Monoidal a =&gt; Int -&gt; Matrix a -&gt; Vector a
</span><a href="Algebra.LinkedMatrix.html#getRow"><span class="hs-identifier hs-var">LM.getRow</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Matrix a -&gt; Vector a)
-&gt; (Int -&gt; Int) -&gt; Int -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679356278"><span class="annot"><span class="annottext">getCol :: Int -&gt; Matrix a -&gt; Vector a
</span><a href="#local-6989586621679356278"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Vector a
forall a. Monoidal a =&gt; Int -&gt; Matrix a -&gt; Vector a
</span><a href="Algebra.LinkedMatrix.html#getCol"><span class="hs-identifier hs-var">LM.getCol</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Matrix a -&gt; Vector a)
-&gt; (Int -&gt; Int) -&gt; Int -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679356276"><span class="annot"><span class="annottext">nrows :: Matrix a -&gt; Int
</span><a href="#local-6989586621679356276"><span class="hs-identifier hs-var hs-var hs-var hs-var">nrows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Algebra.LinkedMatrix.html#nrows"><span class="hs-identifier hs-var">LM.nrows</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679356274"><span class="annot"><span class="annottext">ncols :: Matrix a -&gt; Int
</span><a href="#local-6989586621679356274"><span class="hs-identifier hs-var hs-var hs-var hs-var">ncols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Algebra.LinkedMatrix.html#ncols"><span class="hs-identifier hs-var">LM.ncols</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679356272"><span class="annot"><span class="annottext">fromLists :: [[a]] -&gt; Matrix a
</span><a href="#local-6989586621679356272"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromLists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; Matrix a
forall a. DecidableZero a =&gt; [[a]] -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#fromLists"><span class="hs-identifier hs-var">LM.fromLists</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679356270"><span class="annot"><span class="annottext">&lt;||&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356270"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;||&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall b. DecidableZero b =&gt; Matrix b -&gt; Matrix b -&gt; Matrix b
</span><a href="Algebra.LinkedMatrix.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">(LM.&lt;||&gt;)</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679356268"><span class="annot"><span class="annottext">&lt;--&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679356268"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;--&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall b. DecidableZero b =&gt; Matrix b -&gt; Matrix b -&gt; Matrix b
</span><a href="Algebra.LinkedMatrix.html#%3C--%3E"><span class="hs-operator hs-var">(LM.&lt;--&gt;)</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679356266"><span class="annot"><span class="annottext">rowVector :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356266"><span class="hs-identifier hs-var hs-var hs-var hs-var">rowVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Matrix a
forall a. DecidableZero a =&gt; Vector a -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#rowVector"><span class="hs-identifier hs-var">LM.rowVector</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679356264"><span class="annot"><span class="annottext">colVector :: Vector a -&gt; Matrix a
</span><a href="#local-6989586621679356264"><span class="hs-identifier hs-var hs-var hs-var hs-var">colVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Matrix a
forall a. DecidableZero a =&gt; Vector a -&gt; Matrix a
</span><a href="Algebra.LinkedMatrix.html#colVector"><span class="hs-identifier hs-var">LM.colVector</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679356262"><span class="annot"><span class="annottext">nonZeroRows :: Matrix a -&gt; [Int]
</span><a href="#local-6989586621679356262"><span class="hs-identifier hs-var hs-var hs-var hs-var">nonZeroRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Int]
forall r. Matrix r -&gt; [Int]
</span><a href="Algebra.LinkedMatrix.html#nonZeroRows"><span class="hs-identifier hs-var">LM.nonZeroRows</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679356260"><span class="annot"><span class="annottext">nonZeroCols :: Matrix a -&gt; [Int]
</span><a href="#local-6989586621679356260"><span class="hs-identifier hs-var hs-var hs-var hs-var">nonZeroCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; [Int]
forall r. Matrix r -&gt; [Int]
</span><a href="Algebra.LinkedMatrix.html#nonZeroCols"><span class="hs-identifier hs-var">LM.nonZeroCols</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span id="local-6989586621679356708"><span class="annot"><a href="Algebra.Matrix.html#delta"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NA.Monoidal</span></span><span> </span><span class="annot"><a href="#local-6989586621679356708"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Unital</span></span><span> </span><span class="annot"><a href="#local-6989586621679356708"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356708"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-170"></span><span id="delta"><span class="annot"><span class="annottext">delta :: Int -&gt; Int -&gt; r
</span><a href="Algebra.Matrix.html#delta"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span id="local-6989586621679356258"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356258"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356257"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356257"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356258"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356257"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">NA.one</span></span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">NA.zero</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span id="local-6989586621679356252"><span id="local-6989586621679356253"><span id="local-6989586621679356254"><span id="local-6989586621679356255"><span class="annot"><a href="Algebra.Matrix.html#companion"><span class="hs-identifier hs-type">companion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679356255"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoeffRing</span></span><span> </span><span class="annot"><a href="#local-6989586621679356254"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356253"><span class="hs-identifier hs-type">mat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>              </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356253"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356254"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsMonomialOrder</span></span><span> </span><span class="annot"><a href="#local-6989586621679356255"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356252"><span class="hs-identifier hs-type">ord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordinal</span></span><span> </span><span class="annot"><a href="#local-6989586621679356255"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OrderedPolynomial</span></span><span> </span><span class="annot"><a href="#local-6989586621679356254"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356252"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356255"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356253"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356254"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-176"></span><span id="companion"><span class="annot"><span class="annottext">companion :: Ordinal n -&gt; OrderedPolynomial r ord n -&gt; mat r
</span><a href="Algebra.Matrix.html#companion"><span class="hs-identifier hs-var hs-var">companion</span></a></span></span><span> </span><span id="local-6989586621679356250"><span class="annot"><span class="annottext">Ordinal n
</span><a href="#local-6989586621679356250"><span class="hs-identifier hs-var">odn</span></a></span></span><span> </span><span id="local-6989586621679356249"><span class="annot"><span class="annottext">OrderedPolynomial r ord n
</span><a href="#local-6989586621679356249"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679356248"><span class="annot"><span class="annottext">deg :: Int
</span><a href="#local-6989586621679356248"><span class="hs-identifier hs-var hs-var">deg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial r ord n -&gt; Int
forall poly. IsPolynomial poly =&gt; poly -&gt; Int
</span><span class="hs-identifier hs-var">totalDegree&#39;</span></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial r ord n
</span><a href="#local-6989586621679356249"><span class="hs-identifier hs-var">poly</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span id="local-6989586621679356246"><span class="annot"><span class="annottext">vx :: OrderedMonomial
  (MOrder (OrderedPolynomial r ord n))
  (Arity (OrderedPolynomial r ord n))
</span><a href="#local-6989586621679356246"><span class="hs-identifier hs-var hs-var">vx</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial r ord n
-&gt; OrderedMonomial
     (MOrder (OrderedPolynomial r ord n))
     (Arity (OrderedPolynomial r ord n))
forall poly.
IsOrderedPolynomial poly =&gt;
poly -&gt; OrderedMonomial (MOrder poly) (Arity poly)
</span><span class="hs-identifier hs-var">leadingMonomial</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordinal (Arity (OrderedPolynomial r ord n))
-&gt; OrderedPolynomial r ord n
forall poly. IsPolynomial poly =&gt; Ordinal (Arity poly) -&gt; poly
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Ordinal n
Ordinal (Arity (OrderedPolynomial r ord n))
</span><a href="#local-6989586621679356250"><span class="hs-identifier hs-var">odn</span></a></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial r ord n
-&gt; OrderedPolynomial r ord n -&gt; OrderedPolynomial r ord n
forall a. a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`asTypeOf`</span></span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial r ord n
</span><a href="#local-6989586621679356249"><span class="hs-identifier hs-var">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; r) -&gt; mat r
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; mat a
</span><a href="Algebra.Matrix.html#buildMatrix"><span class="hs-identifier hs-var">buildMatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356248"><span class="hs-identifier hs-var">deg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356248"><span class="hs-identifier hs-var">deg</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; r) -&gt; mat r) -&gt; ((Int, Int) -&gt; r) -&gt; mat r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679356242"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356242"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356241"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356241"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356241"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356241"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356248"><span class="hs-identifier hs-var">deg</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; r
forall r. (Monoidal r, Unital r) =&gt; Int -&gt; Int -&gt; r
</span><a href="Algebra.Matrix.html#delta"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356242"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356241"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. Group r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">NA.negate</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; r -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial
  (MOrder (OrderedPolynomial r ord n))
  (Arity (OrderedPolynomial r ord n))
-&gt; OrderedPolynomial r ord n
-&gt; Coefficient (OrderedPolynomial r ord n)
forall poly.
IsOrderedPolynomial poly =&gt;
OrderedMonomial (MOrder poly) (Arity poly)
-&gt; poly -&gt; Coefficient poly
</span><span class="hs-identifier hs-var">coeff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrderedMonomial ord n -&gt; Natural -&gt; OrderedMonomial ord n
forall r. Unital r =&gt; r -&gt; Natural -&gt; r
</span><span class="hs-identifier hs-var">NA.pow</span></span><span> </span><span class="annot"><span class="annottext">OrderedMonomial ord n
OrderedMonomial
  (MOrder (OrderedPolynomial r ord n))
  (Arity (OrderedPolynomial r ord n))
</span><a href="#local-6989586621679356246"><span class="hs-identifier hs-var">vx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Natural) -&gt; Int -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356242"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Group r =&gt; r -&gt; r -&gt; r
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Natural</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrderedPolynomial r ord n
</span><a href="#local-6989586621679356249"><span class="hs-identifier hs-var">poly</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | @gaussReduction a = (a&#39;, p)@ where @a&#39;@ is row echelon form and @p@ is pivoting matrix.</span><span>
</span><span id="line-185"></span><span id="local-6989586621679356665"><span id="local-6989586621679356666"><span class="annot"><a href="Algebra.Matrix.html#gaussReduction"><span class="hs-identifier hs-type">gaussReduction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356666"><span class="hs-identifier hs-type">mat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356666"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356665"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Normed</span></span><span> </span><span class="annot"><a href="#local-6989586621679356665"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679356665"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679356665"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356666"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356665"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679356666"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356665"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679356666"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356665"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-187"></span><span id="gaussReduction"><span class="annot"><span class="annottext">gaussReduction :: mat a -&gt; (mat a, mat a)
</span><a href="Algebra.Matrix.html#gaussReduction"><span class="hs-identifier hs-var hs-var">gaussReduction</span></a></span></span><span> </span><span id="local-6989586621679356237"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356237"><span class="hs-identifier hs-var">mat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679356236"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356236"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356235"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356235"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">mat a -&gt; (mat a, mat a, a)
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a, Normed a, Eq a, Field a) =&gt;
mat a -&gt; (mat a, mat a, a)
</span><a href="Algebra.Matrix.html#gaussReduction%27"><span class="hs-identifier hs-var">gaussReduction&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356237"><span class="hs-identifier hs-var">mat</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356236"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356235"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | @gaussReduction a = (a&#39;, p)@ where @a&#39;@ is row echelon form and @p@ is pivoting matrix.</span><span>
</span><span id="line-191"></span><span id="local-6989586621679356703"><span id="local-6989586621679356704"><span class="annot"><a href="Algebra.Matrix.html#gaussReduction%27"><span class="hs-identifier hs-type">gaussReduction&#39;</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356704"><span class="hs-identifier hs-type">mat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356704"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Normed</span></span><span> </span><span class="annot"><a href="#local-6989586621679356703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679356703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679356703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356704"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356703"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679356704"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679356704"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679356703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-193"></span><span id="gaussReduction%27"><span class="annot"><span class="annottext">gaussReduction&#39; :: mat a -&gt; (mat a, mat a, a)
</span><a href="Algebra.Matrix.html#gaussReduction%27"><span class="hs-identifier hs-var hs-var">gaussReduction&#39;</span></a></span></span><span> </span><span id="local-6989586621679356233"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356233"><span class="hs-identifier hs-var">mat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;gaussRed&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; mat a -&gt; mat a -&gt; a -&gt; (mat a, mat a, a)
</span><a href="#local-6989586621679356232"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356233"><span class="hs-identifier hs-var">mat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; mat a
forall (mat :: * -&gt; *) a. (Matrix mat, Elem mat a) =&gt; Int -&gt; mat a
</span><a href="Algebra.Matrix.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; mat a) -&gt; Int -&gt; mat a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356233"><span class="hs-identifier hs-var">mat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
forall r. Unital r =&gt; r
</span><span class="hs-identifier hs-var">NA.one</span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679356232"><span class="annot"><span class="annottext">go :: Int -&gt; Int -&gt; mat a -&gt; mat a -&gt; a -&gt; (mat a, mat a, a)
</span><a href="#local-6989586621679356232"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679356231"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356230"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356230"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679356229"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356229"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679356228"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356228"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679356227"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356227"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356233"><span class="hs-identifier hs-var">mat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356230"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356233"><span class="hs-identifier hs-var">mat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356229"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356228"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356227"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679356224"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356224"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356223"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356223"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, a) -&gt; (Int, a) -&gt; Ordering) -&gt; [(Int, a)] -&gt; (Int, a)
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, a) -&gt; Norm a) -&gt; (Int, a) -&gt; (Int, a) -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">(((Int, a) -&gt; Norm a) -&gt; (Int, a) -&gt; (Int, a) -&gt; Ordering)
-&gt; ((Int, a) -&gt; Norm a) -&gt; (Int, a) -&gt; (Int, a) -&gt; Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Norm a
forall a. Normed a =&gt; a -&gt; Norm a
</span><span class="hs-identifier hs-var">norm</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Norm a) -&gt; ((Int, a) -&gt; a) -&gt; (Int, a) -&gt; Norm a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356219"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356229"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; (Int, Int) -&gt; a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; (Int, Int) -&gt; a
</span><a href="Algebra.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356219"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356230"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679356219"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356219"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356233"><span class="hs-identifier hs-var">mat</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356223"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">NA.zero</span></span><span>
</span><span id="line-200"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; mat a -&gt; mat a -&gt; a -&gt; (mat a, mat a, a)
</span><a href="#local-6989586621679356232"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356230"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356229"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356228"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
forall m. Monoidal m =&gt; m
</span><span class="hs-identifier hs-var">NA.zero</span></span><span>
</span><span id="line-201"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679356218"><span class="annot"><span class="annottext">prc :: Int -&gt; mat a -&gt; mat a -&gt; (mat a, mat a)
</span><a href="#local-6989586621679356218"><span class="hs-identifier hs-var hs-var">prc</span></a></span></span><span> </span><span id="local-6989586621679356217"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356217"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679356216"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356216"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679356215"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356215"><span class="hs-identifier hs-var">p0</span></a></span></span><span>
</span><span id="line-202"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356217"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; mat a -&gt; mat a -&gt; (mat a, mat a)
</span><a href="#local-6989586621679356218"><span class="hs-identifier hs-var">prc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356217"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356216"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356215"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-203"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356217"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; Int
forall (mat :: * -&gt; *) a. Matrix mat =&gt; mat a -&gt; Int
</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356233"><span class="hs-identifier hs-var">mat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356216"><span class="hs-identifier hs-var">a0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356215"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679356214"><span class="annot"><span class="annottext">coe :: a
</span><a href="#local-6989586621679356214"><span class="hs-identifier hs-var hs-var">coe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall r. Group r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">NA.negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356216"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; (Int, Int) -&gt; a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; (Int, Int) -&gt; a
</span><a href="Algebra.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356217"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356230"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>                            </span><span id="local-6989586621679356213"><span class="annot"><span class="annottext">a&#39;&#39; :: mat a
</span><a href="#local-6989586621679356213"><span class="hs-identifier hs-var hs-var">a&#39;&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Int -&gt; mat a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; a -&gt; Int -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#combineRows"><span class="hs-identifier hs-var">combineRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356217"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356214"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356216"><span class="hs-identifier hs-var">a0</span></a></span><span>
</span><span id="line-207"></span><span>                            </span><span id="local-6989586621679356212"><span class="annot"><span class="annottext">p&#39;&#39; :: mat a
</span><a href="#local-6989586621679356212"><span class="hs-identifier hs-var hs-var">p&#39;&#39;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Int -&gt; mat a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; a -&gt; Int -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#combineRows"><span class="hs-identifier hs-var">combineRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356217"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356214"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356215"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-208"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; mat a -&gt; mat a -&gt; (mat a, mat a)
</span><a href="#local-6989586621679356218"><span class="hs-identifier hs-var">prc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356217"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356213"><span class="hs-identifier hs-var">a&#39;&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356212"><span class="hs-identifier hs-var">p&#39;&#39;</span></a></span><span>
</span><span id="line-209"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679356211"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356211"><span class="hs-identifier hs-var">a&#39;</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356210"><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356210"><span class="hs-identifier hs-var">p&#39;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; mat a -&gt; mat a -&gt; (mat a, mat a)
</span><a href="#local-6989586621679356218"><span class="hs-identifier hs-var">prc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int -&gt; mat a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
a -&gt; Int -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#scaleRow"><span class="hs-identifier hs-var">scaleRow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall r. Division r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">NA.recip</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356223"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(mat a -&gt; mat a) -&gt; mat a -&gt; mat a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; mat a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; Int -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356224"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356229"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int -&gt; mat a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
a -&gt; Int -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#scaleRow"><span class="hs-identifier hs-var">scaleRow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall r. Division r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">NA.recip</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356223"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(mat a -&gt; mat a) -&gt; mat a -&gt; mat a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; mat a -&gt; mat a
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
Int -&gt; Int -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356224"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356228"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>                    </span><span id="local-6989586621679356208"><span class="annot"><span class="annottext">offset :: a -&gt; a
</span><a href="#local-6989586621679356208"><span class="hs-identifier hs-var hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356224"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall r. Group r =&gt; r -&gt; r
</span><span class="hs-identifier hs-var">NA.negate</span></span><span>
</span><span id="line-212"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; mat a -&gt; mat a -&gt; a -&gt; (mat a, mat a, a)
</span><a href="#local-6989586621679356232"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356231"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679356230"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall r. Additive r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356211"><span class="hs-identifier hs-var">a&#39;</span></a></span><span> </span><span class="annot"><span class="annottext">mat a
</span><a href="#local-6989586621679356210"><span class="hs-identifier hs-var">p&#39;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679356208"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356227"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall r. Multiplicative r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">NA.*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679356223"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span id="local-6989586621679356204"><span id="local-6989586621679356205"><span class="annot"><a href="Algebra.Matrix.html#det"><span class="hs-identifier hs-type">det</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356205"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679356204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679356204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Normed</span></span><span> </span><span class="annot"><a href="#local-6989586621679356204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356205"><span class="hs-identifier hs-type">mat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356205"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356204"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356204"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-216"></span><span id="det"><span class="annot"><span class="annottext">det :: mat a -&gt; a
</span><a href="Algebra.Matrix.html#det"><span class="hs-identifier hs-var hs-var">det</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting a (mat a, mat a, a) a -&gt; (mat a, mat a, a) -&gt; a
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting a (mat a, mat a, a) a
forall s t a b. Field3 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_3</span></span><span> </span><span class="annot"><span class="annottext">((mat a, mat a, a) -&gt; a)
-&gt; (mat a -&gt; (mat a, mat a, a)) -&gt; mat a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; (mat a, mat a, a)
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a, Normed a, Eq a, Field a) =&gt;
mat a -&gt; (mat a, mat a, a)
</span><a href="Algebra.Matrix.html#gaussReduction%27"><span class="hs-identifier hs-var">gaussReduction&#39;</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span id="local-6989586621679356202"><span id="local-6989586621679356203"><span class="annot"><a href="Algebra.Matrix.html#maxNorm"><span class="hs-identifier hs-type">maxNorm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356203"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356202"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Normed</span></span><span> </span><span class="annot"><a href="#local-6989586621679356202"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356203"><span class="hs-identifier hs-type">mat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356203"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356202"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Norm</span></span><span> </span><span class="annot"><a href="#local-6989586621679356202"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-219"></span><span id="maxNorm"><span class="annot"><span class="annottext">maxNorm :: mat a -&gt; Norm a
</span><a href="Algebra.Matrix.html#maxNorm"><span class="hs-identifier hs-var hs-var">maxNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Norm a] -&gt; Norm a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">([Norm a] -&gt; Norm a) -&gt; (mat a -&gt; [Norm a]) -&gt; mat a -&gt; Norm a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Norm a]] -&gt; [Norm a]
forall w. Monoid w =&gt; [w] -&gt; w
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Norm a]] -&gt; [Norm a])
-&gt; (mat a -&gt; [[Norm a]]) -&gt; mat a -&gt; [Norm a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; [Norm a]) -&gt; [Vector a] -&gt; [[Norm a]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Norm a) -&gt; [a] -&gt; [Norm a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Norm a
forall a. Normed a =&gt; a -&gt; Norm a
</span><span class="hs-identifier hs-var">norm</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [Norm a]) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; [Norm a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vector a] -&gt; [[Norm a]])
-&gt; (mat a -&gt; [Vector a]) -&gt; mat a -&gt; [[Norm a]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; [Vector a]
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a) =&gt;
mat a -&gt; [Vector a]
</span><a href="Algebra.Matrix.html#toRows"><span class="hs-identifier hs-var">toRows</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621679356198"><span id="local-6989586621679356199"><span class="annot"><a href="Algebra.Matrix.html#rankWith"><span class="hs-identifier hs-type">rankWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356199"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356198"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoeffRing</span></span><span> </span><span class="annot"><a href="#local-6989586621679356198"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356199"><span class="hs-identifier hs-type">mat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679356199"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356198"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356199"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356198"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356199"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356198"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-223"></span><span id="rankWith"><span class="annot"><span class="annottext">rankWith :: (mat r -&gt; mat r) -&gt; mat r -&gt; Int
</span><a href="Algebra.Matrix.html#rankWith"><span class="hs-identifier hs-var hs-var">rankWith</span></a></span></span><span> </span><span id="local-6989586621679356197"><span class="annot"><span class="annottext">mat r -&gt; mat r
</span><a href="#local-6989586621679356197"><span class="hs-identifier hs-var">gauss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; (mat r -&gt; [Int]) -&gt; mat r -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mat r -&gt; [Int]
forall (mat :: * -&gt; *) a.
(Matrix mat, DecidableZero a, Elem mat a) =&gt;
mat a -&gt; [Int]
</span><a href="Algebra.Matrix.html#nonZeroRows"><span class="hs-identifier hs-var">nonZeroRows</span></a></span><span> </span><span class="annot"><span class="annottext">(mat r -&gt; [Int]) -&gt; (mat r -&gt; mat r) -&gt; mat r -&gt; [Int]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mat r -&gt; mat r
</span><a href="#local-6989586621679356197"><span class="hs-identifier hs-var">gauss</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span id="local-6989586621679356194"><span id="local-6989586621679356195"><span class="annot"><a href="Algebra.Matrix.html#inverse"><span class="hs-identifier hs-type">inverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356195"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356194"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679356194"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NA.Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679356194"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Normed</span></span><span> </span><span class="annot"><a href="#local-6989586621679356194"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356195"><span class="hs-identifier hs-type">mat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356195"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356194"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356195"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356194"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-227"></span><span id="inverse"><span class="annot"><span class="annottext">inverse :: mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#inverse"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(mat a, mat a) -&gt; mat a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((mat a, mat a) -&gt; mat a)
-&gt; (mat a -&gt; (mat a, mat a)) -&gt; mat a -&gt; mat a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mat a -&gt; (mat a, mat a)
forall (mat :: * -&gt; *) a.
(Matrix mat, Elem mat a, Normed a, Eq a, Field a) =&gt;
mat a -&gt; (mat a, mat a)
</span><a href="Algebra.Matrix.html#gaussReduction"><span class="hs-identifier hs-var">gaussReduction</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span id="local-6989586621679356192"><span id="local-6989586621679356193"><span class="annot"><a href="Algebra.Matrix.html#inverseWith"><span class="hs-identifier hs-type">inverseWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679356193"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356192"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679356193"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356192"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679356193"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356192"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356193"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356192"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679356193"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679356192"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-230"></span><span id="inverseWith"><span class="annot"><span class="annottext">inverseWith :: (mat a -&gt; (mat a, mat a)) -&gt; mat a -&gt; mat a
</span><a href="Algebra.Matrix.html#inverseWith"><span class="hs-identifier hs-var hs-var">inverseWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(mat a, mat a) -&gt; mat a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((mat a, mat a) -&gt; mat a)
-&gt; (mat a -&gt; (mat a, mat a)) -&gt; mat a -&gt; mat a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span></pre></body></html>